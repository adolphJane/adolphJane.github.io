<!doctype html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
    
  编译FFmpeg - MagicalRice的Blog
  
  </title>
  
  
  <link href="atom.xml" rel="alternate" title="MagicalRice的Blog" type="application/atom+xml">
    <link rel="stylesheet" href="asset/css/foundation.min.css" />
    <link rel="stylesheet" href="asset/css/docs.css" />
    <script src="asset/js/vendor/modernizr.js"></script>
    <script src="asset/js/vendor/jquery.js"></script>
 
<script type="text/javascript">
  function before_search(){
    var searchVal = 'site:www.ifantastic.ink ' + document.getElementById('search_input').value;
    document.getElementById('search_q').value = searchVal;
    return true;
  }
</script>
  </head>
  <body class="antialiased hide-extras">
    
    <div class="marketing off-canvas-wrap" data-offcanvas>
      <div class="inner-wrap">


<nav class="top-bar docs-bar hide-for-small" data-topbar>


  <section class="top-bar-section">
  <div class="row">
      <div style="position: relative;width:100%;"><div style="position: absolute; width:100%;">
        <ul id="main-menu" class="left">
        
        <li id=""><a target="_self" href="index.html">Home</a></li>
        
        <li id=""><a target="_self" href="archives.html">Archives</a></li>
        
        </ul>

        <ul class="right" id="search-wrap">
          <li>
<form target="_blank" onsubmit="return before_search();" action="https://google.com/search" method="get">
    <input type="hidden" id="search_q" name="q" value="" />
    <input tabindex="1" type="search" id="search_input"  placeholder="Search"/>
</form>
</li>
          </ul>
      </div></div>
  </div>
  </section>

</nav>

        <nav class="tab-bar show-for-small">
  <a href="javascript:void(0)" class="left-off-canvas-toggle menu-icon">
    <span> &nbsp; MagicalRice的Blog</span>
  </a>
</nav>

<aside class="left-off-canvas-menu">
      <ul class="off-canvas-list">
        
        <li><a target="_self" href="index.html">Home</a></li>
        
        <li><a target="_self" href="archives.html">Archives</a></li>
        

    <li><label>Categories</label></li>

        
            <li><a href="Android.html">Android</a></li>
        
            <li><a href="%E6%9C%8D%E5%8A%A1%E5%99%A8.html">服务器</a></li>
        
            <li><a href="C++.html">C++</a></li>
        
            <li><a href="UI.html">UI</a></li>
        
            <li><a href="%E4%BB%A3%E7%A0%81%E4%B9%8B%E7%BE%8E.html">代码之美</a></li>
        
            <li><a href="Game.html">Game</a></li>
        
            <li><a href="Python.html">Python</a></li>
        
            <li><a href="Mac.html">Mac</a></li>
        
            <li><a href="%E5%85%B6%E4%BB%96.html">其他</a></li>
        
            <li><a href="Flutter.html">Flutter</a></li>
        
            <li><a href="ReactNative.html">ReactNative</a></li>
        
            <li><a href="Java.html">Java</a></li>
        
            <li><a href="%E9%9F%B3%E8%A7%86%E9%A2%91%E5%BC%80%E5%8F%91.html">音视频开发</a></li>
        
            <li><a href="%E7%BD%91%E7%BB%9C.html">网络</a></li>
        
            <li><a href="%E7%BD%91%E9%A1%B5.html">网页</a></li>
        
            <li><a href="%E5%B7%A5%E5%85%B7-1-2.html">工具</a></li>
        
            <li><a href="%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD.html">人工智能</a></li>
        
            <li><a href="%E5%88%9B%E4%B8%9A.html">创业</a></li>
        
            <li><a href="%E6%80%9D%E7%BB%B4%E6%8F%90%E5%8D%87.html">思维提升</a></li>
        
            <li><a href="GPU%E6%B8%B2%E6%9F%93.html">GPU渲染</a></li>
         

      </ul>
    </aside>

<a class="exit-off-canvas" href="#"></a>


        <section id="main-content" role="main" class="scroll-container">
        
       

 <script type="text/javascript">
  $(function(){
    $('#menu_item_index').addClass('is_active');
  });
</script>
<div class="row">
  <div class="large-8 medium-8 columns">
      <div class="markdown-body article-wrap">
       <div class="article">
          
          <h1>编译FFmpeg</h1>
     
        <div class="read-more clearfix">
          <span class="date">2022/05/20</span>

          <span>posted in&nbsp;</span> 
          
              <span class="posted-in"><a href='%E9%9F%B3%E8%A7%86%E9%A2%91%E5%BC%80%E5%8F%91.html'>音视频开发</a></span>
           
         
          <span class="comments">
            

            
          </span>

        </div>
      </div><!-- article -->

      <div class="article-content">
      <span id="more"></span><!-- more -->
<div class="mweb_toc"><ul>
<li><a href="#%E7%BC%96%E8%AF%91%E7%8E%AF%E5%A2%83">编译环境</a></li>
<li><a href="#%E4%B8%8B%E8%BD%BDffmpeg%E6%BA%90%E7%A0%81">下载FFmpeg源码</a></li>
<li><a href="#%E7%BC%96%E5%86%99%E4%BA%A4%E5%8F%89%E7%BC%96%E8%AF%91%E8%84%9A%E6%9C%AC">编写交叉编译脚本</a></li>
<li><a href="#%E4%BF%AE%E6%94%B9%E7%89%88%E6%9C%AC%E5%8F%B7">修改版本号</a></li>
<li><a href="#%E5%BC%80%E5%A7%8B%E4%BA%A4%E5%8F%89%E7%BC%96%E8%AF%91">开始交叉编译</a></li>
<li><a href="#so%E5%BA%93%E8%A3%81%E5%89%AA">so库裁剪</a>
<ul>
<li><a href="#encoders%E4%B8%8Edecoders%E7%BC%96%E7%A0%81%E8%A7%A3%E7%A0%81">encoders与decoders(编码-解码)</a></li>
<li><a href="#muxers%E4%B8%8Edemuxers%E5%B0%81%E8%A3%85%E8%A7%A3%E5%B0%81%E8%A3%85">muxers与demuxers(封装-解封装)</a></li>
<li><a href="#protocols%E5%8D%8F%E8%AE%AE">protocols(协议)</a></li>
<li><a href="#parsers%E8%A7%A3%E6%9E%90%E5%99%A8">parsers(解析器)</a></li>
<li><a href="#%E5%88%86%E6%9E%90configure%E7%BB%93%E6%9E%84">分析configure结构</a></li>
<li><a href="#ffmpeg%E8%A3%81%E5%89%AA%E4%BC%98%E5%8C%96%E5%AE%9E%E4%BE%8B">FFmpeg裁剪优化实例</a>
<ul>
<li><a href="#%E5%A2%9E%E5%8A%A0%E7%BC%96%E8%AF%91%E9%80%89%E9%A1%B9">增加编译选项</a></li>
<li><a href="#%E5%87%8F%E5%B0%91%E4%B8%8D%E5%BF%85%E8%A6%81%E7%9A%84%E5%B7%A5%E5%85%B7">减少不必要的工具</a></li>
<li><a href="#%E5%87%8F%E5%B0%91%E4%B8%8D%E5%BF%85%E8%A6%81%E7%9A%84%E6%A8%A1%E5%9D%97">减少不必要的模块</a></li>
<li><a href="#%E5%87%8F%E5%B0%91%E4%B8%8D%E5%BF%85%E8%A6%81%E8%AE%BE%E5%A4%87%E7%9A%84%E7%BC%96%E8%AF%91">减少不必要设备的编译</a></li>
<li><a href="#%E5%87%8F%E5%B0%91%E4%B8%8D%E5%BF%85%E8%A6%81%E8%A7%A3%E6%9E%90%E5%99%A8%E7%9A%84%E7%BC%96%E8%AF%91">减少不必要解析器的编译</a></li>
<li><a href="#%E5%87%8F%E5%B0%91%E4%B8%8D%E5%BF%85%E8%A6%81%E7%9A%84%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%B5%81%E8%BF%87%E6%BB%A4%E5%99%A8%E7%9A%84%E7%BC%96%E8%AF%91">减少不必要的二进制流过滤器的编译</a></li>
<li><a href="#%E5%87%8F%E5%B0%91%E4%B8%8D%E5%BF%85%E8%A6%81%E7%9A%84%E5%8D%8F%E8%AE%AE%E7%BC%96%E8%AF%91">减少不必要的协议编译</a></li>
<li><a href="#%E5%87%8F%E5%B0%91%E4%B8%8D%E5%BF%85%E8%A6%81%E7%BB%84%E4%BB%B6%E7%9A%84%E7%BC%96%E8%AF%91">减少不必要组件的编译</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<h2><a id="%E7%BC%96%E8%AF%91%E7%8E%AF%E5%A2%83" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>编译环境</h2>
<p><strong>操作系统</strong>: MacOS Monterey 12.3.1<br />
<strong>NDK</strong>: NDK 23.0.7599858</p>
<h2><a id="%E4%B8%8B%E8%BD%BDffmpeg%E6%BA%90%E7%A0%81" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>下载FFmpeg源码</h2>
<p>到GitHub上使用git clone FFmpeg的源码</p>
<p><a href="https://github.com/FFmpeg/FFmpeg">FFmpeg源码</a></p>
<h2><a id="%E7%BC%96%E5%86%99%E4%BA%A4%E5%8F%89%E7%BC%96%E8%AF%91%E8%84%9A%E6%9C%AC" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>编写交叉编译脚本</h2>
<p>在clone下来的FFmpeg源码根目录下打开命令终端，输入以下命令行，创建一个编译脚本文件：</p>
<pre class="line-numbers"><code class="language-plain_text">touch build_script.sh
sudo chmod 751 build_script.sh
</code></pre>
<p>第一行<code>touch build_script.sh</code>，表示在当前目录创建一个文件名为 <code>build_script.sh</code> 的文件，当然touch命令本质的用法并不是用于创建文件的,它是用于修改文件的属性的，只有当文件不存在时，才会创建一个新的文件。</p>
<p>第二行<code>sudo chmod 741 build_script.sh</code>,将 <code>build_script.sh</code> 文件的权限修改为751，表示当前用户对文件拥有全部权限，当前用户组对文件只具有读和执行的权限，其他的只具有执行的权限。</p>
<p>使用文本编辑器，打开<code>build_script.sh</code>文件，贴入以下代码</p>
<pre class="line-numbers"><code class="language-plain_text">#!/bin/bash
NDK=/Users/jiang/Library/Android/sdk/ndk/21.4.7075529
TOOLCHAIN=$NDK/toolchains/llvm/prebuilt/darwin-x86_64
API=29

function build_android {
	echo &quot;Compiling FFmpeg for $CPU&quot;

	./configure --prefix=$PREFIX \
    --disable-neon \
    --disable-hwaccels \
    --disable-gpl \
    --disable-postproc \
    --enable-shared \
    --enable-small \
    --enable-jni \
    --disable-static \
    --disable-doc \
    --disable-programs \
    --disable-avdevice \
    --disable-muxers \
    --disable-encoders \
    --disable-filters \
    --cross-prefix=$CROSS_PREFIX \
    --target-os=android \
    --arch=$ARCH \
    --cpu=$CPU \
    --cc=$CC \
    --cxx=$CXX \
    --enable-cross-compile \
    --sysroot=$SYSROOT \
    --extra-cflags=&quot;-Os -fpic $OPTIMIZE_CFLAGS&quot; \
    --extra-ldflags=&quot;$ADDI_LDFLAGS&quot; \
    $ADDITIONAL_CONFIGURE_FLAG

	make clean
	make
	make install
	echo &quot;The Compilation of FFmpeg for $CPU is completed&quot;
}

#armv8-a
ARCH=arm64
CPU=armv8-a
CC=$TOOLCHAIN/bin/aarch64-linux-android$API-clang
CXX=$TOOLCHAIN/bin/aarch64-linux-android$API-clang++
SYSROOT=$TOOLCHAIN/sysroot
CROSS_PREFIX=$TOOLCHAIN/bin/aarch64-linux-android-
PREFIX=$(pwd)/android/$CPU
OPTIMIZE_CFLAGS=&quot;-march=$CPU&quot;
build_android

# armv7-a
ARCH=arm
CPU=armv7-a
CC=$TOOLCHAIN/bin/armv7a-linux-androideabi$API-clang
CXX=$TOOLCHAIN/bin/armv7a-linux-androideabi$API-clang++
SYSROOT=$TOOLCHAIN/sysroot
CROSS_PREFIX=$TOOLCHAIN/bin/arm-linux-androideabi-
PREFIX=$(pwd)/android/$CPU
OPTIMIZE_CFLAGS=&quot;-mfloat-abi=softfp -mfpu=vfp -marm -march=$CPU &quot;
build_android

#x86
ARCH=x86
CPU=x86
CC=$TOOLCHAIN/bin/i686-linux-android$API-clang
CXX=$TOOLCHAIN/bin/i686-linux-android$API-clang++
SYSROOT=$TOOLCHAIN/sysroot
CROSS_PREFIX=$TOOLCHAIN/bin/i686-linux-android-
PREFIX=$(pwd)/android/$CPU
OPTIMIZE_CFLAGS=&quot;-march=i686 -mtune=intel -mssse3 -mfpmath=sse -m32&quot;
build_android

#x86_64
ARCH=x86_64
CPU=x86-64
CC=$TOOLCHAIN/bin/x86_64-linux-android$API-clang
CXX=$TOOLCHAIN/bin/x86_64-linux-android$API-clang++
SYSROOT=$TOOLCHAIN/sysroot
CROSS_PREFIX=$TOOLCHAIN/bin/x86_64-linux-android-
PREFIX=$(pwd)/android/$CPU
OPTIMIZE_CFLAGS=&quot;-march=$CPU -msse4.2 -mpopcnt -m64 -mtune=intel&quot;
build_android
</code></pre>
<p>以上这段代码，是交叉编译cpu架构为armv8-a/x86_64/x86/armv7-a的so库的脚本，如需编译其他cpu架构平台的so库，只需要对其中--cc、--cxx中的内容进行替换即可。</p>
<p>NDK=<strong>/Users/jiang/Library/Android/sdk/ndk/21.4.7075529</strong></p>
<p>定义NDK工具目录，ndk版本23会有问题，部分编译工具找不到</p>
<p>TOOLCHAIN=<strong>$NDK/toolchains/llvm/prebuilt/darwin-x86_64</strong></p>
<p>定义NDK工具的目录，其中加粗部分的文字请各位读者根据自己TOOLCHAIN安装的实际路径自行替换。</p>
<p><strong>./configure</strong><br />
运行当前目录下的名为configure的可执行程序。</p>
<p><strong>--enable-shared</strong><br />
生成动态库，在此需要注意行尾的反斜杠前有个空格，这个空格一定不要漏掉了。</p>
<p><strong>--enable-static</strong><br />
生成静态库</p>
<p><strong>--disable-x86asm</strong><br />
系统上没有安装yasm汇编器，编译时会报错，故加上此行禁用汇编。</p>
<p><strong>--enable-cross-compile</strong><br />
启用交叉编译</p>
<p><strong>--disable-muxers</strong><br />
关闭所有复用器(封装器)，播放器不需要生成mp4这样的文件，所以关闭</p>
<p><strong>--disable-avdevice</strong><br />
关闭avdevice模块，此模块在android无用</p>
<p><strong>--disable-programs</strong><br />
不编译ffmpeg程序(命令行工具)，只需要获取静态、动态库</p>
<p><strong>--enable-small</strong><br />
优化大小 非常重要 Android上必须优化</p>
<p><strong>--disable-encoders</strong><br />
关闭所有编码器(播放器不需要编码器)</p>
<p><strong>--disable-filters</strong><br />
关闭所有滤镜</p>
<p><strong>--cross-prefix</strong><br />
查找ndk的gcc</p>
<p><strong>--sysroot</strong><br />
寻找NDK所有的库文件</p>
<p><strong>--extra-cflags</strong><br />
传给gcc参数</p>
<p><strong>--prefix</strong><br />
编译后的存放目录</p>
<h2><a id="%E4%BF%AE%E6%94%B9%E7%89%88%E6%9C%AC%E5%8F%B7" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>修改版本号</h2>
<p>默认编译出来的so库包括avcodec、avformat、avutil、avdevice、avfilter、swscale、avresample、swresample、postproc，编译出来so是个软链接，真正so名字后缀带有一长串主版本号与子版本号，这样的so名字在Adnroid平台无法识别。在这一步，我们还需要对FFmpeg的版本号命名规则进行修改。</p>
<p>让我们打开<code>configure</code>文件，然后搜索major这个关键字，找到以下代码片段：</p>
<pre class="line-numbers"><code class="language-plain_text">SLIBNAME_WITH_MAJOR='$(SLIBNAME).$(LIBMAJOR)' 
LIB_INSTALL_EXTRA_CMD='$$(RANLIB) &quot;$(LIBDIR)/$(LIBNAME)&quot;' 
SLIB_INSTALL_NAME='$(SLIBNAME_WITH_VERSION)' 
SLIB_INSTALL_LINKS='$(SLIBNAME_WITH_MAJOR) $(SLIBNAME)'
</code></pre>
<p>将上述代码的内容替换为如下所示内容：</p>
<pre class="line-numbers"><code class="language-plain_text">SLIBNAME_WITH_MAJOR='$(SLIBPREF)$(FULLNAME)-$(LIBMAJOR)$(SLIBSUF)'
LIB_INSTALL_EXTRA_CMD='$$(RANLIB) &quot;$(LIBDIR)/$(LIBNAME)&quot;'
SLIB_INSTALL_NAME='$(SLIBNAME_WITH_MAJOR)'
SLIB_INSTALL_LINKS='$(SLIBNAME)'
</code></pre>
<h2><a id="%E5%BC%80%E5%A7%8B%E4%BA%A4%E5%8F%89%E7%BC%96%E8%AF%91" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>开始交叉编译</h2>
<p>在终端中输入以下命令行，开始编译。</p>
<pre class="line-numbers"><code class="language-plain_text">./build_install.sh
</code></pre>
<p>如果在执行<code>./build_install.sh</code>时发生了错误，可以打开<code>ffbuild/config.log</code>文件，检查编写脚本的错误。</p>
<p>一切顺利的话，我们最终可以在<code>/android/</code>这个目录下找到不同CPU架构生成的头文件以及so文件。</p>
<p><figure><img src="media/16530371003160/16535490068976.jpg" alt="" /></figure></p>
<h2><a id="so%E5%BA%93%E8%A3%81%E5%89%AA" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>so库裁剪</h2>
<p>ffmpeg强大之处在于支持按需编译，进行弹性剪裁。可以使用<code>--disable-everything</code>关闭所有模块，可以使用<code>enable</code>/<code>disable</code>来开启关闭某个模块，或者某个编解码器、某个封装器、某个协议。</p>
<h3><a id="encoders%E4%B8%8Edecoders%E7%BC%96%E7%A0%81%E8%A7%A3%E7%A0%81" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>encoders与decoders(编码-解码)</h3>
<p><code>encoder</code>和<code>decoder</code>在<code>libavcodec</code>模块，可以用<code>./configure --list-encoders</code>或者<code>ffmpeg -encoders</code>查看支持的编码器。同样地，可以用<code>./configure --list-decoders</code>或者<code>ffmpeg -decoders</code>查看支持的解码器。我们可以先<code>--disable-encoders</code>，<code>--enable-encoder=aac</code>,h264 其中lib开头的表示第三方库，encoders列表如下(有删减)：</p>
<pre class="line-numbers"><code class="language-plain_text">aac                   hevc_nvenc            libxavs           pcm_f32be            pcm_u16le                                     
aac_at                hevc_qsv              libxavs2          pcm_f32le            pcm_u24be                                      
ac3                   hevc_v4l2m2m          libxvid           pcm_f64be            pcm_u24le                                    
ac3_fixed             hevc_vaapi            ljpeg             pcm_f64le            pcm_u32be                                       
adpcm_ima_wav         hevc_videotoolbox     mjpeg             pcm_mulaw            pcm_u32le                                     
adpcm_ms              libaom_av1            mjpeg_qsv         pcm_mulaw_at         pcm_u8                                     
ass                   libfdk_aac            mjpeg_vaapi       pcm_s16be            png                                     
dvbsub                libmp3lame            movtext           pcm_s16be_planar     srt                                    
dvdsub                libopencore_amrnb     mp2               pcm_s16le            ssa                                         
dvvideo               libopenh264           mpeg1video        pcm_s16le_planar     subrip                                       
eac3                  libopenjpeg           mpeg2_qsv         pcm_s24be            text                                           
flac                  libopus               mpeg2_vaapi       pcm_s24le            truehd                                           
flv                   libshine              mpeg2video        pcm_s24le_planar     vorbis                                         
gif                   libspeex              mpeg4             pcm_s32be            vp8_vaapi                                                 
h263                  libvorbis             msmpeg4v2         pcm_s32le            vp9_vaapi                                           
h264_nvenc            libvpx_vp8            msmpeg4v3         pcm_s32le_planar     webvtt                                            
h264_omx              libvpx_vp9            nvenc_h264        pcm_s64be            wmav1                                           
h264_qsv              libwebp               nvenc_hevc        pcm_s64le            wmav2                                           
h264_v4l2m2m          libx264               opus              pcm_s8               wmv1                                           
h264_vaapi            libx264rgb            pcm_alaw          pcm_s8_planar        wmv2                                            
h264_videotoolbox     libx265               pcm_alaw_at       pcm_u16be            zlib
</code></pre>
<h3><a id="muxers%E4%B8%8Edemuxers%E5%B0%81%E8%A3%85%E8%A7%A3%E5%B0%81%E8%A3%85" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>muxers与demuxers(封装-解封装)</h3>
<p><code>muxer</code>和<code>demuxer</code>在<code>libavformat</code>模块，可以用<code>./configure --list-muxers</code>或者<code>ffmpeg -muxers</code>查看支持的封装器。同样地，可以用<code>./configure --list-demuxers</code>或者<code>ffmpeg -demuxers</code>查看支持的解封装器。我们可以先<code>--disable-muxers</code>，<code>--enable-muxer=mp3</code>,matroska  列表如下：</p>
<pre class="line-numbers"><code class="language-plain_text">ac3           h263              mpeg1system     pcm_f64le      rawvideo      
adts          h264              mpeg1vcd        pcm_mulaw      rm                   
amr           hevc              mpeg1video      pcm_s16be      rtp         
apng          hls               mpeg2dvd        pcm_s16le      rtp_mpegts 
asf           image2            mpeg2svcd       pcm_s24be      rtsp     
asf_stream    image2pipe        mpeg2video      pcm_s24le      smoothstreaming 
ass           ipod              mpeg2vob        pcm_s32be      sox 
avi           lrc               mpegts          pcm_s32le      srt 
avs2          m4v               mpjpeg          pcm_s8         swf 
codec2        matroska          ogg             pcm_u16be      truehd                                                                              
dash          matroska_audio    ogv             pcm_u16le      vc1                                                                          
eac3          mjpeg             opus            pcm_u24be      wav                                                                     
f4v           mov               pcm_alaw        pcm_u24le      webm                                                                           
flac          mp2               pcm_f32be       pcm_u32be      webm_chunk                                                                         
flv           mp3               pcm_f32le       pcm_u32le      webm_dash_manifest                                                                              webvtt
gif           mp4               pcm_f64be       pcm_u8         webp
</code></pre>
<h3><a id="protocols%E5%8D%8F%E8%AE%AE" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>protocols(协议)</h3>
<p><code>protocol</code>也是在<code>libavformat</code>模块中，<code>./configure --list-protocols</code>或者<code>ffmpeg -protocols</code>查看支持的协议，包括<code>http</code>、<code>https</code>、<code>hls</code>、<code>rtmp</code>等，列表如下：</p>
<pre class="line-numbers"><code class="language-plain_text">async                   ffrtmphttp              https                   libsmbclient            prompeg                 rtp                     udp
bluray                  file                    icecast                 libsrt                  rtmp                    sctp                    udplite
cache                   ftp                     librtmp                 libssh                  rtmpe                   srtp                    unix
concat                  gopher                  librtmpe                md5                     rtmps                   subfile
crypto                  hls                     librtmps                mmsh                    rtmpt                   tcp
data                    http                    librtmpt                mmst                    rtmpte                  tee
ffrtmpcrypt             httpproxy               librtmpte               pipe                    rtmpts                  tls
</code></pre>
<h3><a id="parsers%E8%A7%A3%E6%9E%90%E5%99%A8" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>parsers(解析器)</h3>
<p>parser在libavfilter模块中，提供各种filter，比如音频：amix、atempo，视频：rotate、hflip，我们可以根据需求--enable-parser来开启，具体列表如下(有删减)：</p>
<pre class="line-numbers"><code class="language-plain_text">acompressor    apad            convolve         hilbert         setpts
acontrast      aphaser         copy             histogram       silencedetect
acopy          aresample       crop             hstack          silenceremove
acrossfade     areverse        dcshift          hue             smartblur
acrossover     asetpts         deblock          join            sobel
adeclick       asetrate        delogo           limiter         stereo3d
adeclip        ashowinfo       denoise_vaapi    lowpass         streamselect
adelay         atempo          deshake          lut             subtitles
aecho          atrim           drawbox          lutrgb          superequalizer
aemphasis      bandpass        drawgrid         midequalizer    surround
afade          biquad          drawtext         mix             transpose
afftfilt       blackdetect     earwax           movie           treble
afir           blackframe      edgedetect       noise           tremolo
aformat        blend           equalizer        normalize       unsharp
ahistogram     boxblur         fftfilt          ocr             vflip
aiir           channelmap      firequalizer     overlay         volume
alimiter       chorus          freezedetect     phase           volumedetect
allpass        colorbalance    gblur            qp              vstack
aloop          colorkey        greyedge         removelogo      waveform
amerge         colormatrix     haas             reverse
amix           colorspace      hflip            rotate
anequalizer    concat          highpass         scale
</code></pre>
<h3><a id="%E5%88%86%E6%9E%90configure%E7%BB%93%E6%9E%84" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>分析configure结构</h3>
<p>在FFmpeg源码目录有个configure配置脚本，使用<code>./configure --help</code>进行查看，可以看到如下结构的编译选项：</p>
<p>得到 configure 的基本选项参数</p>
<table>
<thead>
<tr>
<th style="text-align: left">Help options:</th>
<th style="text-align: left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left">--help</td>
<td style="text-align: left">显示此帮助信息</td>
</tr>
<tr>
<td style="text-align: left">--list-decoders</td>
<td style="text-align: left">显示所有可用解码器</td>
</tr>
<tr>
<td style="text-align: left">--list-encoders</td>
<td style="text-align: left">显示所有可用编码器</td>
</tr>
<tr>
<td style="text-align: left">--list-hwaccels</td>
<td style="text-align: left">显示所有可用硬件设备</td>
</tr>
<tr>
<td style="text-align: left">--list-demuxers</td>
<td style="text-align: left">显示所有可用解封装器</td>
</tr>
<tr>
<td style="text-align: left">--list-muxers</td>
<td style="text-align: left">显示所有可用封装器</td>
</tr>
<tr>
<td style="text-align: left">--list-parsers</td>
<td style="text-align: left">显示所有可用解析器</td>
</tr>
<tr>
<td style="text-align: left">--list-protocols</td>
<td style="text-align: left">显示所有可用协议</td>
</tr>
<tr>
<td style="text-align: left">--list-filters</td>
<td style="text-align: left">显示所有可用过滤器</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align: left">Licensing options:</th>
<th style="text-align: left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left">--enable-gpl</td>
<td style="text-align: left">允许使用 GPL（默认关闭）</td>
</tr>
<tr>
<td style="text-align: left">--enable-version3</td>
<td style="text-align: left">升级(L)GPL到版本3</td>
</tr>
<tr>
<td style="text-align: left">--enable-nonfree</td>
<td style="text-align: left">允许使用非自由代码</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align: left">Configuration options:</th>
<th style="text-align: left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left">--prefix=PREFIX</td>
<td style="text-align: left">安装程序到指定目录（默认/usr/local）,</td>
</tr>
<tr>
<td style="text-align: left">--disable-static</td>
<td style="text-align: left">生成构建静态库</td>
</tr>
<tr>
<td style="text-align: left">--enable-shared</td>
<td style="text-align: left">不生成动态库</td>
</tr>
<tr>
<td style="text-align: left">--enable-small</td>
<td style="text-align: left">启用库文件大小优化<strong>非常重要</strong></td>
</tr>
<tr>
<td style="text-align: left">--disable-all</td>
<td style="text-align: left">禁用组件,库</td>
</tr>
<tr>
<td style="text-align: left">--disable-autodetect</td>
<td style="text-align: left">禁用检测外部库</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align: left">Program options:</th>
<th style="text-align: left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left">--disable-programs</td>
<td style="text-align: left">禁用命令行构建</td>
</tr>
<tr>
<td style="text-align: left">--disable-ffmpeg</td>
<td style="text-align: left">禁用ffmpeg构建</td>
</tr>
<tr>
<td style="text-align: left">--disable-ffplay</td>
<td style="text-align: left">禁用ffplay构建</td>
</tr>
<tr>
<td style="text-align: left">--disable-ffprobe</td>
<td style="text-align: left">禁用ffprobe构建</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align: left">Component options:</th>
<th style="text-align: left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left">--disable-avdevice</td>
<td style="text-align: left">禁用libavdevice构建</td>
</tr>
<tr>
<td style="text-align: left">--disable-avcodec</td>
<td style="text-align: left">禁用libavcodec构建</td>
</tr>
<tr>
<td style="text-align: left">--disable-avformat</td>
<td style="text-align: left">禁用libavformat构建</td>
</tr>
<tr>
<td style="text-align: left">--disable-swresample</td>
<td style="text-align: left">禁用libswresample构建</td>
</tr>
<tr>
<td style="text-align: left">--disable-swscale</td>
<td style="text-align: left">禁用libswscale构建</td>
</tr>
<tr>
<td style="text-align: left">--disable-postproc</td>
<td style="text-align: left">禁用libpostproc构建</td>
</tr>
<tr>
<td style="text-align: left">--disable-avfilter</td>
<td style="text-align: left">禁用libavfilter构建</td>
</tr>
<tr>
<td style="text-align: left">--disable-pthreads</td>
<td style="text-align: left">禁用 pthreads（多线程）</td>
</tr>
<tr>
<td style="text-align: left">--disable-network	disable</td>
<td style="text-align: left">启用网络支持</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align: left">Individual component:</th>
<th style="text-align: left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left">--disable-everything</td>
<td style="text-align: left">禁用所有组件</td>
</tr>
<tr>
<td style="text-align: left">--disable-encoder=NAME</td>
<td style="text-align: left">禁用[Name]编码器</td>
</tr>
<tr>
<td style="text-align: left">--enable-encoder=NAME</td>
<td style="text-align: left">开启[Name]编码器</td>
</tr>
<tr>
<td style="text-align: left">--disable-encoders</td>
<td style="text-align: left">禁用所有编码器</td>
</tr>
<tr>
<td style="text-align: left">--disable-decoder=NAME</td>
<td style="text-align: left">禁用[Name]解码器</td>
</tr>
<tr>
<td style="text-align: left">--enable-decoder=NAME</td>
<td style="text-align: left">开启[Name]解码器</td>
</tr>
<tr>
<td style="text-align: left">--disable-decoders</td>
<td style="text-align: left">禁用所有解码器</td>
</tr>
<tr>
<td style="text-align: left">--disable-muxer=NAME</td>
<td style="text-align: left">禁用[Name]音视频封装器</td>
</tr>
<tr>
<td style="text-align: left">--enable-muxer=NAME</td>
<td style="text-align: left">开启[Name]音视频封装器</td>
</tr>
<tr>
<td style="text-align: left">--disable-muxers</td>
<td style="text-align: left">禁用所有音视频封装器</td>
</tr>
<tr>
<td style="text-align: left">--disable-demuxer=NAME</td>
<td style="text-align: left">禁用[Name]音视频解封装器</td>
</tr>
<tr>
<td style="text-align: left">--enable-demuxer=NAME</td>
<td style="text-align: left">启用[Name]音视频解封装器</td>
</tr>
<tr>
<td style="text-align: left">--disable-demuxers</td>
<td style="text-align: left">禁用所有音视频解封装器</td>
</tr>
<tr>
<td style="text-align: left">--enable-parser=NAME</td>
<td style="text-align: left">启用[Name]解析器</td>
</tr>
<tr>
<td style="text-align: left">--disable-parser=NAME</td>
<td style="text-align: left">禁用[Name]解析器</td>
</tr>
<tr>
<td style="text-align: left">--disable-parsers</td>
<td style="text-align: left">禁用所有解析器</td>
</tr>
<tr>
<td style="text-align: left">--enable-protocol=NAME</td>
<td style="text-align: left">启用[Name]协议</td>
</tr>
<tr>
<td style="text-align: left">--disable-protocol=NAME</td>
<td style="text-align: left">禁用[Name]协议</td>
</tr>
<tr>
<td style="text-align: left">--disable-protocols</td>
<td style="text-align: left">禁用所有协议</td>
</tr>
<tr>
<td style="text-align: left">--enable-filter=NAME</td>
<td style="text-align: left">启用[Name]过滤器</td>
</tr>
<tr>
<td style="text-align: left">--disable-filter=NAME</td>
<td style="text-align: left">禁用[Name]过滤器</td>
</tr>
<tr>
<td style="text-align: left">--disable-filters</td>
<td style="text-align: left">禁用所有过滤器</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align: left">External library:</th>
<th style="text-align: left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left">--disable-avfoundation</td>
<td style="text-align: left">禁用Apple AVFoundation框架</td>
</tr>
<tr>
<td style="text-align: left">--enable-jni</td>
<td style="text-align: left">启用JNI支持 [no]</td>
</tr>
<tr>
<td style="text-align: left">--enable-libaom</td>
<td style="text-align: left">通过libaom启用AV1视频编解码器 [no]</td>
</tr>
<tr>
<td style="text-align: left">--enable-libass</td>
<td style="text-align: left">启用libass字幕渲染 [no]</td>
</tr>
<tr>
<td style="text-align: left">--enable-libdav1d</td>
<td style="text-align: left">通过libdav1d启用AV1解码 [no]</td>
</tr>
<tr>
<td style="text-align: left">--enable-libfdk-aac</td>
<td style="text-align: left">通过libfdk-aac启用AAC de/encoding</td>
</tr>
<tr>
<td style="text-align: left">--enable-libfontconfig</td>
<td style="text-align: left">启用libfontconfig [no]</td>
</tr>
<tr>
<td style="text-align: left">--enable-libfreetype</td>
<td style="text-align: left">启用libfreetype, drawtext需要libfreetype</td>
</tr>
<tr>
<td style="text-align: left">--enable-libfribidi</td>
<td style="text-align: left">启用libfribidi，改善drawtext</td>
</tr>
<tr>
<td style="text-align: left">--enable-libmp3lame</td>
<td style="text-align: left">通过libmp3lame启用MP3编码 [no]</td>
</tr>
<tr>
<td style="text-align: left">--enable-libopencv</td>
<td style="text-align: left">通过libopencv启用视频过滤 [no]</td>
</tr>
<tr>
<td style="text-align: left">--enable-libopenh264</td>
<td style="text-align: left">通过OpenH264启用H.264编码 [no]</td>
</tr>
<tr>
<td style="text-align: left">--enable-libopus</td>
<td style="text-align: left">通过libopus启用Opus de/encoding [no]</td>
</tr>
<tr>
<td style="text-align: left">--enable-librtmp</td>
<td style="text-align: left">启用RTMP[E]支持通过librtmp [no]</td>
</tr>
<tr>
<td style="text-align: left">--enable-libshine</td>
<td style="text-align: left">启用定点MP3编码</td>
</tr>
<tr>
<td style="text-align: left">--enable-libsoxr</td>
<td style="text-align: left">包括libsoxr重采样 [no]</td>
</tr>
<tr>
<td style="text-align: left">--enable-libspeex</td>
<td style="text-align: left">通过libspeex启用Speex de/encoding</td>
</tr>
<tr>
<td style="text-align: left">--enable-libtensorflow</td>
<td style="text-align: left">启用TensorFlow作为DNN模块 [no]</td>
</tr>
<tr>
<td style="text-align: left">--enable-libvorbis</td>
<td style="text-align: left">启用Vorbis en/解码通过libvorbis</td>
</tr>
<tr>
<td style="text-align: left">--enable-libvpx</td>
<td style="text-align: left">通过libvpx使VP8和VP9 de/encoding生效</td>
</tr>
<tr>
<td style="text-align: left">--enable-libx264</td>
<td style="text-align: left">通过x264启用H.264编码 [no]</td>
</tr>
<tr>
<td style="text-align: left">--enable-libx265</td>
<td style="text-align: left">通过x265启用HEVC编码 [no]</td>
</tr>
<tr>
<td style="text-align: left">--enable-mediacodec</td>
<td style="text-align: left">启用Android MediaCodec支持 [no]</td>
</tr>
<tr>
<td style="text-align: left">--enable-opengl</td>
<td style="text-align: left">支持OpenGL渲染 [no]</td>
</tr>
<tr>
<td style="text-align: left">--enable-openssl</td>
<td style="text-align: left">启用openssl，需要HTTPS支持</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align: left">Toolchain options:</th>
<th style="text-align: left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left">--arch=ARCH</td>
<td style="text-align: left">选择机器架构（默认 x86）</td>
</tr>
<tr>
<td style="text-align: left">--cpu=CPU</td>
<td style="text-align: left">选用最低的 cpu（影响指令的选择， 可以在老 CPU 上出错）</td>
</tr>
<tr>
<td style="text-align: left">--cross-prefix=PREFIX</td>
<td style="text-align: left">使用PREFIX作为编译工具</td>
</tr>
<tr>
<td style="text-align: left">--enable-cross-compile</td>
<td style="text-align: left">启用交叉编译</td>
</tr>
<tr>
<td style="text-align: left">--sysroot=PATH</td>
<td style="text-align: left">交叉构建的根路径</td>
</tr>
<tr>
<td style="text-align: left">--target-os=OS</td>
<td style="text-align: left">编译目标系统</td>
</tr>
<tr>
<td style="text-align: left">--toolchain=NAME</td>
<td style="text-align: left">根据名称设置工具</td>
</tr>
<tr>
<td style="text-align: left">--nm=NM</td>
<td style="text-align: left">使用nm工具 [nm -g]</td>
</tr>
<tr>
<td style="text-align: left">--ar=AR</td>
<td style="text-align: left">使用存档工具AR [ar]</td>
</tr>
<tr>
<td style="text-align: left">--as=AS</td>
<td style="text-align: left">使用汇编程序 AS</td>
</tr>
<tr>
<td style="text-align: left">--strip=STRIP</td>
<td style="text-align: left">使用strip工具 [strip]</td>
</tr>
<tr>
<td style="text-align: left">--cc=CC</td>
<td style="text-align: left">使用C语言编译器 CC [gcc]</td>
</tr>
<tr>
<td style="text-align: left">--cxx=CXX</td>
<td style="text-align: left">使用C++语言编译器 CXX [g++]</td>
</tr>
<tr>
<td style="text-align: left">--ld=LD</td>
<td style="text-align: left">使用链接器 LD</td>
</tr>
<tr>
<td style="text-align: left">--host-cc=HOSTCC</td>
<td style="text-align: left">use host C compiler HOSTCC</td>
</tr>
<tr>
<td style="text-align: left">--host-cflags=HCFLAGS</td>
<td style="text-align: left">use HCFLAGS when compiling</td>
</tr>
<tr>
<td style="text-align: left">--host-ld=HOSTLD</td>
<td style="text-align: left">use host linker HOSTLD</td>
</tr>
<tr>
<td style="text-align: left">--host-ldflags=HLDFLAGS</td>
<td style="text-align: left">use HLDFLAGS when linking</td>
</tr>
<tr>
<td style="text-align: left">--host-extralibs=HLIBS</td>
<td style="text-align: left">use libs HLIBS when linking</td>
</tr>
<tr>
<td style="text-align: left">--host-os=OS</td>
<td style="text-align: left">compiler host OS</td>
</tr>
<tr>
<td style="text-align: left">--extra-cflags=ECFLAGS</td>
<td style="text-align: left">add ECFLAGS to CFLAGS</td>
</tr>
<tr>
<td style="text-align: left">--extra-cxxflags=ECFLAGS</td>
<td style="text-align: left">add ECFLAGS to CXXFLAGS</td>
</tr>
<tr>
<td style="text-align: left">--extra-ldflags=ELDFLAGS</td>
<td style="text-align: left">add ELDFLAGS to LDFLAGS</td>
</tr>
<tr>
<td style="text-align: left">--log[=FILE</td>
<td style="text-align: left">yes</td>
</tr>
<tr>
<td style="text-align: left">--libdir=DIR</td>
<td style="text-align: left">安装库到指定目录（默认 prefix/lib）</td>
</tr>
<tr>
<td style="text-align: left">--shlibdir=DIR</td>
<td style="text-align: left">指定共享库路径（默认 prefix/lib）</td>
</tr>
<tr>
<td style="text-align: left">--incdir=DIR</td>
<td style="text-align: left">指定 includes 路径（默认 prefix/include/ffmpeg）</td>
</tr>
<tr>
<td style="text-align: left">--mandir=DIR</td>
<td style="text-align: left">指定 man page 路径（默认 prefix/man）</td>
</tr>
<tr>
<td style="text-align: left">--enable-mp3lame</td>
<td style="text-align: left">启用 mp3 编码 libmp3lame（默认禁用）</td>
</tr>
<tr>
<td style="text-align: left">--enable-libogg</td>
<td style="text-align: left">启用 ogg 支持 libogg（默认关闭）</td>
</tr>
<tr>
<td style="text-align: left">--enable-vorbis</td>
<td style="text-align: left">启用 Vorbis 支持 libvorbis（默认关闭）</td>
</tr>
<tr>
<td style="text-align: left">--enable-faad</td>
<td style="text-align: left">启用 faad 支持 libfaad（默认关闭）</td>
</tr>
<tr>
<td style="text-align: left">--enable-faadbin</td>
<td style="text-align: left">启用 faad 运行时链接支持（默认关闭）</td>
</tr>
<tr>
<td style="text-align: left">--enable-faac</td>
<td style="text-align: left">启用 faac 支持 libfaac（默认关闭）</td>
</tr>
<tr>
<td style="text-align: left">--enable-libgsm</td>
<td style="text-align: left">启用 GSM 支持 libgsm（默认关闭）</td>
</tr>
<tr>
<td style="text-align: left">--enable-xvid</td>
<td style="text-align: left">启用 xvid 支持 xvidcore（默认关闭）</td>
</tr>
<tr>
<td style="text-align: left">--enable-x264</td>
<td style="text-align: left">启 用 H.264 编 码 （ 默 认 关 闭 ）</td>
</tr>
<tr>
<td style="text-align: left">--enable-mingw32</td>
<td style="text-align: left">启用 MinGW 本地/交叉 win 环境编译</td>
</tr>
<tr>
<td style="text-align: left">--enable-mingwce</td>
<td style="text-align: left">启用 MinGW 本地/交叉 winCE 环境编译</td>
</tr>
<tr>
<td style="text-align: left">--enable-a52</td>
<td style="text-align: left">启用 A52 支持（默认关闭）</td>
</tr>
<tr>
<td style="text-align: left">--enable-a52bin</td>
<td style="text-align: left">启用运行时打开 liba52.so.0（默认关闭）</td>
</tr>
<tr>
<td style="text-align: left">--enable-dts</td>
<td style="text-align: left">启用 DTS 支持（默认关闭）</td>
</tr>
<tr>
<td style="text-align: left">--enable-pp</td>
<td style="text-align: left">启用后加工支持（默认关闭）</td>
</tr>
<tr>
<td style="text-align: left">--enable-static</td>
<td style="text-align: left">构建静态库（默认启用）</td>
</tr>
<tr>
<td style="text-align: left">--disable-static</td>
<td style="text-align: left">禁止构建静态库（默认关闭）</td>
</tr>
<tr>
<td style="text-align: left">--enable-share</td>
<td style="text-align: left">构建共享库（默认关闭）</td>
</tr>
<tr>
<td style="text-align: left">--disable-shared</td>
<td style="text-align: left">禁止构建共享库（默认启用）</td>
</tr>
<tr>
<td style="text-align: left">--enable-amr_nb</td>
<td style="text-align: left">启用 amr_nb float 音频编解码器</td>
</tr>
<tr>
<td style="text-align: left">--enable-amr_nb-fixed</td>
<td style="text-align: left">启用 fixed amr_nb codec</td>
</tr>
<tr>
<td style="text-align: left">--enable-amr_wb</td>
<td style="text-align: left">启用 amr_wb float 音频编解码器</td>
</tr>
<tr>
<td style="text-align: left">--enable-amr_if2</td>
<td style="text-align: left">启用 amr_wb IF2 音频编解码器</td>
</tr>
<tr>
<td style="text-align: left">--enable-sunmlib</td>
<td style="text-align: left">启用 Sun medialib（默认关闭）</td>
</tr>
<tr>
<td style="text-align: left">--enable-pthreads</td>
<td style="text-align: left">启用 pthreads（多线程）（默认关闭）</td>
</tr>
<tr>
<td style="text-align: left">--enable-dc1394</td>
<td style="text-align: left">启用 libdc1394、libraw1394 抓取 IIDC-1394（默认关闭）</td>
</tr>
<tr>
<td style="text-align: left">--enable-swscaler</td>
<td style="text-align: left">启用计数器支持？（默认关闭）</td>
</tr>
<tr>
<td style="text-align: left">--enable-avisynth</td>
<td style="text-align: left">允许读取 AVISynth 脚本本件（默认关闭）</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align: left">Advanced options (experts only)</th>
<th style="text-align: left">高级选项参数（供专业人员使用）</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left">--source-path=PATH</td>
<td style="text-align: left">源码的路径（当前为/root/flv/ffmpeg）</td>
</tr>
<tr>
<td style="text-align: left">--cross-prefix=PREFIX</td>
<td style="text-align: left">为编译工具指定路径</td>
</tr>
<tr>
<td style="text-align: left">--cross-compile</td>
<td style="text-align: left">假定使用了交叉编译</td>
</tr>
<tr>
<td style="text-align: left">--cc=CC</td>
<td style="text-align: left">指定使用何种 C 编译器（默认 gcc）</td>
</tr>
<tr>
<td style="text-align: left">--make=MAKE</td>
<td style="text-align: left">使用特定的 make</td>
</tr>
<tr>
<td style="text-align: left">--extra-cflags=ECFLAGS</td>
<td style="text-align: left">添加 ECFLAGS 到 CFLAGS</td>
</tr>
<tr>
<td style="text-align: left">--extra-ldflags=ELDFLAGS</td>
<td style="text-align: left">添加 ELDFLAGS 到 LDFLAGS（默认-Wl，--as-needed）</td>
</tr>
<tr>
<td style="text-align: left">--extra-libs=ELIBS</td>
<td style="text-align: left">添加 ELIBS</td>
</tr>
<tr>
<td style="text-align: left">--build-suffix=SUFFIX</td>
<td style="text-align: left">为专用程序添加后缀</td>
</tr>
<tr>
<td style="text-align: left">--arch=ARCH</td>
<td style="text-align: left">选择机器架构（默认 x86）</td>
</tr>
<tr>
<td style="text-align: left">--cpu=CPU</td>
<td style="text-align: left">选用最低的 cpu（影响指令的选择， 可以在老 CPU 上出错）</td>
</tr>
<tr>
<td style="text-align: left">--powerpc-perf-enable</td>
<td style="text-align: left">启用 PPC 上面的性能报告（需要启用 PMC）</td>
</tr>
<tr>
<td style="text-align: left">--disable-mmx</td>
<td style="text-align: left">禁用 MMX</td>
</tr>
<tr>
<td style="text-align: left">--disable-armv5te</td>
<td style="text-align: left">禁用 armv5te</td>
</tr>
<tr>
<td style="text-align: left">--disable-iwmmxt</td>
<td style="text-align: left">禁用 iwmmxt</td>
</tr>
<tr>
<td style="text-align: left">--disable-altivec</td>
<td style="text-align: left">禁用 AltiVec</td>
</tr>
<tr>
<td style="text-align: left">--disable-audio-oss</td>
<td style="text-align: left">禁用 OSS 音频支持（默认启用）</td>
</tr>
<tr>
<td style="text-align: left">--disable-audio-beos</td>
<td style="text-align: left">禁用 BeOS 音频支持（默认启用）</td>
</tr>
<tr>
<td style="text-align: left">--disable-v4l</td>
<td style="text-align: left">禁用 video4linux 提取（默认启用）</td>
</tr>
<tr>
<td style="text-align: left">--disable-v4l2</td>
<td style="text-align: left">禁用 video4linux2 提取（默认启用）</td>
</tr>
<tr>
<td style="text-align: left">--disable-bktr</td>
<td style="text-align: left">禁 用 bktr 视 频 提 取 （ 默 认 启 用 ）</td>
</tr>
<tr>
<td style="text-align: left">--disable-dv1394</td>
<td style="text-align: left">禁用 DV1394 提取（默认启用）</td>
</tr>
<tr>
<td style="text-align: left">--disable-network</td>
<td style="text-align: left">禁用网络支持（默认支持）</td>
</tr>
<tr>
<td style="text-align: left">--disable-ipv6</td>
<td style="text-align: left">禁用 ipv6 支持（默认支持）</td>
</tr>
<tr>
<td style="text-align: left">--disable-zlib</td>
<td style="text-align: left">禁用 zlib（默认支持）</td>
</tr>
<tr>
<td style="text-align: left">--disable-simple_idct</td>
<td style="text-align: left">禁用 simple IDCT 例程（默认启用）</td>
</tr>
<tr>
<td style="text-align: left">--disable-vhook</td>
<td style="text-align: left">禁用 video hooking 支持</td>
</tr>
<tr>
<td style="text-align: left">--enable-gprof</td>
<td style="text-align: left">enable profiling with gprof [no]</td>
</tr>
<tr>
<td style="text-align: left">--disable-debug</td>
<td style="text-align: left">禁用调试符号</td>
</tr>
<tr>
<td style="text-align: left">--disable-opts</td>
<td style="text-align: left">禁用编译器最优化</td>
</tr>
<tr>
<td style="text-align: left">--disable-mpegaudio-hp</td>
<td style="text-align: left">启用更快的解码 MPEG 音频（但精确度较低）（ 默认禁用）</td>
</tr>
<tr>
<td style="text-align: left">--disable-protocols</td>
<td style="text-align: left">禁用 I/O 协议支持（默认启用）</td>
</tr>
<tr>
<td style="text-align: left">--disable-ffserver</td>
<td style="text-align: left">禁用生成 ffserver</td>
</tr>
<tr>
<td style="text-align: left">--disable-ffplay</td>
<td style="text-align: left">禁用生成 ffplay</td>
</tr>
<tr>
<td style="text-align: left">--enable-small</td>
<td style="text-align: left">启用优化文件尺寸大小（牺牲速度）</td>
</tr>
<tr>
<td style="text-align: left">--enable-memalign-hack</td>
<td style="text-align: left">启用模拟内存排列，由内存调试器干涉？</td>
</tr>
<tr>
<td style="text-align: left">--disable-strip</td>
<td style="text-align: left">禁用剥离可执行程序和共享库</td>
</tr>
<tr>
<td style="text-align: left">--disable-encoder=NAME</td>
<td style="text-align: left">禁用 XX 编码器</td>
</tr>
<tr>
<td style="text-align: left">--enable-encoder=NAME</td>
<td style="text-align: left">启用 XX 编码器</td>
</tr>
<tr>
<td style="text-align: left">--disable-decoder=NAME</td>
<td style="text-align: left">禁用 XX 解码器</td>
</tr>
<tr>
<td style="text-align: left">--enable-decoder=NAME</td>
<td style="text-align: left">启用 XX 解码器</td>
</tr>
<tr>
<td style="text-align: left">--disable-encoders</td>
<td style="text-align: left">禁用所有编码器</td>
</tr>
<tr>
<td style="text-align: left">--disable-decoders</td>
<td style="text-align: left">禁用所有解码器</td>
</tr>
<tr>
<td style="text-align: left">--disable-muxer=NAME</td>
<td style="text-align: left">禁用 XX 混音器</td>
</tr>
<tr>
<td style="text-align: left">--enable-muxer=NAME</td>
<td style="text-align: left">启用 XX 混音器</td>
</tr>
<tr>
<td style="text-align: left">--disable-muxers</td>
<td style="text-align: left">禁用所有混音器</td>
</tr>
<tr>
<td style="text-align: left">--disable-demuxer=NAME</td>
<td style="text-align: left">禁用 XX 解轨器</td>
</tr>
<tr>
<td style="text-align: left">--enable-demuxer=NAME</td>
<td style="text-align: left">启用 XX 解轨器</td>
</tr>
<tr>
<td style="text-align: left">--disable-demuxers</td>
<td style="text-align: left">禁用所有解轨器</td>
</tr>
<tr>
<td style="text-align: left">--enable-parser=NAME</td>
<td style="text-align: left">启用 XX 剖析器</td>
</tr>
<tr>
<td style="text-align: left">--disable-parser=NAME</td>
<td style="text-align: left">禁用 XX 剖析器</td>
</tr>
<tr>
<td style="text-align: left">--disable-parsers</td>
<td style="text-align: left">禁用所有剖析器</td>
</tr>
</tbody>
</table>
<h3><a id="ffmpeg%E8%A3%81%E5%89%AA%E4%BC%98%E5%8C%96%E5%AE%9E%E4%BE%8B" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>FFmpeg裁剪优化实例</h3>
<p>对 <code>ffmpeg</code> 的裁剪优化主要是对 <code>ffplay</code> 的裁剪优化，我们制定的需求是能播放测试文件（视频为 mpeg4编码、音频为 mp2编码， 且为 AVI复用），根据需求，找到相应的选项，或禁用或启用，最后的命令如下</p>
<pre class="line-numbers"><code class="language-plain_text">./configure \
    --disable-yasm \                
    --disable-parsers \             # 禁用所有解析器
    --disable-decoders \            # 禁用所有解码器
    --disable-encoders \            # 禁用所有编码器
    --enable-decoder=mpeg4 \        # 启用 mpeg4 的编码器
    --disable-muxers \              # 禁用所有复用
    --disable-demuxers \            # 禁用所有解复用
    --enable-demuxer=avi \          # 启用AVI复用
    --enable-decoder=mp2 \          # 启用mp2编码
    --disable-protocols \           # 禁用所有协议
    --enable-protocol=file \        # 启用文件协议
    --disable-filters \             # 禁用所有过滤器
    --disable-bsfs                  # 禁用所有码流过滤器
</code></pre>
<h4><a id="%E5%A2%9E%E5%8A%A0%E7%BC%96%E8%AF%91%E9%80%89%E9%A1%B9" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>增加编译选项</h4>
<p>首先我们可以增加一些常规编译选项来减小最终编译包的大小。</p>
<p>我们可以使用configure -h命令来列出configure程序支持的编译选项，每一项编译选项后都有对应的解释，其中能够直接减小编译包大小的命令有如下几个：</p>
<pre class="line-numbers"><code class="language-plain_text">–enable-small ：使用编译速度来换取编译包大小。
–disable-runtime-cpudetect ：禁止运行时检测CPU性能，可以编出较小的包。
–disable-doc ：禁止编译文档，可以避免将文档编译入包中。
–disable-htmlpages ：禁止编译html文档，可以避免将文档编译入包中。
–disable-htmlpages ：禁止编译html文档，可以避免将文档编译入包中。
–disable-manpages ：禁止编译man文档，可以避免将文档编译入包中。
–disable-podpages ：禁止编译pod文档，可以避免将文档编译入包中。
–disable-txtpages ：禁止编译txt文档，可以避免将文档编译入包中。
</code></pre>
<h4><a id="%E5%87%8F%E5%B0%91%E4%B8%8D%E5%BF%85%E8%A6%81%E7%9A%84%E5%B7%A5%E5%85%B7" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>减少不必要的工具</h4>
<p>在最开始我们介绍了ffmpeg是基于libav开发的一套工具，除了ffmpeg之外，基于libav开发的工具还有：ffplay、ffprobe以及ffserver。</p>
<p>这些不必要的工具我们是可以禁止掉的，相关选项为：</p>
<pre class="line-numbers"><code class="language-plain_text">–disable-programs ：禁止编译命令行工具。
–disable-ffmpeg ：禁止编译ffmpeg工具。
–disable-ffplay ：禁止编译ffplay工具。
–disable-ffprobe ：禁止编译ffprobe工具。
–disable-ffserver ：禁止编译ffserver工具。
</code></pre>
<h4><a id="%E5%87%8F%E5%B0%91%E4%B8%8D%E5%BF%85%E8%A6%81%E7%9A%84%E6%A8%A1%E5%9D%97" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>减少不必要的模块</h4>
<ul>
<li>libavdevice</li>
<li>libavcodec</li>
<li>libavformat</li>
<li>libswresample</li>
<li>libswscale</li>
<li>libpostproc</li>
<li>libavfilter</li>
<li>libavresample</li>
</ul>
<ol>
<li><strong>libavdevice</strong> 该模块主要负责与硬件设备的交互，若无需该模块，可使用--disable-avdevice禁止编译。</li>
<li><strong>libavcodec</strong> 该模块主要负责解码与编码，若无需该模块，可使用--disable-avcodec禁止编译，不过该模块为libav核心模块，非特殊情况最好不要禁止。</li>
<li><strong>libavformat</strong> 该模块主要负责解封装与封装，若无需该模块，可使用--disable-avformat禁止编译，不过该模块为libav核心模块，非特殊情况最好不要禁止。</li>
<li><strong>libswresample</strong> 该模块主要负责对原始音频数据进行格式转换，若无需该模块，可使用--disable-swresample禁止编译。</li>
<li><strong>libswscale</strong> 该模块主要负责对原始视频数据进行场景转换、色彩映射以及格式转换，若无需该模块，可使用--disable-swscale禁止编译。</li>
<li><strong>libpostproc</strong> 该模块主要负责对音视频进行后期处理，若无需该模块，可使用--disable-postproc禁止编译。</li>
<li><strong>libavfilter</strong> 该模块主要负责音视频的过滤，包括裁剪、位置、水印等，若无需该模块，可使用--disable-avfilter禁止编译。</li>
<li><strong>libavresample</strong> 该模块主要负责音视频封装编解码格式预设，该模块默认不编译，若要进行编译，使用--enable-avresample。</li>
</ol>
<h4><a id="%E5%87%8F%E5%B0%91%E4%B8%8D%E5%BF%85%E8%A6%81%E8%AE%BE%E5%A4%87%E7%9A%84%E7%BC%96%E8%AF%91" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>减少不必要设备的编译</h4>
<p>libav可以从硬件设备中获取输入，同时也可以输出至硬件设备。</p>
<p>我们可以指定支持的输入输出设备来避免不必要的编译：</p>
<pre class="line-numbers"><code class="language-plain_text">–disable-devices ：禁止所有设备的编译。
–disable-indevs ：禁止所有输入设备的编译。
–disable-indev=NAME ：禁止特定输入设备的编译。
–enable-indev=NAME ：允许特定输入设备的编译，搭配–disable-indevs可以实现单纯指定支持的输入设备。
–disable-outdevs ：禁止所有输出设备的编译。
–disable-outdev=NAME ：禁止特定输出设备的编译。
–enable-outdev=NAME ：允许特定输出设备的编译，搭配–disable-outdevs可以实现单纯指定支持的输出设备。
</code></pre>
<p>关于libav支持的输入输出设备名称，可以使用configure --list-indevs和configure --list-outdevs命令获取。</p>
<h4><a id="%E5%87%8F%E5%B0%91%E4%B8%8D%E5%BF%85%E8%A6%81%E8%A7%A3%E6%9E%90%E5%99%A8%E7%9A%84%E7%BC%96%E8%AF%91" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>减少不必要解析器的编译</h4>
<p>libav可以对输入的数据进行格式检测，该功能由解析器(parser)负责。</p>
<p>我们可以指定支持的解析器来避免不必要的编译：</p>
<pre class="line-numbers"><code class="language-plain_text">–disable-parsers ：禁止所有解析器的编译。
–disable-parser=NAME ：禁止特定解析器的编译。
–enable-parser=NAME ：允许特定解析器的编译，搭配–disable-parsers可以实现单纯指定支持的解析器。
</code></pre>
<p>关于libav支持的解析器名称，可以使用configure --list-parsers命令获取。</p>
<h4><a id="%E5%87%8F%E5%B0%91%E4%B8%8D%E5%BF%85%E8%A6%81%E7%9A%84%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%B5%81%E8%BF%87%E6%BB%A4%E5%99%A8%E7%9A%84%E7%BC%96%E8%AF%91" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>减少不必要的二进制流过滤器的编译</h4>
<p>libav可以将输入的数据转为二进制数据，同时可以对二进制数据进行特殊的处理，该功能由二进制流过滤器(bit stream filter)负责。</p>
<p>我们可以指定支持的二进制流过滤器来避免不必要的编译：</p>
<pre class="line-numbers"><code class="language-plain_text">–disable-bsfs ：禁止所有二进制流过滤器的编译。
–disable-bsf=NAME ：禁止特定二进制流过滤器的编译。
–enable-bsf=NAME ：允许特定二进制流过滤器的编译，搭配–disable-bsfs可以实现单纯指定支持的二进制流过滤器。
</code></pre>
<p>关于libav支持二进制流过滤器名称，可以使用configure --list-bsfs命令获取。</p>
<h4><a id="%E5%87%8F%E5%B0%91%E4%B8%8D%E5%BF%85%E8%A6%81%E7%9A%84%E5%8D%8F%E8%AE%AE%E7%BC%96%E8%AF%91" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>减少不必要的协议编译</h4>
<p>libav对于如何读入数据及输出数据制定了一套协议，同时libav内置了一些满足协议的方式，这些方式可以通过configure --list-protocols列出。</p>
<p>我们可以指定支持的输入输出方式来避免不必要的编译：</p>
<pre class="line-numbers"><code class="language-plain_text">–disable-protocols ：禁止所有输入输出方式的编译。
–disable-protocol=NAME ：禁止特定输入输出方式的编译。
–enable-protocol=NAME ：允许特定输入输出方式的编译，搭配–disable-protocols可以实现单纯指定支持的输入输出方式。
</code></pre>
<p>我们必须指定至少一种输入输出方式，通常通过使用--disable-protocols搭配--enable-protocol=NAME来完成。</p>
<h4><a id="%E5%87%8F%E5%B0%91%E4%B8%8D%E5%BF%85%E8%A6%81%E7%BB%84%E4%BB%B6%E7%9A%84%E7%BC%96%E8%AF%91" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>减少不必要组件的编译</h4>
<p>接下来先简单介绍一下libav处理音视频的流程，以将 FLV格式(H264视频+AAC音频) 转换为 AVI格式(MPEG2视频+MP3音频) 为例</p>
<p>在该过程中，负责解封装的是<strong>分离器(demuxer)</strong>、负责封装的是<strong>复用器(muxer)</strong>、负责音视频解码的为<strong>解码器(decoder)</strong>、负责编码的为<strong>编码器(encoder)</strong>。</p>
<p>我们可以从libav所支持的四个组件的类型来减少不必要的编译。</p>
<p>可以使用以下命令获取组件所支持的类型：</p>
<pre class="line-numbers"><code class="language-configure" data-meta="--list-demuxers">configure --list-muxers
configure --list-decoders
configure --list-encoders
</code></pre>
<ol>
<li>分离器</li>
</ol>
<pre class="line-numbers"><code class="language-–disable-demuxers" data-meta="：禁止所有分离器的编译。">–disable-demuxer=NAME ：禁止特定分离器的编译。
–enable-demuxer=NAME ：允许特定分离器的编译，搭配–disable-demuxers。
</code></pre>
<ol start="2">
<li>复用器</li>
</ol>
<pre class="line-numbers"><code class="language-plain_text">–disable-muxers ：禁止所有复用器的编译。
–disable-muxer=NAME ：禁止特定复用器的编译。
–enable-muxer=NAME ：允许特定复用器的编译，搭配–disable-muxers。
</code></pre>
<ol start="3">
<li>解码器</li>
</ol>
<pre class="line-numbers"><code class="language-plain_text">–disable-decoders ：禁止所有解码器的编译。
–disable-decoder=NAME ：禁止特定解码器的编译。
–enable-decoder=NAME ：允许特定解码器的编译，搭配–disable-decoders。
</code></pre>
<ol start="4">
<li>编码器</li>
</ol>
<pre class="line-numbers"><code class="language-plain_text">–disable-encoders ：禁止所有编码器的编译。
–disable-encoder=NAME ：禁止特定编码器的编译。
–enable-encoder=NAME ：允许特定编码器的编译，搭配–disable-encoders。
</code></pre>


    

      </div>

      <div class="row">
        <div class="large-6 columns">
        <p class="text-left" style="padding:15px 0px;">
      
          <a href="16530515663967.html" 
          title="Previous Post: Android集成FFmpeg">&laquo; Android集成FFmpeg</a>
      
        </p>
        </div>
        <div class="large-6 columns">
      <p class="text-right" style="padding:15px 0px;">
      
          <a  href="16530148144447.html" 
          title="Next Post: FFmpeg">FFmpeg &raquo;</a>
      
      </p>
        </div>
      </div>
      <div class="comments-wrap">
        <div class="share-comments">
          

          

          
        </div>
      </div>
    </div><!-- article-wrap -->
  </div><!-- large 8 -->




 <div class="large-4 medium-4 columns">
  <div class="hide-for-small">
    <div id="sidebar" class="sidebar">
          <div id="site-info" class="site-info">
            
                <div class="site-a-logo"><img src="media/17043409056338/logo.jpeg" /></div>
            
                <h1>MagicalRice的Blog</h1>
                <div class="site-des">技术博客</div>
                <div class="social">









<a target="_blank" class="github" target="_blank" href="https://github.com/adolphJane" title="GitHub">GitHub</a>
<a target="_blank" class="email" href="mailto:adolphdeveloper@gmail.com" title="Email">Email</a>
  <a target="_blank" class="rss" href="atom.xml" title="RSS">RSS</a>
                
              	 </div>
          	</div>

             

              <div id="site-categories" class="side-item ">
                <div class="side-header">
                  <h2>Categories</h2>
                </div>
                <div class="side-content">

      	<p class="cat-list">
        
            <a href="Android.html"><strong>Android</strong></a>
        
            <a href="%E6%9C%8D%E5%8A%A1%E5%99%A8.html"><strong>服务器</strong></a>
        
            <a href="C++.html"><strong>C++</strong></a>
        
            <a href="UI.html"><strong>UI</strong></a>
        
            <a href="%E4%BB%A3%E7%A0%81%E4%B9%8B%E7%BE%8E.html"><strong>代码之美</strong></a>
        
            <a href="Game.html"><strong>Game</strong></a>
        
            <a href="Python.html"><strong>Python</strong></a>
        
            <a href="Mac.html"><strong>Mac</strong></a>
        
            <a href="%E5%85%B6%E4%BB%96.html"><strong>其他</strong></a>
        
            <a href="Flutter.html"><strong>Flutter</strong></a>
        
            <a href="ReactNative.html"><strong>ReactNative</strong></a>
        
            <a href="Java.html"><strong>Java</strong></a>
        
            <a href="%E9%9F%B3%E8%A7%86%E9%A2%91%E5%BC%80%E5%8F%91.html"><strong>音视频开发</strong></a>
        
            <a href="%E7%BD%91%E7%BB%9C.html"><strong>网络</strong></a>
        
            <a href="%E7%BD%91%E9%A1%B5.html"><strong>网页</strong></a>
        
            <a href="%E5%B7%A5%E5%85%B7-1-2.html"><strong>工具</strong></a>
        
            <a href="%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD.html"><strong>人工智能</strong></a>
        
            <a href="%E5%88%9B%E4%B8%9A.html"><strong>创业</strong></a>
        
            <a href="%E6%80%9D%E7%BB%B4%E6%8F%90%E5%8D%87.html"><strong>思维提升</strong></a>
        
            <a href="GPU%E6%B8%B2%E6%9F%93.html"><strong>GPU渲染</strong></a>
         
        </p>


                </div>
              </div>

              <div id="site-categories" class="side-item">
                <div class="side-header">
                  <h2>Recent Posts</h2>
                </div>
                <div class="side-content">
                <ul class="posts-list">
	      
		      
			      <li class="post">
			        <a href="16946950953153.html">Debian 关闭休眠</a>
			      </li>
		     
		  
		      
			      <li class="post">
			        <a href="16946000122919.html">Debian 查看 Linux 硬盘大小、类型和硬件信息</a>
			      </li>
		     
		  
		      
			      <li class="post">
			        <a href="16945997927114.html">Debian 查看硬件温度</a>
			      </li>
		     
		  
		      
			      <li class="post">
			        <a href="16945994928906.html">Debian 查看Linux版本</a>
			      </li>
		     
		  
		      
			      <li class="post">
			        <a href="16945989810086.html">Debian 查看CPU和内存</a>
			      </li>
		     
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		   
		  		</ul>
                </div>
              </div>
        </div><!-- sidebar -->
      </div><!-- hide for small -->
</div><!-- large 4 -->

</div><!-- row -->

 <div class="page-bottom clearfix">
  <div class="row">
   <p class="copyright">Copyright &copy; 2015
Powered by <a target="_blank" href="http://www.mweb.im">MWeb</a>,&nbsp; 
Theme used <a target="_blank" href="http://github.com">GitHub CSS</a>.</p>
  </div>
</div>

        </section>
      </div>
    </div>

<style>.mweb-charts{background:#fff;}
body{ box-sizing: border-box;
    margin: 0 auto;}
@media print{
    pre, code, pre code {
     overflow: visible !important;
     white-space: pre-wrap !important;       /* css-3 */
     white-space: -moz-pre-wrap !important;  /* Mozilla, since 1999 */
     white-space: -pre-wrap !important;      /* Opera 4-6 */
     white-space: -o-pre-wrap !important;    /* Opera 7 */
     word-wrap: break-word !important;       /* Internet Explorer 5.5+ */
    }
    html,body{margin:0;padding:4px;}
}



div.code-toolbar {
  position: relative;
}

div.code-toolbar > .toolbar {
  position: absolute;
  z-index: 10;
  top: .3em;
  right: .2em;
  transition: opacity 0.3s ease-in-out;
  opacity: 0;
}

div.code-toolbar:hover > .toolbar {
  opacity: 1;
}

/* Separate line b/c rules are thrown out if selector is invalid.
   IE11 and old Edge versions don't support :focus-within. */
div.code-toolbar:focus-within > .toolbar {
  opacity: 1;
}

div.code-toolbar > .toolbar > .toolbar-item {
  display: inline-block;
}

div.code-toolbar > .toolbar > .toolbar-item > a {
  cursor: pointer;
}

div.code-toolbar > .toolbar > .toolbar-item > button {
  background: none;
  border: 0;
  color: inherit;
  font: inherit;
  line-height: normal;
  overflow: visible;
  padding: 0;
  -webkit-user-select: none; /* for button */
  -moz-user-select: none;
  -ms-user-select: none;
}

div.code-toolbar > .toolbar > .toolbar-item > a,
div.code-toolbar > .toolbar > .toolbar-item > button,
div.code-toolbar > .toolbar > .toolbar-item > span {
  color: inherit;
  font-size: .8em;
  padding: 4px .5em;
  background: #f5f2f0;
  background: rgba(224, 224, 224, 0.4);
  box-shadow: 0 2px 0 0 rgba(0,0,0,0.2);
  border-radius: .5em;
}

div.code-toolbar > .toolbar > .toolbar-item > a:hover,
div.code-toolbar > .toolbar > .toolbar-item > a:focus,
div.code-toolbar > .toolbar > .toolbar-item > button:hover,
div.code-toolbar > .toolbar > .toolbar-item > button:focus,
div.code-toolbar > .toolbar > .toolbar-item > span:hover,
div.code-toolbar > .toolbar > .toolbar-item > span:focus {
  color: inherit;
  text-decoration: none;
}
</style><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/prism.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script><script>!function(){if("undefined"!=typeof Prism&&"undefined"!=typeof document){var e=[],t={},n=function(){};Prism.plugins.toolbar={};var a=Prism.plugins.toolbar.registerButton=function(n,a){var r;r="function"==typeof a?a:function(e){var t;return"function"==typeof a.onClick?((t=document.createElement("button")).type="button",t.addEventListener("click",(function(){a.onClick.call(this,e)}))):"string"==typeof a.url?(t=document.createElement("a")).href=a.url:t=document.createElement("span"),a.className&&t.classList.add(a.className),t.textContent=a.text,t},n in t?console.warn('There is a button with the key "'+n+'" registered already.'):e.push(t[n]=r)},r=Prism.plugins.toolbar.hook=function(a){var r=a.element.parentNode;var l=a.element.classList;if(l.contains('language-mermaid') || l.contains('language-echarts') || l.contains('language-plantuml')){return;} if(r&&/pre/i.test(r.nodeName)&&!r.parentNode.classList.contains("code-toolbar")){var o=document.createElement("div");o.classList.add("code-toolbar"),r.parentNode.insertBefore(o,r),o.appendChild(r);var i=document.createElement("div");i.classList.add("toolbar");var l=e,d=function(e){for(;e;){var t=e.getAttribute("data-toolbar-order");if(null!=t)return(t=t.trim()).length?t.split(/\s*,\s*/g):[];e=e.parentElement}}(a.element);d&&(l=d.map((function(e){return t[e]||n}))),l.forEach((function(e){var t=e(a);if(t){var n=document.createElement("div");n.classList.add("toolbar-item"),n.appendChild(t),i.appendChild(n)}})),o.appendChild(i)}};a("label",(function(e){var t=e.element.parentNode;if(t&&/pre/i.test(t.nodeName)&&t.hasAttribute("data-label")){var n,a,r=t.getAttribute("data-label");try{a=document.querySelector("template#"+r)}catch(e){}return a?n=a.content:(t.hasAttribute("data-url")?(n=document.createElement("a")).href=t.getAttribute("data-url"):n=document.createElement("span"),n.textContent=r),n}})),Prism.hooks.add("complete",r)}}();</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/toolbar/prism-toolbar.min.css"><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script><style>div.code-toolbar > .toolbar > .toolbar-item > a, div.code-toolbar > .toolbar > .toolbar-item > button, div.code-toolbar > .toolbar > .toolbar-item > span {padding: 4px .5em; background: #f5f2f0; background: rgba(224, 224, 224, 0.4);}</style><script>window.MathJax = {     tex: { tags: 'ams', inlineMath: [ ['$','$'], ['\\(','\\)'] ] } ,     startup: {     pageReady() {       return MathJax.startup.defaultPageReady().then(function () {          window.mweb_mathjax_ready_val = 'yes';          if(window.mweb_mathjax_ready !== undefined){ mweb_mathjax_ready(); }       });     }   }};document.addEventListener('DOMContentLoaded', function(event) {    if (typeof Prism != 'undefined') {         Prism.highlightAll();     }});window.mweb_mathjax_ready_val = '';function theMWebMathJaxRenderIsReady(key){ return window.mweb_mathjax_ready_val; }</script><script>window.MathJax = { tex: { tags: 'ams', inlineMath: [ ['$','$'], ['\\(','\\)'] ] } }; </script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"></script>

<style type="text/css">
figure{margin: 0;padding: 0;}
figcaption{text-align:center;}

/* PrismJS 1.14.0
 http://prismjs.com/download.html#themes=prism&languages=markup+css+clike+javascript */
/**
 * prism.js default theme for JavaScript, CSS and HTML
 * Based on dabblet (http://dabblet.com)
 * @author Lea Verou
 */

code[class*="language-"],
pre[class*="language-"] {
    color: black;
    background: none;
    text-shadow: 0 1px white;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;
    
    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;
    
    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
}

pre[class*="language-"]::-moz-selection, pre[class*="language-"] ::-moz-selection,
code[class*="language-"]::-moz-selection, code[class*="language-"] ::-moz-selection {
    text-shadow: none;
    background:#b3d4fc;
}

pre[class*="language-"]::selection, pre[class*="language-"] ::selection,
code[class*="language-"]::selection, code[class*="language-"] ::selection {
    text-shadow: none;
    background: #b3d4fc;
}

@media print {
    code[class*="language-"],
    pre[class*="language-"] {
        text-shadow: none;
    }
}

/* Code blocks */
pre[class*="language-"] {
    padding: 1em;
    margin: .5em 0;
    overflow: auto;
}

:not(pre) > code[class*="language-"],
pre[class*="language-"] {
    background: #F7F7F7;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
    padding: .1em;
    border-radius: .3em;
    white-space: normal;
}

.token.comment,
.token.prolog,
.token.doctype,
.token.cdata {
    color: slategray;
}

.token.punctuation {
    color: #999;
}

.namespace {
    opacity: .7;
}

.token.property,
.token.tag,
.token.boolean,
.token.number,
.token.constant,
.token.symbol,
.token.deleted {
    color: #905;
}

.token.selector,
.token.attr-name,
.token.string,
.token.char,
.token.builtin,
.token.inserted {
    color: #690;
}

.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string {
    color: #9a6e3a;
    background: hsla(0, 0%, 100%, .5);
}

.token.atrule,
.token.attr-value,
.token.keyword {
    color: #07a;
}

.token.function,
.token.class-name {
    color: #DD4A68;
}

.token.regex,
.token.important,
.token.variable {
    color: #e90;
}

.token.important,
.token.bold {
    font-weight: bold;
}
.token.italic {
    font-style: italic;
}

.token.entity {
    cursor: help;
}


pre[class*="language-"].line-numbers {
    position: relative;
    padding-left: 3.8em;
    counter-reset: linenumber;
}

pre[class*="language-"].line-numbers > code {
    position: relative;
    white-space: inherit;
}

.line-numbers .line-numbers-rows {
    position: absolute;
    pointer-events: none;
    top: 0;
    font-size: 100%;
    left: -3.8em;
    width: 3em; /* works for line-numbers below 1000 lines */
    letter-spacing: -1px;
    border-right: 1px solid #999;

    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;

}

    .line-numbers-rows > span {
        pointer-events: none;
        display: block;
        counter-increment: linenumber;
    }

        .line-numbers-rows > span:before {
            content: counter(linenumber);
            color: #999;
            display: block;
            padding-right: 0.8em;
            text-align: right;
        }

</style>

  
    

    <script src="asset/js/foundation.min.js"></script>
    <script>
      $(document).foundation();
      function fixSidebarHeight(){
        var w1 = $('.markdown-body').height();
          var w2 = $('#sidebar').height();
          if (w1 > w2) { $('#sidebar').height(w1); };
      }
      $(function(){
        fixSidebarHeight();
      })
      $(window).load(function(){
          fixSidebarHeight();
      });
     
    </script>



  </body>
</html>
