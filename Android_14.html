<!doctype html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
    
  Android - MagicalRice的Blog
  
  </title>
  
  
  <link href="atom.xml" rel="alternate" title="MagicalRice的Blog" type="application/atom+xml">
    <link rel="stylesheet" href="asset/css/foundation.min.css" />
    <link rel="stylesheet" href="asset/css/docs.css" />
    <script src="asset/js/vendor/modernizr.js"></script>
    <script src="asset/js/vendor/jquery.js"></script>
 
<script type="text/javascript">
  function before_search(){
    var searchVal = 'site:adolph.cc ' + document.getElementById('search_input').value;
    document.getElementById('search_q').value = searchVal;
    return true;
  }
</script>
  </head>
  <body class="antialiased hide-extras">
    
    <div class="marketing off-canvas-wrap" data-offcanvas>
      <div class="inner-wrap">


<nav class="top-bar docs-bar hide-for-small" data-topbar>


  <section class="top-bar-section">
  <div class="row">
      <div style="position: relative;width:100%;"><div style="position: absolute; width:100%;">
        <ul id="main-menu" class="left">
        
        <li id=""><a target="_self" href="index.html">Home</a></li>
        
        <li id=""><a target="_self" href="archives.html">Archives</a></li>
        
        </ul>

        <ul class="right" id="search-wrap">
          <li>
<form target="_blank" onsubmit="return before_search();" action="https://google.com/search" method="get">
    <input type="hidden" id="search_q" name="q" value="" />
    <input tabindex="1" type="search" id="search_input"  placeholder="Search"/>
</form>
</li>
          </ul>
      </div></div>
  </div>
  </section>

</nav>

        <nav class="tab-bar show-for-small">
  <a href="javascript:void(0)" class="left-off-canvas-toggle menu-icon">
    <span> &nbsp; MagicalRice的Blog</span>
  </a>
</nav>

<aside class="left-off-canvas-menu">
      <ul class="off-canvas-list">
        
        <li><a target="_self" href="index.html">Home</a></li>
        
        <li><a target="_self" href="archives.html">Archives</a></li>
        

    <li><label>Categories</label></li>

        
            <li><a href="Android.html">Android</a></li>
        
            <li><a href="%E6%9C%8D%E5%8A%A1%E5%99%A8.html">服务器</a></li>
        
            <li><a href="C++.html">C++</a></li>
        
            <li><a href="UI.html">UI</a></li>
        
            <li><a href="%E4%BB%A3%E7%A0%81%E4%B9%8B%E7%BE%8E.html">代码之美</a></li>
        
            <li><a href="Game.html">Game</a></li>
        
            <li><a href="Python.html">Python</a></li>
        
            <li><a href="Mac.html">Mac</a></li>
        
            <li><a href="%E5%85%B6%E4%BB%96.html">其他</a></li>
        
            <li><a href="Flutter.html">Flutter</a></li>
        
            <li><a href="ReactNative.html">ReactNative</a></li>
        
            <li><a href="Java.html">Java</a></li>
        
            <li><a href="%E9%9F%B3%E8%A7%86%E9%A2%91%E5%BC%80%E5%8F%91.html">音视频开发</a></li>
        
            <li><a href="%E7%BD%91%E7%BB%9C.html">网络</a></li>
        
            <li><a href="%E7%BD%91%E9%A1%B5.html">网页</a></li>
        
            <li><a href="%E5%B7%A5%E5%85%B7-1-2.html">工具</a></li>
        
            <li><a href="%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD.html">人工智能</a></li>
        
            <li><a href="%E5%88%9B%E4%B8%9A.html">创业</a></li>
        
            <li><a href="%E6%80%9D%E7%BB%B4%E6%8F%90%E5%8D%87.html">思维提升</a></li>
        
            <li><a href="GPU%E6%B8%B2%E6%9F%93.html">GPU渲染</a></li>
         

      </ul>
    </aside>

<a class="exit-off-canvas" href="#"></a>


        <section id="main-content" role="main" class="scroll-container">
        
       

 <script type="text/javascript">
	$(function(){
		$('#menu_item_index').addClass('is_active');
	});
</script>
<div class="row">
	<div class="large-8 medium-8 columns">
		<div class="markdown-body home-categories">
		
			<div class="article">
                <a class="clearlink" href="15561207870919.html">
                
                  <h1>Android学习路线</h1>
                  <div class="a-content">
                      
                      <div class="a-content-text">
                        
                        	<h2><a id="%E5%89%8D%E8%A8%80" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>前言</h2>
<p>Android学习路线从4个阶段来对Android的学习过程做一个全面的分析:Android初级、中级、高级以及资深工程师。<br />
只针对Android应用开发，不针对Rom开发和逆向工程等。方便起见虚拟“小D”为成长人物进行描述。</p>
<h2><a id="%E5%88%9D%E7%BA%A7%E5%B7%A5%E7%A8%8B%E5%B8%88" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>初级工程师</h2>
<p>小D之前完全没接触过Android开发，对编程基础、数据结构、C语言都有一定基础，Java语法什么的也都掌握的比较好，并不会搞Android。</p>
<p>首先需要购买一本Android入门的书籍（现在更推荐直接看视频教程结合网上教程动手练习），为了更快地学习Android，小D业余时间也都用来一边看书一边照着书中的例子敲代码，结果2周时间小D就把这本书学了一遍。看完这本书后对Android的历史、结构、代码规范等都有了一个大概的了解，可以写出一些简单的Activity。这个时候在小D眼里，Android开发很简单很好玩，通过在xml中摆放一些按钮文本框什么的就可以做一些界面了。</p>
<p>小D开始跟着他的技术导师做需求，一些简单的小需求不在话下了。突然有一天来了一个需求，该需求要求在Activity中为一个button加一个动画效果，小D慌了：“完全没接触过，书上也没有讲，怎么办呢？”小D冷静了下，搜索“Android 动画”，打开前几个链接，恍然大悟，照着网上的例子把需求给实现了。</p>
<p>后来导师告诉他：“学好Android，官方文档是必须看的，既全面又权威”。然后小D如获至宝，花了一年时间把上面的guide和training都看了一遍，并且他还动手抄了几个小例子。</p>
<p>有一天，小D又需要做一个动画相关的需求，又搜索“Android 动画”，突然他楞了一下：”总不能每次写动画都要搜索吧！“，于是他在CSDN开了一个博客，把动画相关的知识点都写上去，为的是后面再写动画相关的代码就不用去搜了，事实如何呢？后面再写动画相关的代码，的确不用再去搜了，因为通过写一篇动画博客，他把动画相关的细节都已经记住了，这样他就可以不用再去参考任何文档了，后来小D还学会了把一些琐碎的不方便放在博客上的东西写到了笔记上面，什么时候忘了10秒钟以内都可以快速找回来，而不是花10分钟去再次搜索一遍。</p>
<p>总结：Android入门的时候，需要有一本入门书（或者视频教程），好好学习书中的内容，同时花一年时间把Android官方文档中的training和guide看一遍，同时通过写博客和记笔记的方式来做总结，建议让自己的每篇博客都有价值些。通过一年时间的学习，相信每个人都可以达到中级工程师的水平。</p>
<p>技术要求：</p>
<ul>
<li>基本知识点<br />
比如四大组件如何使用、如何创建Service、如何进行布局、简单的自定义View、动画等常见技术</li>
<li>书籍推荐<br />
《第一行代码 Android》、《疯狂Android》</li>
</ul>
<h2><a id="%E4%B8%AD%E7%BA%A7%E5%B7%A5%E7%A8%8B%E5%B8%88" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>中级工程师</h2>
<p>小D经过一年的努力学习终于成为Android中级工程师了。到了中级工程师，已经可以在公司里干很多体力活了，但是一些很重要的任务小D还不能一个人承担起来，这个时候小D需要学习的内容就很多了，如下所示：</p>
<ul>
<li>AIDL：熟悉AIDL，理解其工作原理，懂transact和onTransact的区别；</li>
<li>Binder：从Java层大概理解Binder的工作原理，懂Parcel对象的使用；</li>
<li>多进程：熟练掌握多进程的运行机制，懂Messenger、Socket等；</li>
<li>事件分发：弹性滑动、滑动冲突等；</li>
<li>玩转View：View的绘制原理、各种自定义View；</li>
<li>动画系列：熟悉View动画和属性动画的不同点，懂属性动画的工作原理；</li>
<li>懂性能优化、熟悉mat等工具</li>
<li>懂点常见的设计模式</li>
</ul>
<h3><a id="%E5%AD%A6%E4%B9%A0%E6%96%B9%E6%B3%95" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>学习方法</h3>
<p>阅读进阶书籍，阅读Android源码，阅读官方文档并尝试自己写相关的技术文章，需要有一定技术深度和自我思考。在这个阶段的学习过程中，有2个点是比较困扰大家的，一个是阅读源码，另一个是自定义View以及滑动冲突。<br />
如何阅读源码呢？这是个头疼的问题，但是源码必须要读。阅读源码的时候不要深入代码细节不可自拔，要关注代码的流程并尽量挖掘出对应用层开发有用的结论。另外仔细阅读源码中对一个类或者方法的注释，在看不懂源码时，源码中的注释可以帮你更好地了解源码中的工作原理，这个过程虽然艰苦，但是别无他法。<br />
如何玩转自定义View呢？我们要透过现象看本质，更多地去关注自定义view所需的知识点：</p>
<ul>
<li>搞懂view的滑动原理</li>
<li>搞懂如何实现弹性滑动</li>
<li>搞懂view的滑动冲突</li>
<li>搞懂view的measure、layout和draw</li>
<li>然后再学习几个已有的自定义view的例子</li>
<li>最后就可以搞定自定义view了，所谓万变不离其宗</li>
</ul>
<p>大概再需要1-2年时间，即可达到高级工程师的技术水平。我个人认为通过《Android开发艺术探索》和《Android群英传》可以缩短这个过程为0.5-1年。注意，达到高级工程师的技术水平不代表就可以立刻成为高级工程师（受机遇、是否跳槽的影响），但是技术达到了，成为高级工程师只是很简单的事。</p>
<h3><a id="%E6%8A%80%E6%9C%AF%E8%A6%81%E6%B1%82%EF%BC%9A" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>技术要求：</h3>
<ul>
<li>稍微深入的知识点<br />
AIDL、Messenger、Binder、多进程、动画、滑动冲突、自定义View、消息队列等</li>
<li>书籍推荐<br />
《Android开发艺术探索》、《Android群英传》</li>
</ul>
<h2><a id="%E9%AB%98%E7%BA%A7%E5%B7%A5%E7%A8%8B%E5%B8%88" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>高级工程师</h2>
<p>小D成为了梦寐以求的高级工程师。这个时候小D的Android水平已经不错了，但是小D的目标是资深工程师，小D听说资深工程师月薪可以达到30k+。<br />
为了成为Android资深工程师，需要学习的东西就更多了，并且有些并不是那么具体了，如下所示：</p>
<ul>
<li>继续加深理解”稍微深入的知识点“中所定义的内容</li>
<li>了解系统核心机制：
<ol>
<li>了解SystemServer的启动过程</li>
<li>了解主线程的消息循环模型</li>
<li>了解AMS和PMS的工作原理</li>
<li>能够回答问题”一个应用存在多少个Window？“</li>
<li>了解四大组件的大概工作流程</li>
<li>…</li>
</ol>
</li>
<li>基本知识点的细节
<ol>
<li>Activity的启动模式以及异常情况下不同Activity的表现</li>
<li>Service的onBind和onReBind的关联</li>
<li>onServiceDisconnected(ComponentName className)和binderDied()的区别</li>
<li>AsyncTask在不同版本上的表现细节</li>
<li>线程池的细节和参数配置</li>
<li>…</li>
</ol>
</li>
<li>熟悉设计模式，有架构意识</li>
</ul>
<h3><a id="%E5%AD%A6%E4%B9%A0%E6%96%B9%E6%B3%95" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>学习方法</h3>
<p>这个时候已经没有太具体的学习方法了，无非就是看书、看源码和做项目，平时多种总结，尽量将知识融会贯通从而形成一种体系化的感觉。<br />
同时这个阶段对架构是有一定要求的，架构是抽象的，但是设计模式是具体的，所以一定要加强下设计模式的学习。关于设计模式的学习，推荐《Android 源码设计模式解析与实战》，既可以学习设计模式，又可能体会到Android源码中的设计思想。</p>
<h3><a id="%E6%8A%80%E6%9C%AF%E8%A6%81%E6%B1%82%EF%BC%9A" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>技术要求：</h3>
<ul>
<li>稍微深入的知识点</li>
<li>系统核心机制</li>
<li>基本知识点的细节</li>
<li>设计模式和架构</li>
<li>书籍推荐<br />
《Android开发艺术探索》、《Android 源码设计模式解析与实战》、《Android内核剖析》</li>
</ul>
<h2><a id="%E8%B5%84%E6%B7%B1%E5%B7%A5%E7%A8%8B%E5%B8%88" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>资深工程师</h2>
<p>更多了解不同业务的架构问题，内核源码设计原理，整理并开源自己的组件</p>

                        
                      </div>
                  </div>
                </a>
                <div class="read-more clearfix">
                  <div class="more-left left">
                  
                    <span class="date">2017/09/02</span>
                    <span>posted in&nbsp;</span> 
          				  
          					    <span class="posted-in"><a href='Android.html'>Android</a></span>
          				   
                    

                  </div>
                  <div class="more-right right">
                  <span class="comments">
                      

                       
                  </span>
                  </div>
                </div>
              </div><!-- article -->
        
			<div class="article">
                <a class="clearlink" href="15561207870883.html">
                
                  <h1>Android学习目录</h1>
                  <div class="a-content">
                      
                      <div class="a-content-text">
                        
                        	<p><figure><img src="media/15561207870883/15713359653854.png" alt="" /></figure></p>
<h2><a id="%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>基础知识</h2>
<p><figure><img src="media/15561207870883/15713359733510.jpg" alt="" /></figure></p>
<p><figure><img src="media/15561207870883/15713359818799.jpg" alt="" /></figure></p>
<p><figure><img src="media/15561207870883/15713359891037.jpg" alt="" /></figure></p>
<p><figure><img src="media/15561207870883/15713359971568.jpg" alt="" /></figure></p>
<p>{% post_link android-learning-path Android学习路线 %}</p>
<p>{% post_link android-study Android学习资源 %}</p>
<h3><a id="java%E5%9F%BA%E7%A1%80" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Java基础</h3>
<p><figure><img src="media/15561207870883/15713360098241.jpg" alt="" /></figure></p>
<h4><a id="java%E5%AD%97%E7%AC%A6%E4%B8%B2-string%E3%80%81stringbuilder%E3%80%81stringbuffer" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Java字符串(String、StringBuilder、StringBuffer)</h4>
<h4><a id="java%E7%BA%BF%E7%A8%8B%E6%B1%A0-newfixedthreadpool%E3%80%81newsinglethreadexecutor%E3%80%81newcachethreadpool" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Java线程池(newFixedThreadPool、newSingleThreadExecutor、newCacheThreadPool)</h4>
<ul>
<li>
<p><code>newFixedThreadPool</code>：newFixedThreadPool,创建固定大小的线程池，poolCoreSize和maxPoolSize 相等，到达coreSize,则将新的任务放到缓存队列，有线程执行完毕，直接去取。</p>
</li>
<li>
<p><code>newSingleThreadExecutor</code>：newSingleThreadExecutor,创建一个单线程的线程池，核心池的大小和最大池大小都为1.</p>
</li>
<li>
<p><code>newCacheThreadPool</code>：newCacheThreadPool,无大小限制的线程池，提交一个任务就创建一个线程执行。</p>
</li>
</ul>
<h4><a id="java%E9%9B%86%E5%90%88" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Java集合</h4>
<p><strong>Collection</strong>:</p>
<ul>
<li>List:
<ul>
<li>LinkedList</li>
<li>ArrayList</li>
<li>Vector</li>
</ul>
</li>
<li>Set
<ul>
<li>HashSet</li>
<li>TreeSet</li>
</ul>
</li>
</ul>
<p><strong>Map</strong>:</p>
<ul>
<li>HashMap</li>
<li>TreeMap</li>
<li>HashTable</li>
</ul>
<h4><a id="java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Java内存模型</h4>
<p>Java 内存模型这一块非常重要，因为它涉及到我们程序的性能，我们需要知道，内存是如何分配的，成员变量、静态变量、局部变量、对象等各自分配到哪一个区：栈内存、堆内存</p>
<h3><a id="%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>数据结构</h3>
<h3><a id="%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E6%80%9D%E6%83%B3" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>面向对象思想</h3>
<p>OOP的的三大特性：封装、继承、多态。</p>
<h3><a id="%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>设计模式</h3>
<h4><a id="%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A16%E5%A4%A7%E5%8E%9F%E5%88%99" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>程序设计6大原则</h4>
<ul>
<li>单一职责原则</li>
<li>里氏替换原则</li>
<li>依赖倒置原则</li>
<li>接口隔离原则</li>
<li>迪米特法则</li>
<li>开闭原则</li>
</ul>
<h3><a id="android-studio" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Android Studio</h3>
<p>{% post_link android-studio-plugin Android Studio插件 %}</p>
<p>{% post_link android-studio-keywords Android Studio快捷键 %}</p>
<h3><a id="android-sdk" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Android SDK</h3>
<h3><a id="activity" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Activity</h3>
<p>{% post_link android-activity-launcher Android-启动Acivity的工作流程 %}</p>
<h3><a id="service" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Service</h3>
<h3><a id="broadcastreceiver" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>BroadcastReceiver</h3>
<h3><a id="contentprovider" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>ContentProvider</h3>
<h3><a id="statusbar" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>StatusBar</h3>
<p>{% post_link android-statusbar Android-StatusBar详细学习 %}</p>
<h3><a id="fragment" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Fragment</h3>
<h4><a id="dialogfragment" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>DialogFragment</h4>
<p>{% post_link android-dialogfragment Android-DialogFragment详细学习 %}</p>
<h2><a id="ui" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>UI</h2>
<p>{% post_link android-xml Android-XML参数详细了解 %}</p>
<h3><a id="layout" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Layout</h3>
<p>{% post_link android-layout Android-Layout详细学习 %}</p>
<h4><a id="framelayout" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>FrameLayout</h4>
<h4><a id="linearlayout" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>LinearLayout</h4>
<h4><a id="tablelayout" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>TableLayout</h4>
<h4><a id="gridlayout" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>GridLayout</h4>
<h4><a id="relativelayout" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>RelativeLayout</h4>
<h4><a id="drawerlayout" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>DrawerLayout</h4>
<h4><a id="slidingpanelayout" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>SlidingPaneLayout</h4>
<h4><a id="coordinatorlayout" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>CoordinatorLayout</h4>
<p>{% post_link android-coordinatorLayout Android-CoordinatorLayout %}</p>
<h3><a id="view" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>View</h3>
<p>{% post_link android-view-workflow Android-View的工作流程 %}</p>
<h4><a id="widgets" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Widgets</h4>
<h5><a id="textview" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>TextView</h5>
<h5><a id="edittext" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>EditText</h5>
<p>{% post_link android-edittext Android-EditText详细学习 %}</p>
<p>{% post_link android-windowSoftInputMode Android-WindowSoftInputMode详细学习 %}</p>
<h5><a id="button" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Button</h5>
<h5><a id="radiobutton" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>RadioButton</h5>
<h5><a id="checkbox" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>CheckBox</h5>
<h5><a id="switch" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Switch</h5>
<h5><a id="togglebutton" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>ToggleButton</h5>
<h5><a id="imagebutton" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>ImageButton</h5>
<h5><a id="imageview" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>ImageView</h5>
<p>{% post_link android-imageview Android-ImageView详细学习 %}</p>
<h5><a id="progressbar" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>ProgressBar</h5>
<h5><a id="seekbar" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>SeekBar</h5>
<h5><a id="ratingbar" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>RatingBar</h5>
<h5><a id="spinner" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Spinner</h5>
<h5><a id="webview" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>WebView</h5>
<h4><a id="containers" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Containers</h4>
<h5><a id="radiogroup" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>RadioGroup</h5>
<h5><a id="listview" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>ListView</h5>
<h5><a id="gridview" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>GridView</h5>
<h5><a id="expandablelistview" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>ExpandableListView</h5>
<h5><a id="scrollveiw" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>ScrollVeiw</h5>
<h5><a id="tabhost" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>TabHost</h5>
<h5><a id="slidingdrawer" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>SlidingDrawer</h5>
<h5><a id="gallery" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Gallery</h5>
<h5><a id="videoview" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>VideoView</h5>
<h5><a id="dialerfilter" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>DialerFilter</h5>
<h5><a id="recyclerview" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>RecyclerView</h5>
<p>{% post_link android-recyclerview Android-RecyclerView详细学习 %}</p>
<h5><a id="cardview" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>CardView</h5>
<h5><a id="popuwindow" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>PopuWindow</h5>
<p>{% post_link android-popupwindow Android-PopupWindow详细学习 %}</p>
<h5><a id="dialogfragment" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>DialogFragment</h5>
<h4><a id="date-time" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Date&amp;Time</h4>
<h5><a id="textclock" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>TextClock</h5>
<h5><a id="analogclock" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>AnalogClock</h5>
<h5><a id="chronometer" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Chronometer</h5>
<h5><a id="datepicker" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>DatePicker</h5>
<h5><a id="timepicker" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>TimePicker</h5>
<h5><a id="calendarview" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>CalendarView</h5>
<h4><a id="expert" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Expert</h4>
<h5><a id="space" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Space</h5>
<h5><a id="checkedtextview" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>CheckedTextView</h5>
<h5><a id="quickcontactbadge" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>QuickContactBadge</h5>
<h5><a id="extractedittext" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>ExtractEditText</h5>
<h5><a id="autocompletetextview" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>AutoCompleteTextView</h5>
<h5><a id="multiautocompletetext" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>MultiAutoCompleteText</h5>
<h5><a id="numberpicker" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>NumberPicker</h5>
<h5><a id="zoombutton" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>ZoomButton</h5>
<h5><a id="zoomcontroller" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>ZoomController</h5>
<h5><a id="gestureoverlayview" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>GestureOverlayView</h5>
<h5><a id="surfaceview" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>SurfaceView</h5>
<h5><a id="texttureview" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>TexttureView</h5>
<h5><a id="stackview" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>StackView</h5>
<h5><a id="viewstub" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>ViewStub</h5>
<p>{% post_link android-viewstub Android-ViewStub详细学习 %}</p>
<h5><a id="viewanimator" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>ViewAnimator</h5>
<h5><a id="viewflipper" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>ViewFlipper</h5>
<h5><a id="viewswitcher" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>ViewSwitcher</h5>
<h5><a id="imageswitcher" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>ImageSwitcher</h5>
<h5><a id="textswitcher" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>TextSwitcher</h5>
<h5><a id="adapterviewflipper" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>AdapterViewFlipper</h5>
<h5><a id="viewpager" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>ViewPager</h5>
<p>{% post_link android-viewpager Android-Viewpager详细学习 %}</p>
<h4><a id="custom" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Custom</h4>
<h5><a id="include" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>include</h5>
<h5><a id="fragment" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>fragment</h5>
<h5><a id="requestfocus" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>requestFocus</h5>
<h3><a id="custom-view" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Custom View</h3>
<h4><a id="extend-system-view" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>extend system View</h4>
<h4><a id="combination-view" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>combination View</h4>
<h4><a id="extend-view" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>extend View</h4>
<p>{% post_link android-view Android-View详细学习 %}</p>
<p>{% post_link android-draw Android自定义控件——绘图 %}</p>
<h5><a id="viewtreeobserver" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>ViewTreeObserver</h5>
<p>{% post_link android-getViewTreeObserver Android-getViewTreeObserver() %}</p>
<h5><a id="colorfilter" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>ColorFilter</h5>
<p>{% post_link android-colorfilter Android-ColorFilter详细学习 %}</p>
<h5><a id="xfermode" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Xfermode</h5>
<p>{% post_link android-xfermode Android-Xfermode详细学习 %}</p>
<h5><a id="paint" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Paint</h5>
<p>{% post_link android-paint Android-Paint详细学习 %}</p>
<p>{% post_link android-paints Android-Paint详细学习 %}</p>
<h5><a id="matrix" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Matrix</h5>
<p>{% post_link android-matrix Android-Matrix详细学习 %}</p>
<h5><a id="scroller" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Scroller</h5>
<p>{% post_link android-scroller Android-Scroller详细学习 %}</p>
<h5><a id="viewconfiguration" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>ViewConfiguration</h5>
<p>{% post_link android-viewconfiguration Android-ViewConfiguration解析 %}</p>
<h5><a id="motionevent" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>MotionEvent</h5>
<p>{% post_link android-motionevent Android-MotionEvent解析 %}</p>
<h5><a id="velocitytracker" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>VelocityTracker</h5>
<p>{% post_link android-velocitytracker Android-VelocityTracker详细学习 %}</p>
<h5><a id="spannablestring" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>SpannableString</h5>
<p>{% post_link android-spannablestring Android-SpannableString设置复合文本 %}</p>
<h3><a id="animation" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>animation</h3>
<p>{% post_link android-animation Android动画详细学习 %}</p>
<p>{% post_link android-activity-handoff-animation Android切换动画 %}</p>
<h4><a id="viewanimation" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>ViewAnimation</h4>
<h5><a id="tweenanimation" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>TweenAnimation</h5>
<h5><a id="frameanimation" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>FrameAnimation</h5>
<h4><a id="propertyanimation" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>PropertyAnimation</h4>
<h5><a id="valueanimator" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>ValueAnimator</h5>
<h5><a id="objectanimator" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>ObjectAnimator</h5>
<h5><a id="animatorset" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>AnimatorSet</h5>
<h4><a id="vectoranimation" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>VectorAnimation</h4>
<h5><a id="svg" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>SVG</h5>
<h5><a id="vectordrawable" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>VectorDrawable</h5>
<h5><a id="animatedvectordrawable" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>AnimatedVectorDrawable</h5>
<h3><a id="resource" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Resource</h3>
<h4><a id="assets" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>assets</h4>
<h5><a id="assetmanager" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>AssetManager</h5>
<h4><a id="res" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>res</h4>
<h5><a id="anim" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>anim</h5>
<h5><a id="animator" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>animator</h5>
<h5><a id="color" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>color</h5>
<h5><a id="drawable" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>drawable</h5>
<h5><a id="interpolator" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>interpolator</h5>
<h5><a id="layout" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>layout</h5>
<h5><a id="menu" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>menu</h5>
<h5><a id="raw" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>raw</h5>
<h5><a id="values" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>values</h5>
<h6><a id="arrays" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>arrays</h6>
<h6><a id="attrs" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>attrs</h6>
<h6><a id="bools" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>bools</h6>
<h6><a id="colors" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>colors</h6>
<h6><a id="string" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>string</h6>
<h6><a id="styles" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>styles</h6>
<h4><a id="opengl" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>OpenGL</h4>
<h4><a id="bitmap" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Bitmap</h4>
<h5><a id="bitmapfactory" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>BitmapFactory</h5>
<p>{% post_link android-bitmapfactory Android-BitmapFactory详细学习 %}</p>
<h2><a id="material-design%E7%B3%BB%E5%88%97" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Material Design 系列</h2>
<h3><a id="toolbar%E7%9A%84%E4%BD%BF%E7%94%A8" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Toolbar的使用</h3>
<p>{% post_link android-toolbar Android-ToolBar详细学习 %}</p>
<h3><a id="appbarlayout-collapsingtoolbarlayout" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>AppbarLayout+CollapsingToolbarLayout</h3>
<p>{% post_link android-appbarlayout-collapsingtoolbar-toolbar Android-AppBarLayout&amp;CollapsingToolbar&amp;Toolbar组合使用 %}</p>
<p>{% post_link android-appbarlayout Android-AppBarLayout %}</p>
<h3><a id="behavior%E7%9B%B8%E5%85%B3%EF%BC%9A" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Behavior 相关：</h3>
<ul>
<li>BottomSheetBehavior</li>
<li>BottomSheetDialog</li>
<li>SwipeDismissBehavior</li>
<li>自定义Behavior</li>
</ul>
<h3><a id="textinputlayout-textinputedittext" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>TextInputLayout + TextInputEditText</h3>
<h3><a id="tablayout" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>TabLayout</h3>
<h3><a id="bottomnavigationview" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>BottomNavigationView</h3>
<h3><a id="cardview%E9%98%B4%E5%BD%B1%E5%8D%A1%E7%89%87" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>CardView 阴影卡片</h3>
<h3><a id="snackbar-floatactionbutton" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Snackbar , FloatActionButton</h3>
<h2><a id="%E9%80%9A%E4%BF%A1" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>通信</h2>
<h3><a id="http" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Http</h3>
<h3><a id="socket" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Socket</h3>
<h3><a id="bluetooth" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Bluetooth</h3>
<h3><a id="nfc" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>NFC</h3>
<h3><a id="headset" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Headset</h3>
<h3><a id="usb" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>USB</h3>
<h2><a id="%E6%95%B0%E6%8D%AE%E6%8C%81%E4%B9%85%E5%8C%96" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>数据持久化</h2>
<h3><a id="sqlite" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Sqlite</h3>
<h4><a id="sqliteopenhelper" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>SQLiteOpenHelper</h4>
<h4><a id="contentprovider" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>ContentProvider</h4>
<h3><a id="file" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>File</h3>
<p>{% post_link android-save-method Android存储方式以及路径API %}</p>
<h4><a id="internalstorage" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>InternalStorage</h4>
<h4><a id="externalstorage" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>ExternalStorage</h4>
<h3><a id="sharedpreferences" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>SharedPreferences</h3>
<h2><a id="%E5%A4%9A%E7%BA%BF%E7%A8%8B" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>多线程</h2>
<p>{% post_link android-thread Android Thread %}</p>
<h2><a id="%E6%80%A7%E8%83%BD" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>性能</h2>
<p>{% post_link android-performance-optimize Android性能优化 %}</p>
<h3><a id="ui%E4%BC%98%E5%8C%96" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>UI优化</h3>
<h4><a id="%E5%B8%83%E5%B1%80%E5%B1%82%E6%AC%A1%E7%BB%93%E6%9E%84" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>布局层次结构</h4>
<p>{% post_link android-view-performance-optimizing Android界面性能调优 %}</p>
<h4><a id="%E6%8A%BD%E8%B1%A1%E5%B8%83%E5%B1%80%E4%BD%BF%E7%94%A8" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>抽象布局使用</h4>
<h4><a id="hierarchyviewer" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>HierarchyViewer</h4>
<h4><a id="lint%E5%B7%A5%E5%85%B7" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Lint工具</h4>
<h3><a id="%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>内存优化</h3>
<h4><a id="oom" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>OOM</h4>
<h4><a id="anr" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>ANR</h4>
<h4><a id="%E5%88%86%E6%9E%90" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>分析</h4>
<h5><a id="heap" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Heap</h5>
<h5><a id="adb-shell" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>adb shell</h5>
<p>{% post_link android-adb Android-ADB命令 %}</p>
<h6><a id="dumpsys-meminfo" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>dumpsys meminfo</h6>
<h6><a id="showmap" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>showmap</h6>
<h5><a id="traceview" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>TraceView</h5>
<h5><a id="dalvik%E6%97%A5%E5%BF%97" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Dalvik日志</h5>
<h5><a id="logcat" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>logcat</h5>
<h5><a id="mat" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>MAT</h5>
<h3><a id="%E7%94%B5%E9%87%8F%E4%BC%98%E5%8C%96" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>电量优化</h3>
<h3><a id="%E6%B5%81%E9%87%8F%E4%BC%98%E5%8C%96" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>流量优化</h3>
<h2><a id="%E8%B0%83%E8%AF%95debug" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>调试(Debug)</h2>
<p>{% post_link android-debug Android-Debug %}</p>
<h3><a id="logcat" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Logcat</h3>
<h3><a id="adb" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>adb</h3>
<h3><a id="hierarchyviewer" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>HierarchyViewer</h3>
<h3><a id="traceview" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>TraceView</h3>
<h3><a id="heap" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Heap</h3>
<h3><a id="lint" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Lint</h3>
<h2><a id="%E9%80%82%E9%85%8D" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>适配</h2>
<h3><a id="os-version" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>OS Version</h3>
<h4><a id="min-sdk" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>min SDK</h4>
<h3><a id="ui%E7%95%8C%E9%9D%A2%E9%80%82%E9%85%8D" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>UI界面适配</h3>
<p>{% post_link android-ui-adapt Android界面适配 %}</p>
<p>{% post_link android-screen-adapt Android屏幕适配 %}</p>
<h4><a id="drawable" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>drawable</h4>
<h2><a id="%E6%B5%8B%E8%AF%95" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>测试</h2>
<h3><a id="monkey" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Monkey</h3>
<h3><a id="monkeyrunner" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>MonkeyRunner</h3>
<h3><a id="junit" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>JUnit</h3>
<h3><a id="robotium" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Robotium</h3>
<h3><a id="appium" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Appium</h3>
<h3><a id="athrun-tmts" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Athrun(TMTS)</h3>
<h3><a id="uiautomator" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>UIAutomator</h3>
<h2><a id="%E5%AE%89%E5%85%A8" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>安全</h2>
<h3><a id="%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%AE%89%E5%85%A8" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>服务器安全</h3>
<h3><a id="%E9%80%9A%E4%BF%A1%E5%AE%89%E5%85%A8" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>通信安全</h3>
<h4><a id="%E4%B8%8E%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%80%9A%E4%BF%A1" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>与服务器通信</h4>
<h4><a id="%E7%BB%84%E4%BB%B6%E9%97%B4%E9%80%9A%E4%BF%A1" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>组件间通信</h4>
<h3><a id="%E5%8F%8D%E7%BC%96%E8%AF%91" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>反编译</h3>
<p>{% post_link android-decompile Android反编译 %}</p>
<p>{% post_link android-get-sha1 Android-获取sha1 %}</p>
<p>{% post_link android-smali Android-smali文件格式 %}</p>
<h3><a id="%E6%95%B0%E6%8D%AE%E5%8A%A0%E5%AF%86" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>数据加密</h3>
<h3><a id="%E6%95%B0%E6%8D%AE%E9%AA%8C%E7%AD%BE" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>数据验签</h3>
<h3><a id="%E4%BB%A3%E7%A0%81%E6%B7%B7%E6%B7%86" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>代码混淆</h3>
<h3><a id="webviewjs%E5%AE%89%E5%85%A8%E8%B0%83%E7%94%A8" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>WebView/JS安全调用</h3>
<h3><a id="md5%E3%80%81des%E3%80%81rsa%E3%80%81https%E3%80%81%E8%AF%81%E4%B9%A6%E3%80%81%E6%9D%83%E9%99%90" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>MD5、DES、RSA、https、证书、权限</h3>
<h2><a id="ndk" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>NDK</h2>
<p>{% post_link android-ndk Android-NDK %}</p>
<h3><a id="jni" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>JNI</h3>
<h3><a id="c%E8%AF%AD%E8%A8%80" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>C语言</h3>
<h3><a id="c" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>C++</h3>
<h2><a id="android%E5%A4%9A%E5%AA%92%E4%BD%93" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Android 多媒体</h2>
<h3><a id="%E7%9B%B8%E6%9C%BA%E5%BC%80%E5%8F%91" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>相机开发</h3>
<h4><a id="%E4%BD%BF%E7%94%A8%E8%87%AA%E5%B8%A6%E7%9A%84%E7%9B%B8%E6%9C%BAapp%E6%8B%8D%E7%85%A7" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>使用自带的相机APP拍照</h4>
<h4><a id="%E7%B3%BB%E7%BB%9F%E7%9B%B8%E5%86%8C%E9%80%89%E6%8B%A9%E7%85%A7%E7%89%87" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>系统相册选择照片</h4>
<h4><a id="%E7%B3%BB%E7%BB%9F%E7%9B%B8%E6%9C%BA%E6%88%96%E7%9B%B8%E5%86%8C%E8%8E%B7%E5%8F%96%E7%9A%84%E7%85%A7%E7%89%87%E8%A3%81%E5%89%AA" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>系统相机或相册获取的照片裁剪</h4>
<h4><a id="%E4%BD%BF%E7%94%A8%E7%9B%B8%E6%9C%BAapi%E5%BC%80%E5%8F%91%E7%9B%B8%E6%9C%BA" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>使用相机API 开发相机:</h4>
<ul>
<li>Android 5.0 （API 21 ）以下 使用Camera API</li>
<li>Android 5.0 以上使用 Camera2 API</li>
</ul>
<h4><a id="%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9B%B8%E5%86%8C%E5%BC%80%E5%8F%91" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>自定义相册开发</h4>
<h4><a id="%E8%87%AA%E5%AE%9A%E4%B9%89%E8%A3%81%E5%89%AA%E7%95%8C%E9%9D%A2" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>自定义裁剪界面</h4>
<h3><a id="%E8%A7%86%E9%A2%91%E5%BC%80%E5%8F%91" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>视频开发</h3>
<h4><a id="%E8%A7%86%E9%A2%91%E6%92%AD%E6%94%BE" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>视频播放</h4>
<ul>
<li>MediaPlayer</li>
<li>VideoView</li>
</ul>
<h4><a id="%E8%A7%86%E9%A2%91%E7%BC%96%E8%A7%A3%E7%A0%81" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>视频编解码</h4>
<h3><a id="%E9%9F%B3%E9%A2%91%E5%BC%80%E5%8F%91" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>音频开发</h3>
<h4><a id="audioplayer" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>AudioPlayer</h4>
<h4><a id="%E9%9F%B3%E4%B9%90%E6%92%AD%E6%94%BE%E5%99%A8" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>音乐播放器</h4>
<h2><a id="android%E6%9D%83%E9%99%90%E9%85%8D%E7%BD%AE" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Android权限配置</h2>
<h2><a id="gradle" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Gradle</h2>
<h3><a id="%E8%87%AA%E5%AE%9A%E4%B9%89gradle%E6%8F%92%E4%BB%B6" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>自定义Gradle插件</h3>
<h3><a id="gradle%E5%A4%9A%E6%B8%A0%E9%81%93%E6%89%93%E5%8C%85" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Gradle多渠道打包</h3>
<h2><a id="%E6%89%8B%E6%9C%BA%E5%8A%9F%E8%83%BD" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>手机功能</h2>
<h3><a id="%E7%94%B5%E8%AF%9D" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>电话</h3>
<h4><a id="%E8%81%94%E7%B3%BB%E4%BA%BA" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>联系人</h4>
<h4><a id="%E9%80%9A%E8%AF%9D%E8%AE%B0%E5%BD%95" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>通话记录</h4>
<h3><a id="%E7%9F%AD%E5%BD%A9%E4%BF%A1" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>短/彩信</h3>
<h3><a id="audio" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Audio</h3>
<h3><a id="sd%E5%8D%A1" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>SD卡</h3>
<h3><a id="%E6%84%9F%E5%BA%94%E5%99%A8" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>感应器</h3>
<h4><a id="%E5%8A%A0%E9%80%9F" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>加速</h4>
<h4><a id="%E6%96%B9%E5%90%91" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>方向</h4>
<h4><a id="%E9%87%8D%E5%8A%9B" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>重力</h4>
<h4><a id="%E5%85%89%E7%BA%BF" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>光线</h4>
<h4><a id="%E9%99%80%E8%9E%BA%E4%BB%AA" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>陀螺仪</h4>
<h4><a id="%E7%A3%81%E5%9C%BA" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>磁场</h4>
<h4><a id="%E6%8E%A5%E8%BF%91" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>接近</h4>
<h4><a id="%E6%B8%A9%E5%BA%A6" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>温度</h4>
<h4><a id="%E5%8E%8B%E5%8A%9B" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>压力</h4>
<h4><a id="%E7%BA%BF%E6%80%A7%E5%8A%A0%E9%80%9F%E5%BA%A6" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>线性加速度</h4>
<h4><a id="%E6%97%8B%E8%BD%AC" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>旋转</h4>
<h2><a id="%E7%AC%AC%E4%B8%89%E6%96%B9%E6%89%A9%E5%B1%95" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>第三方扩展</h2>
<h3><a id="%E5%9C%B0%E5%9B%BE" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>地图</h3>
<h3><a id="%E8%AF%AD%E9%9F%B3%E8%AF%86%E5%88%AB" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>语音识别</h3>
<h3><a id="%E6%94%AF%E4%BB%98" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>支付</h3>
<h3><a id="%E7%BB%9F%E8%AE%A1%E5%88%86%E6%9E%90" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>统计分析</h3>
<h3><a id="%E5%B9%BF%E5%91%8A" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>广告</h3>
<h2><a id="%E5%85%B6%E4%BB%96" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>其他</h2>
<h3><a id="intent" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Intent</h3>
<h3><a id="androidmanifest" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>AndroidManifest</h3>
<h3><a id="aidl" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>AIDL</h3>
<h3><a id="wifi" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Wifi</h3>
<p>{% post_link android-wifi Android-WiFi %}</p>
<h3><a id="%E5%9B%BD%E9%99%85%E5%8C%96" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>国际化</h3>
<h3><a id="%E5%93%8D%E5%BA%94%E5%BC%8F%E7%BC%96%E7%A8%8B" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>响应式编程</h3>
<p>{% post_link android-permissions Android权限机制 %}</p>
<h3><a id="%E5%85%B6%E4%BB%96" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>其他</h3>
<p>{% post_link android-responsive-code Android响应式编程 %}</p>
<p>{% post_link android-mvp Android MVP模式 %}</p>
<p>{% post_link android-cold-launch Android冷启动实现APP秒开 %}</p>
<p>{% post_link android-studio-bitbucket AndroidStudio关联Bitbucket %}</p>
<p>{% post_link android-issues Android-Issues %}</p>
<p>{% post_link android-base-class Android-基类实现 %}</p>
<p>{% post_link android-modularization Android组件化学习%}</p>
<h2><a id="library" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Library</h2>
<p>{% post_link android-library Android-开发中常用的支持库 %}</p>
<p>{% post_link android-efficient-tools Android高效开发工具库 %}</p>
<p>{% post_link android-quick-develop-frame Android快速开发框架 %}</p>
<p>{% post_link android-picasso Android-Picasso图片框架 %}</p>
<p>{% post_link android-greendao Android-GreenDao3.2.0的使用 %}</p>
<p>{% post_link android-eventbus Android-EventBus3.0的使用 %}</p>
<p>{% post_link android-common-android-library Android-常用的库 %}</p>
<p>{% post_link android-fresco Android-Fresco详细学习 %}</p>
<p>{% post_link android-rxjava Android-RxJava详细学习 %}</p>
<p>{% post_link android-gson Android-Gson详细学习 %}</p>
<p>{% post_link android-retrofit Android-Retrofit详细学习 %}</p>
<p>{% post_link android-databinding Android-DataBinding详细学习 %}</p>
<h2><a id="%E5%AE%9E%E7%8E%B0" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>实现</h2>
<p>{% post_link android-custom-lock-screen Android自定义锁屏页 %}</p>
<p>{% post_link android-custom-skin Android自定义皮肤 %}</p>

                        
                      </div>
                  </div>
                </a>
                <div class="read-more clearfix">
                  <div class="more-left left">
                  
                    <span class="date">2017/09/02</span>
                    <span>posted in&nbsp;</span> 
          				  
          					    <span class="posted-in"><a href='Android.html'>Android</a></span>
          				   
                    

                  </div>
                  <div class="more-right right">
                  <span class="comments">
                      

                       
                  </span>
                  </div>
                </div>
              </div><!-- article -->
        
			<div class="article">
                <a class="clearlink" href="15561207870815.html">
                
                  <h1>Android-smali文件格式</h1>
                  <div class="a-content">
                      
                      <div class="a-content-text">
                        
                        	<h2><a id="helloworld" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>HelloWorld</h2>
<p>首先写一个 HelloWorld 类：</p>
<pre class="line-numbers"><code class="language-java">package jiuyou.hello.info;

public class HelloWorld {
    public static void main(String[] args){
        System.out.println(&quot;hello world&quot;);
    }
}
</code></pre>
<p>然后生成 apk 再用 apktool 工具转成 smali 文件：</p>
<pre class="line-numbers"><code class="language-plain_text">.class public Ljiuyou/hello/info/HelloWorld;    #定义类名
.super Ljava/lang/Object;                       #定义父类
.source &quot;HelloWorld.java&quot;                       #源文件名

# direct methods      #直接方法  （# virtual methods 为虚方法）
.method public constructor &lt;init&gt;()V      #构造函数
    .locals 0     #方法中使用到的局部变量个数

    .prologue     #代码起始指令
    .line 8       #源代码所在行数
    invoke-direct {p0}, Ljava/lang/Object;-&gt;&lt;init&gt;()V         #调用父类构造方法

    return-void     #返回空
.end method         #方法结束

.method public static main([Ljava/lang/String;)V      #对应 main 方法
    .locals 2       #方法包含两个局部 v0,v1
    .param p0, &quot;args&quot;    # [Ljava/lang/String;   # main 方法的参数 agrs 标记为 p0

    .prologue       #代码起始指令
    .line 10
    sget-object v0, Ljava/lang/System;-&gt;out:Ljava/io/PrintStream;  #将 System.out 这个静态变量赋给 v0

    const-string v1, &quot;hello world&quot;    #构造字符串

    #方法调用（调用 v0 的方法 println ，v1 是参数）
    invoke-virtual {v0, v1}, Ljava/io/PrintStream;-&gt;println(Ljava/lang/String;)V    

    .line 11
    return-void
.end method
</code></pre>
<h2><a id="%E5%AD%97%E6%AE%B5" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>字段</h2>
<p>静态字段格式如下：</p>
<pre class="line-numbers"><code class="language-plain_text"># static fields
.field &lt;访问权限&gt; static [修饰关键字] &lt;字段名&gt;:&lt;字段类型&gt;
</code></pre>
<p>实例字段格式如下：</p>
<pre class="line-numbers"><code class="language-plain_text"># instance fields
.field &lt;访问权限&gt; [修饰关键字] &lt;字段名&gt;:&lt;字段类型&gt;
</code></pre>
<p>举个栗子</p>
<p><strong>java</strong> ：</p>
<pre class="line-numbers"><code class="language-java">private String name;

private final String sex=&quot;男&quot;;

public static int age;
</code></pre>
<p><strong>smali</strong> :</p>
<pre class="line-numbers"><code class="language-plain_text"># static fields
.field public static age:I

# instance fields
.field private name:Ljava/lang/String;

.field private final sex:Ljava/lang/String;
</code></pre>
<h2><a id="%E6%96%B9%E6%B3%95" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>方法</h2>
<p>方法有直接方法和虚方法两种，两者格式基本相同：</p>
<pre class="line-numbers"><code class="language-plain_text"># direct methods  (virtual methods)
.method &lt;访问权限&gt; [修饰关键字] &lt;方法原型&gt;
    &lt;.locals&gt;
    [.parameter] or [.param]
    [.prologue]
    [.line]
    &lt;代码体&gt;
.end method
</code></pre>
<p><strong>.locals</strong>：局部变量个数<br />
<strong>.parameter or .param</strong>：指定每个参数<br />
<strong>.prologue</strong>：代码的开始处，混淆过的代码可能没有该指令<br />
<strong>.line</strong>：指定了该处指令在源代码中的行号，混淆过的代码可能没有该指令</p>
<p>举个栗子：<br />
<strong>java</strong></p>
<pre class="line-numbers"><code class="language-java">public String test(int a){
    int b=a+10;
    return &quot;test&quot;;
}
</code></pre>
<p><strong>smali</strong></p>
<pre class="line-numbers"><code class="language-plain_text"># virtual methods
.method public test(I)Ljava/lang/String;
    .locals 2
    .param p1, &quot;a&quot;    # I

    .prologue
    .line 11
    add-int/lit8 v0, p1, 0xa

    .line 12
    .local v0, &quot;b&quot;:I
    const-string v1, &quot;test&quot;

    return-object v1
.end method
</code></pre>
<h2><a id="%E6%8E%A5%E5%8F%A3" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>接口</h2>
<p>interface 格式如下：</p>
<pre class="line-numbers"><code class="language-plain_text"># interfaces
.implements &lt;接口名&gt;
</code></pre>
<p>举个例子：<br />
<strong>java</strong></p>
<pre class="line-numbers"><code class="language-java">public interface If {
    int demo(String s);
}

public class InterfaceTest implements If {
    @Override
    public int demo(String s) {
        return 0;
    }
}
</code></pre>
<p><strong>smali</strong> ：</p>
<p>If.smali</p>
<pre class="line-numbers"><code class="language-plain_text"># virtual methods
.method public abstract demo(Ljava/lang/String;)I
.end method
</code></pre>
<p>InterfaceTest.smali</p>
<pre class="line-numbers"><code class="language-plain_text"># interfaces
.implements Ljiuyou/hello/info/If;

# virtual methods
.method public demo(Ljava/lang/String;)I
    .locals 1
    .param p1, &quot;s&quot;    # Ljava/lang/String;

    .prologue
    .line 11
    const/4 v0, 0x0

    return v0
.end method
</code></pre>
<h2><a id="%E6%B3%A8%E8%A7%A3" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>注解</h2>
<p>格式如下：</p>
<pre class="line-numbers"><code class="language-plain_text">.annotation [注解属性] &lt;注解类名&gt;
    [注解字段 = 值]
.end annotation
</code></pre>
<p>如果注解的作用范围是类， <strong>.annotation</strong> 指令会直接定义在 smali 文件中，如果作用范围是方法或者字段，则会包含在方法或字段定义中。</p>
<p>举个栗子：<br />
<strong>java</strong></p>
<pre class="line-numbers"><code class="language-java">@Deprecated
public class AnnotationTest {
    @At(value = &quot;tom&quot;)
    public String name;
}
</code></pre>
<p><strong>smali</strong></p>
<pre class="line-numbers"><code class="language-plain_text"># annotations
.annotation runtime Ljava/lang/Deprecated;
.end annotation


# instance fields
.field public name:Ljava/lang/String;
    .annotation runtime Ljiuyou/hello/info/At;
        value = &quot;tom&quot;
    .end annotation
.end field
</code></pre>

                        
                      </div>
                  </div>
                </a>
                <div class="read-more clearfix">
                  <div class="more-left left">
                  
                    <span class="date">2017/08/30</span>
                    <span>posted in&nbsp;</span> 
          				  
          					    <span class="posted-in"><a href='Android.html'>Android</a></span>
          				   
                    

                  </div>
                  <div class="more-right right">
                  <span class="comments">
                      

                       
                  </span>
                  </div>
                </div>
              </div><!-- article -->
        
			<div class="article">
                <a class="clearlink" href="15561207870745.html">
                
                  <h1>Android-CoordinatorLayout详细学习</h1>
                  <div class="a-content">
                      
                      <div class="a-content-text">
                        
                        	<p>曾在网上找了一些关于<code>CoordinatorLayout</code>的教程，大部分文章都是把<code>CoordinatorLayout</code>、<code>AppbarLayout</code>、<code>CollapsingToolbarLayout</code> 以及<code>Toolbar</code>等一起使用来介绍，这让我不知不觉在心中认为把这几个布局要一起使用，而且只是用于那种场景中。其实<code>CoordinatorLayout</code>的功能并不是局限于与<code>AppBarLayout</code>一起使用，它的功能强大着呢，本文主要对<code>CoordinatorLayout</code>的使用进行介绍，后面再写一篇文章将<code>AppBarLayout</code>和<code>CollapsingToolBarLayout</code>整合<code>CoordinatorLayout</code>一起。那么到底<code>CoordinatorLayout</code>有多好用，请往下感受吧~</p>
<h2><a id="coordinatorlayout%E8%83%BD%E5%81%9A%E4%BB%80%E4%B9%88" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>CoordinatorLayout能做什么</h2>
<p>在学习<code>CoordinatorLayout</code>之前，很有必要了解<code>CoordinatorLayout</code>能帮我们做什么，从名字上可以看出，就是帮我们协调子View的。怎么个协调法呢?就是它根据我们的定制，帮助我们协调各个子View的布局。我们先看一组动画图~</p>
<p><figure><img src="media/15561207870745/20171014150799569357936.gif" alt="" /></figure></p>
<p>稍微解释一下这个动画，蓝色的矩形是我们一个普通<code>View</code>，黄色的Hello是一个<code>Button</code>。我们水平拖动蓝色矩形时，黄色Button查着与蓝色矩形相反方向移动；竖直移动蓝色矩形时，黄色也跟着竖直。简而言之：它们在竖直方向同步移动，在水平方向相反。</p>
<p>这个效果如果让你不用<code>CoordinatorLayout</code>去实现，应该没有任何问题，但是代码的耦合度应该非常大，你的代码必须要持有2个View的引用，然后在onTouchEvent里面做各种判断。如果我们想要实现的功能是，有更多的View要根据蓝色的View的移动相应作出响应，那么那就得在蓝色View的<code>onTounchEvent</code>里面针对其他的View处理各种逻辑。这耦合度未免太伤感了~</p>
<p>而<code>CoordinatorLayout</code>既然号称能帮我们协调子View的布局，我们接下来看看<code>CoordinatorLayout</code>如何实现~</p>
<h2><a id="coordinatorlayout%E4%BD%BF%E7%94%A8" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>CoordinatorLayout使用</h2>
<p><code>CoordinatorLayout</code>的使用核心是<code>Behavior</code>，<code>Behavior</code>就是执行你定制的动作。在讲<code>Behavior</code>之前必须先理解两个概念：<code>Child</code>和<code>Dependency</code>，什么意思呢？<code>Child</code>当然是子View的意思了，是谁的子View呢，当然是<code>CoordinatorLayout</code>的子<code>View</code>；其实<code>Child</code>是指要执行动作的<code>CoordinatorLayout</code>的子<code>View</code>。而<code>Dependency</code>是指<code>Child</code>依赖的<code>View</code>。比如上面的gif图中，蓝色的<code>View</code>就是<code>Dependency</code>，黄色的<code>View</code>就是<code>Child</code>，因为黄色的<code>View</code>的动作是依赖于蓝色的<code>View</code>。简而言之，就是如过<code>Dependency</code>这个View发生了变化，那么<code>Child</code>这个View就要相应发生变化。发生变化是具体发生什么变化呢？这里就要引入<code>Behavior</code>，<code>Child</code>发生变化的具体执行的代码都是放在<code>Behavior</code>这个类里面。</p>
<p>怎么使用<code>Behavior</code>呢，首先，我们定义一个类，继承<code>CoordinatorLayout.Behavior&lt;T&gt;</code>,其中，泛型参数T是我们要执行动作的<code>View</code>类，也就是<code>Child</code>。然后就是去实现<code>Behavior</code>的两个方法：</p>
<pre class="line-numbers"><code class="language-java">/**
* 判断child的布局是否依赖dependency
*/
   @Override
 public boolean layoutDependsOn(CoordinatorLayout parent, T child, View dependency) {
    boolean rs;
    //根据逻辑判断rs的取值
    //返回false表示child不依赖dependency，ture表示依赖
    return rs;  
}

/**
* 当dependency发生改变时（位置、宽高等），执行这个函数
* 返回true表示child的位置或者是宽高要发生改变，否则就返回false
*/
@Override
public boolean onDependentViewChanged(CoordinatorLayout parent, T child, View dependency) {
     //child要执行的具体动作
        return true;
}
</code></pre>
<p>有了上面的概念后，我们看看具体怎么去实现吧~</p>
<p>为了响应跟随手指移动的操作，我们定义一个非常简单的<code>View</code>，这个<code>View</code>只响应跟随手指移动，将这个<code>View</code>作为<code>Dependency</code>。由于过于简单，这个<code>View</code>源码不粘贴，我们只需知道这个<code>View</code>的类名叫：<code>TempView</code>。</p>
<p>我们看看<code>Behavior</code>的使用：</p>
<pre class="line-numbers"><code class="language-java">package com.hc.studyCoordinatorLayout;

import android.content.Context;
import android.support.design.widget.CoordinatorLayout;
import android.util.AttributeSet;
import android.util.DisplayMetrics;
import android.view.View;
import android.widget.Button;

/**
 * Package com.hc.studyCoordinatorLayout
 * Created by HuaChao on 2016/6/1.
 */
public class MyBehavior extends CoordinatorLayout.Behavior&lt;Button&gt; {
    private int width;

    public MyBehavior(Context context, AttributeSet attrs) {
        super(context, attrs);
        DisplayMetrics display = context.getResources().getDisplayMetrics();
        width = display.widthPixels;
    }

    @Override
    public boolean layoutDependsOn(CoordinatorLayout parent, Button child, View dependency) {
        //如果dependency是TempView的实例，说明它就是我们所需要的Dependency
        return dependency instanceof TempView;
    }

    //每次dependency位置发生变化，都会执行onDependentViewChanged方法
    @Override
    public boolean onDependentViewChanged(CoordinatorLayout parent, Button btn, View dependency) {

        //根据dependency的位置，设置Button的位置

        int top = dependency.getTop();
        int left = dependency.getLeft();

        int x = width - left - btn.getWidth();
        int y = top;

        setPosition(btn, x, y);
        return true;
    }

    private void setPosition(View v, int x, int y) {
        CoordinatorLayout.MarginLayoutParams layoutParams = (CoordinatorLayout.MarginLayoutParams) v.getLayoutParams();
        layoutParams.leftMargin = x;
        layoutParams.topMargin = y;
        v.setLayoutParams(layoutParams);
    }
}
</code></pre>
<p>OK，现在我们为<code>Button</code>类指定了<code>Dependency</code>，并且定义好了跟随<code>Dependency</code>一直变化的动作（<code>Behavior</code>），接下来我们就要指定好为哪个具体的<code>Button</code>实例来绑定这些。方法很简单，直接在布局文件指定就好：</p>
<pre class="line-numbers"><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;android.support.design.widget.CoordinatorLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;
    xmlns:tools=&quot;http://schemas.android.com/tools&quot;
    android:layout_width=&quot;match_parent&quot;
    android:layout_height=&quot;match_parent&quot;
    tools:context=&quot;com.hc.studyCoordinatorLayout.MainActivity&quot;&gt;

    &lt;Button
        android:id=&quot;@+id/btn&quot;
        android:layout_width=&quot;wrap_content&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:layout_marginLeft=&quot;300dp&quot;
        android:layout_marginTop=&quot;300dp&quot;
        android:background=&quot;#FFCC00&quot;
        android:text=&quot;Hello&quot;
        app:layout_behavior=&quot;com.hc.studyCoordinatorLayout.MyBehavior&quot; /&gt;

    &lt;com.hc.studyCoordinatorLayout.TempView
        android:layout_width=&quot;100dp&quot;
        android:layout_height=&quot;100dp&quot;
        android:layout_marginLeft=&quot;300dp&quot;
        android:layout_marginTop=&quot;300dp&quot;
        android:background=&quot;#3366CC&quot;  /&gt;
&lt;/android.support.design.widget.CoordinatorLayout&gt;
</code></pre>
<p>是不是很简单呢？我们只需关注<code>Behavior</code>的编写就好了，把<code>Child</code>和<code>Dependency</code>之间的关系完全解耦了~</p>
<p>附上<a href="http://download.csdn.net/detail/huachao1001/9537636">源码地址</a></p>

                        
                      </div>
                  </div>
                </a>
                <div class="read-more clearfix">
                  <div class="more-left left">
                  
                    <span class="date">2017/08/27</span>
                    <span>posted in&nbsp;</span> 
          				  
          					    <span class="posted-in"><a href='Android.html'>Android</a></span>
          				   
                    

                  </div>
                  <div class="more-right right">
                  <span class="comments">
                      

                       
                  </span>
                  </div>
                </div>
              </div><!-- article -->
        
			<div class="article">
                <a class="clearlink" href="15561207870778.html">
                
                  <h1>Android-NDK图片高斯模糊</h1>
                  <div class="a-content">
                      
                      <div class="a-content-text">
                        
                        	<h2><a id="cmake" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>CMake</h2>
<p>CMake是一款项目构建工具，通过编写简单明了的在CmakeLists.txt来生成makefile，简单来说就是一个makefile生成器。</p>
<p>在Android Studio中安装CMake非常简单，打开Tools-&gt;Android-&gt;SDK Manager，选择SDK Tools标签页，勾选CMake、LLDB、NDK，OK自动安装即可。其中LLDB可以使我们在Android Studio中调试C/C++程序。NDK为原生开发工具包，必不可少。</p>
<p><figure><img src="media/15561207870778/15713317710825.png" alt="" /></figure></p>
<h2><a id="%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E5%81%9Ajnindk%E5%BC%80%E5%8F%91" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>为什么要做JNI/NDK开发</h2>
<p>众所周知，Java/Android程序是运行在JVM/Dalvik VM中，所以Java程序远没有C/C++程序性能高，尤其是在CPU密集型运算时，所以Java平台提供了JNI（Java Native Interface），可通过JNI调用C/C++等编写的so动态链接库。</p>
<p><strong>注：Google在Android L以后用ART彻底代替了Dalvik VM，但ART本质上仍是一个虚拟机，并支持所有Dalvik VM指令集。</strong></p>
<p>Java API中几乎所有与硬件相关的方法都是native的，比如I/O操作、网络访问、手机传感器、串口读写等。<br />
本文涉及的图片处理是一种CPU密集型任务，在Android开发中使用native方法最为合适。</p>
<h2><a id="%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8cmake%E5%81%9Ajnindk%E5%BC%80%E5%8F%91" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>如何使用CMake做JNI/NDK开发</h2>
<h3><a id="%E6%96%B0%E5%BB%BA%E5%B7%A5%E7%A8%8B" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>新建工程</h3>
<p>选中Include C++ Support，意为引入C++支持。</p>
<h3><a id="%E9%85%8D%E7%BD%AEc%E6%94%AF%E6%8C%81" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>配置C++支持</h3>
<p><figure><img src="media/15561207870778/15713317834823.png" alt="" /></figure></p>
<p>在Customize C++ Support界面默认即可,意为CMake/C++11环境</p>
<h3><a id="%E8%AE%A4%E8%AF%86cmakelists-txt" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>认识CMakeLists.txt</h3>
<p>工程创建完毕之后Android Studio会在app目录下生成CMakeLists.txt文件。CMakeLists.txt是CMake的配置文件，用于表明版本、依赖、等信息，以下为Android Studio生成的CMakeLists（过滤注释）</p>
<pre class="line-numbers"><code class="language-plain_text">cmake_minimum_required(VERSION 3.4.1)

add_library(native-lib SHARED src/main/cpp/native-lib.cpp)

find_library(log-lib log)

target_link_libraries(native-lib ${log-lib})
</code></pre>
<ul>
<li>cmake_minimum_required(VERSION 3.4.1)<br />
CMake最小版本使用的是3.4.1。</li>
<li>add_library()<br />
配置so库信息（为当前当前脚本文件添加库）
<ul>
<li>native-lib<br />
这个是声明引用so库的名称，在项目中，如果需要使用这个so文件，引用的名称就是这个。值得注意的是，实际上生成的so文件名称是libnative-lib。</li>
<li>SHARED<br />
这个参数表示共享so库文件，也就是在Run项目或者build项目时会在目录intermediates\transforms\mergeJniLibs\debug\folders\2000\1f\main下生成so文件。</li>
<li>src/main/cpp/native-lib.cpp<br />
构建so库的源文件。</li>
</ul>
</li>
<li>find_library()查找一个库文件
<ul>
<li>log-lib<br />
这个指定的是在NDK库中每个类型的库会存放一个特定的位置，而log库存放在log-lib中</li>
<li>log<br />
指定使用log库</li>
</ul>
</li>
<li>target_link_libraries()<br />
如果你本地的库（native-lib）想要调用log库的方法，那么就需要配置这个属性，意思是把NDK库关联到本地库。
<ul>
<li>native-lib<br />
要被关联的库名称</li>
<li>${log-lib}<br />
要关联的库名称，要用大括号包裹，前面还要有$符号去引用。</li>
</ul>
</li>
</ul>
<h3><a id="%E4%BA%86%E8%A7%A3jni%E7%9A%84cc%E8%A7%84%E8%8C%83" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>了解JNI的C/C++规范</h3>
<h4><a id="%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>数据类型</h4>
<p>JNI的数据类型包含两种，分别是基本类型和引用类型，它们和Java中的数据类型对应关系如下两表所示。</p>
<h5><a id="%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>基本数据类型</h5>
<table>
<thead>
<tr>
<th style="text-align: left">JNI类型</th>
<th style="text-align: center">Java类型</th>
<th style="text-align: center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left">jboolean</td>
<td style="text-align: center">boolean</td>
<td style="text-align: center">无符号8位整型</td>
</tr>
<tr>
<td style="text-align: left">jbyte</td>
<td style="text-align: center">byte</td>
<td style="text-align: center">无符号8位整型</td>
</tr>
<tr>
<td style="text-align: left">jchar</td>
<td style="text-align: center">char</td>
<td style="text-align: center">无符号16位整型</td>
</tr>
<tr>
<td style="text-align: left">jshort</td>
<td style="text-align: center">short</td>
<td style="text-align: center">有符号16位整型</td>
</tr>
<tr>
<td style="text-align: left">jint</td>
<td style="text-align: center">int</td>
<td style="text-align: center">32位整型</td>
</tr>
<tr>
<td style="text-align: left">jlong</td>
<td style="text-align: center">long</td>
<td style="text-align: center">64位整型</td>
</tr>
<tr>
<td style="text-align: left">jfloat</td>
<td style="text-align: center">float</td>
<td style="text-align: center">32位浮点型</td>
</tr>
<tr>
<td style="text-align: left">jdouble</td>
<td style="text-align: center">double</td>
<td style="text-align: center">64位浮点型</td>
</tr>
<tr>
<td style="text-align: left">void</td>
<td style="text-align: center">void</td>
<td style="text-align: center">无类型</td>
</tr>
</tbody>
</table>
<h5><a id="%E5%BC%95%E7%94%A8%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>引用数据类型</h5>
<table>
<thead>
<tr>
<th style="text-align: left">JNI类型</th>
<th style="text-align: center">Java类型</th>
<th style="text-align: center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left">jobject</td>
<td style="text-align: center">Object</td>
<td style="text-align: center">Object类型</td>
</tr>
<tr>
<td style="text-align: left">jclass</td>
<td style="text-align: center">Class</td>
<td style="text-align: center">Class类型</td>
</tr>
<tr>
<td style="text-align: left">jstring</td>
<td style="text-align: center">String</td>
<td style="text-align: center">String类型</td>
</tr>
<tr>
<td style="text-align: left">jobjectArray</td>
<td style="text-align: center">Object[]</td>
<td style="text-align: center">对象数组</td>
</tr>
<tr>
<td style="text-align: left">jbooleanArray</td>
<td style="text-align: center">boolean[]</td>
<td style="text-align: center">boolean数组</td>
</tr>
<tr>
<td style="text-align: left">jbyteArray</td>
<td style="text-align: center">byte[]</td>
<td style="text-align: center">byte数组</td>
</tr>
<tr>
<td style="text-align: left">jcharArray</td>
<td style="text-align: center">char[]</td>
<td style="text-align: center">char数组</td>
</tr>
<tr>
<td style="text-align: left">jshortArray</td>
<td style="text-align: center">short[]</td>
<td style="text-align: center">short数组</td>
</tr>
<tr>
<td style="text-align: left">jintArray</td>
<td style="text-align: center">int[]</td>
<td style="text-align: center">int数组</td>
</tr>
<tr>
<td style="text-align: left">jlongArray</td>
<td style="text-align: center">long[]</td>
<td style="text-align: center">long数组</td>
</tr>
<tr>
<td style="text-align: left">jfloatArray</td>
<td style="text-align: center">float[]</td>
<td style="text-align: center">float数组</td>
</tr>
<tr>
<td style="text-align: left">jdoubleArray</td>
<td style="text-align: center">double[]</td>
<td style="text-align: center">double数组</td>
</tr>
<tr>
<td style="text-align: left">jthrowable</td>
<td style="text-align: center">Throwable</td>
<td style="text-align: center">Throwable</td>
</tr>
</tbody>
</table>
<h4><a id="jni%E7%9A%84%E7%B1%BB%E5%9E%8B%E7%AD%BE%E5%90%8D" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>JNI的类型签名</h4>
<p>JNI的类型签名标识了一个特定的Java类型，这个类型既可以是类也可以是方法，也可以是数据类型。</p>
<ul>
<li>类的签名比较简单，它采用 L+包名+类型+; 的形式，只需要将其中的.替换为/即可。例如java.lang.String， 它的签名为Ljava/lang/String; ，注意末尾的;也是签名一部分。</li>
<li>基本数据类型的签名采用一系列大写字母来表示, 如下表所示</li>
</ul>
<h5><a id="%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E7%9A%84%E7%AD%BE%E5%90%8D" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>基本数据类型的签名</h5>
<table>
<thead>
<tr>
<th style="text-align: left">Java类型</th>
<th style="text-align: center">签名</th>
<th style="text-align: center">Java类型</th>
<th style="text-align: center">签名</th>
<th style="text-align: center">Java类型</th>
<th style="text-align: center">签名</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left">boolean</td>
<td style="text-align: center">Z</td>
<td style="text-align: center">byte</td>
<td style="text-align: center">B</td>
<td style="text-align: center">char</td>
<td style="text-align: center">C</td>
</tr>
<tr>
<td style="text-align: left">short</td>
<td style="text-align: center">S</td>
<td style="text-align: center">int</td>
<td style="text-align: center">I</td>
<td style="text-align: center">long</td>
<td style="text-align: center">J</td>
</tr>
<tr>
<td style="text-align: left">float</td>
<td style="text-align: center">F</td>
<td style="text-align: center">double</td>
<td style="text-align: center">D</td>
<td style="text-align: center">void</td>
<td style="text-align: center">V</td>
</tr>
</tbody>
</table>
<h4><a id="jni-cc%E5%87%BD%E6%95%B0%E7%BC%96%E5%86%99" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>JNI C/C++函数编写</h4>
<p>先来看看Android Studio为我们生成的示例</p>
<pre class="line-numbers"><code class="language-java">JNIEXPORT jstring JNICALL
Java_com_glee_myapplication_MainActivity_stringFromJNI(
        JNIEnv* env,
        jobject /* this */) {
    std::string hello = &quot;Hello from C++&quot;;
    return env-&gt;NewStringUTF(hello.c_str());
}
</code></pre>
<ul>
<li>JNIEXPORT &amp; JNICALL<br />
JNIEXPORT和JNICALL这两个宏（被定义在jni.h）确保这个函数在本地库外可见，并且编译器会进行正确的调用转换。</li>
<li>函数规范<br />
在JNI中C/C++的函数名是有规范要求的，由以下几部分串接而成
<ul>
<li>Java_前缀</li>
<li>完全限定的类名，并用下划线“_”作为分隔符</li>
<li>第一参数JNIEnv* env</li>
<li>第二个参数jobject或jclass</li>
<li>其他参数按类型映射</li>
<li>返回参数按类型映射</li>
</ul>
</li>
</ul>
<h2><a id="jni%E5%B1%82%E6%93%8D%E4%BD%9Cbitmap%E5%AF%B9%E8%B1%A1" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>JNI层操作Bitmap对象</h2>
<h3><a id="%E5%8E%9F%E7%90%86" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>原理</h3>
<p>Android中JNI层处理Bitmap通常有两种方法</p>
<ul>
<li>获取到Bitmap中的byte数组并传入native方法，JNI层处理得到的byte数组后返回一个新的byte数组，Java层重建Bitmap对象。（不推荐）</li>
<li>Java层直接向JNI层传入Bitmap的引用，JNI层得到Bitmap对象的图像数据的地址，直接修改Bitmap的byte数组。</li>
</ul>
<p>阅读了很多篇博客，很多开发者都会采用第一种方法，本人是极不推荐的。这种方法会在内存中重建一个byte数组，会造成内存的浪费，性能低下。<br />
第二种方法是性能最优的，JNI层充分利用的C/C++指针的特性，直接获取到Bitmap中byte数组在内存中的地址，通过指针直接修改图像数据，所以用到了NDK中的android/bitmap.h。</p>
<p><strong>android/bitmap.h</strong></p>
<p>android/bitmap.h这个头文件用于在JNI层操作Bitmap对象的，其包含于jnigraphics库中，所以要在CMakeLists.txt中的target_link_libraries加入-ljnigraphics，如下</p>
<p><code>target_link_libraries(native-lib -ljnigraphics ${log-lib})</code></p>
<p><strong>三个常用函数</strong></p>
<ul>
<li>AndroidBitmap_getInfo() 从位图句柄获得信息（宽度、高度、像素格式）</li>
<li>AndroidBitmap_lockPixels() 对像素缓存上锁，即获得该缓存的指针。</li>
<li>AndroidBitmap_unlockPixels() 解锁</li>
</ul>
<h3><a id="jni%E6%8E%A5%E5%8F%A3%E5%87%BD%E6%95%B0" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>JNI接口函数</h3>
<p>请看注释</p>
<pre class="line-numbers"><code class="language-java">JNIEXPORT void JNICALL
Java_com_glee_ndkroad1006_MainActivity_gaussBlur(JNIEnv *env, jobject /* this */, jobject bmp) {
    AndroidBitmapInfo info = {0};//初始化BitmapInfo结构体
    int *data=NULL;//初始化Bitmap图像数据指针
    AndroidBitmap_getInfo(env, bmp, &amp;info);
    AndroidBitmap_lockPixels(env, bmp, (void **) &amp;data);//锁定Bitmap，并且获得指针
    /**********高斯模糊算法作对int数组进行处理***********/
    //调用gaussBlur函数，把图像数据指针、图片长宽和模糊半径传入
    gaussBlur(data,info.width,info.height,80);
    /****************************************************/
    AndroidBitmap_unlockPixels(env,bmp);//解锁
}
</code></pre>
<p>这里用到的gaussBlur函数代码将在文章最后列出。</p>
<h3><a id="java%E5%B1%82%E4%BB%A3%E7%A0%81" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Java层代码</h3>
<p>请看注释</p>
<pre class="line-numbers"><code class="language-java">public class MainActivity extends AppCompatActivity {

    static {
        //通过静态代码块加载so库
        System.loadLibrary(&quot;native-lib&quot;);
    }

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        //初始化两个ImageView
        ImageView iv1 = (ImageView) findViewById(R.id.img1);
        ImageView iv2 = (ImageView) findViewById(R.id.img2);
        //iv1设置图片
        iv1.setImageResource(R.drawable.test);
        //生成bitmap对象
        Bitmap bitmap = BitmapFactory.decodeResource(getResources(), R.drawable.test);
        //调用native方法，传入Bitmap对象，对Bitmap进行高斯迷糊处理
        gaussBlur(bitmap);
        //把Bitmap对象设置给iv2
        iv2.setImageBitmap(bitmap);
    }
    //native方法声明
    public native void gaussBlur(Bitmap bitmap);
}
</code></pre>
<h3><a id="%E8%BF%90%E8%A1%8C%E6%95%88%E6%9E%9C" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>运行效果</h3>
<p>上方的ImageView是没有进行高斯模糊处理的，下方的ImageView调用了JNI方法进行高斯模糊处理。</p>
<p><figure><img src="media/15561207870778/15713317952653.png" alt="" /></figure></p>
<h3><a id="%E9%AB%98%E6%96%AF%E6%A8%A1%E7%B3%8A%E7%AE%97%E6%B3%95" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>高斯模糊算法</h3>
<pre class="line-numbers"><code class="language-c">void gaussBlur1(int* pix, int w, int h, int radius)
{
    float sigma = (float) (1.0 * radius / 2.57);
    float deno  = (float) (1.0 / (sigma * sqrt(2.0 * PI)));
    float nume  = (float) (-1.0 / (2.0 * sigma * sigma));
    float* gaussMatrix = (float*)malloc(sizeof(float)* (radius + radius + 1));
    float gaussSum = 0.0;
    for (int i = 0, x = -radius; x &lt;= radius; ++x, ++i)
    {
        float g = (float) (deno * exp(1.0 * nume * x * x));
        gaussMatrix[i] = g;
        gaussSum += g;
    }
    int len = radius + radius + 1;
    for (int i = 0; i &lt; len; ++i)
        gaussMatrix[i] /= gaussSum;
    int* rowData  = (int*)malloc(w * sizeof(int));
    int* listData = (int*)malloc(h * sizeof(int));
    for (int y = 0; y &lt; h; ++y)
    {
        memcpy(rowData, pix + y * w, sizeof(int) * w);
        for (int x = 0; x &lt; w; ++x)
        {
            float r = 0, g = 0, b = 0;
            gaussSum = 0;
            for (int i = -radius; i &lt;= radius; ++i)
            {
                int k = x + i;
                if (0 &lt;= k &amp;&amp; k &lt;= w)
                {
                    //得到像素点的rgb值
                    int color = rowData[k];
                    int cr = (color &amp; 0x00ff0000) &gt;&gt; 16;
                    int cg = (color &amp; 0x0000ff00) &gt;&gt; 8;
                    int cb = (color &amp; 0x000000ff);
                    r += cr * gaussMatrix[i + radius];
                    g += cg * gaussMatrix[i + radius];
                    b += cb * gaussMatrix[i + radius];
                    gaussSum += gaussMatrix[i + radius];
                }
            }
            int cr = (int)(r / gaussSum);
            int cg = (int)(g / gaussSum);
            int cb = (int)(b / gaussSum);
            pix[y * w + x] = cr &lt;&lt; 16 | cg &lt;&lt; 8 | cb | 0xff000000;
        }
    }
    for (int x = 0; x &lt; w; ++x)
    {
        for (int y = 0; y &lt; h; ++y)
            listData[y] = pix[y * w + x];
        for (int y = 0; y &lt; h; ++y)
        {
            float r = 0, g = 0, b = 0;
            gaussSum = 0;
            for (int j = -radius; j &lt;= radius; ++j)
            {
                int k = y + j;
                if (0 &lt;= k &amp;&amp; k &lt;= h)
                {
                    int color = listData[k];
                    int cr = (color &amp; 0x00ff0000) &gt;&gt; 16;
                    int cg = (color &amp; 0x0000ff00) &gt;&gt; 8;
                    int cb = (color &amp; 0x000000ff);
                    r += cr * gaussMatrix[j + radius];
                    g += cg * gaussMatrix[j + radius];
                    b += cb * gaussMatrix[j + radius];
                    gaussSum += gaussMatrix[j + radius];
                }
            }
            int cr = (int)(r / gaussSum);
            int cg = (int)(g / gaussSum);
            int cb = (int)(b / gaussSum);
            pix[y * w + x] = cr &lt;&lt; 16 | cg &lt;&lt; 8 | cb | 0xff000000;
        }
    }
    free(gaussMatrix);
    free(rowData);
    free(listData);
}
</code></pre>

                        
                      </div>
                  </div>
                </a>
                <div class="read-more clearfix">
                  <div class="more-left left">
                  
                    <span class="date">2017/08/27</span>
                    <span>posted in&nbsp;</span> 
          				  
          					    <span class="posted-in"><a href='Android.html'>Android</a></span>
          				  
          					    <span class="posted-in"><a href='JNI%E5%BC%80%E5%8F%91.html'>JNI开发</a></span>
          				   
                    

                  </div>
                  <div class="more-right right">
                  <span class="comments">
                      

                       
                  </span>
                  </div>
                </div>
              </div><!-- article -->
        
			<div class="article">
                <a class="clearlink" href="15561207870710.html">
                
                  <h1>Android-AppBarLayout</h1>
                  <div class="a-content">
                      
                      <div class="a-content-text">
                        
                        	<h2><a id="toolbar" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Toolbar</h2>
<p>Toobar主要是用来替换ActionBar的，换句话说，ActionBar能做的，Toolbar都能做。如果你对ActionBar的使用比较熟悉，你会发现Toolbar使用起来非常简单。ok，既然是替换，当然用Toolbar的时候就得先去把ActionBar给隐藏掉啦~</p>
<p>隐藏ActionBar的方法有很多，可以通过代码的方式隐藏，也可以通过配置文件的方式，我们主要是通过配置文件的方式来隐藏。在我们的styles.xml文件中的AppTheme标签中加入如下两行：</p>
<pre class="line-numbers"><code class="language-xml">&lt;item name=&quot;windowActionBar&quot;&gt;false&lt;/item&gt;
&lt;item name=&quot;windowNoTitle&quot;&gt;true&lt;/item&gt;
</code></pre>
<p>当然了，你也可以新建一个<code>&lt;style&gt;</code>标签，将上面两行代码加入，并且将这个新建的标签作为<code>&lt;application&gt;</code>的<code>theme</code>。还可以选择通过将<code>AppTheme</code>的<code>parent</code>设置为<code>Theme.AppCompat.Light.NoActionBar</code>的方式。方法很多，可以自己随便选。</p>
<p>接下来就是将Toolbar放入到布局文件（没啥好解释的）：</p>
<pre class="line-numbers"><code class="language-xml">  &lt;android.support.v7.widget.Toolbar
        android:id=&quot;@+id/toolbar&quot;
        android:layout_width=&quot;match_parent&quot;
        android:background=&quot;?attr/colorPrimary&quot;
        android:layout_height=&quot;?android:attr/actionBarSize&quot;  /&gt;
</code></pre>
<p>最后将Toobar作为“ActionBar”来用</p>
<pre class="line-numbers"><code class="language-java"> Toolbar toolbar = (Toolbar) findViewById(R.id.toolbar);
        toolbar.setTitle(&quot;这里是Title&quot;);
        toolbar.setSubtitle(&quot;这里是子标题&quot;);
        toolbar.setLogo(R.drawable.icon); 
        setSupportActionBar(toolbar);
</code></pre>
<p>可以对Toolbar设置Logo、标题、子标题等等~还有很多其他的设置，自己去慢慢玩，这里不提啦~。当然了，也可以在布局文件中设置这些，在布局文件设置就不写啦，hongyang大神有篇博客写的挺好的<a href="http://blog.csdn.net/lmj623565791/article/details/45303349">《 Android 5.x Theme 与 ToolBar 实战 》</a>可以去参考一下。</p>
<p>如果Toolbar仅仅是用来对以往的ActionBar做一次替换，那也太没创意啦！完全没必要去替换了，因为它们表现出来的都是一样的，而且并没有让我们觉得用起来比ActionBar方便。那为啥要替换呢，总应该有他的理由吧：ActionBar是固定在顶部，并不能移动，我觉得这是最大的不好，而我们的ToolBar可以让我们随便摆放，就就可以带来很多灵活性和效果啦！</p>
<p>正如你所看的这样，Toolbar根本就不够看的，一点都不复杂。接下来我们继续学习在Toolbar上面再套一层父View，让Toolbar更有互动性。</p>
<h2><a id="appbarlayout" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>AppBarLayout</h2>
<blockquote>
<p>AppBarLayout继承自LinearLayout，布局方向为垂直方向。所以你可以把它当成垂直布局的LinearLayout来使用。AppBarLayout是在LinearLayou上加了一些材料设计的概念，它可以让你定制当<strong>某个可滚动View</strong>的滚动手势发生变化时，其内部的子View实现何种动作。</p>
</blockquote>
<p>请注意：上面提到的<strong>某个可滚动View</strong>，可以理解为某个ScrollView。怎么理解上面的话呢？就是说，当某个ScrollView发生滚动时，你可以定制你的“顶部栏”应该执行哪些动作（如跟着一起滚动、保持不动等等）。那某个可移动的View到底是哪个可移动的View呢？这是由你自己指定的！如何指定，我们后面说。</p>
<h3><a id="appbarlayout%E5%AD%90view%E7%9A%84%E5%8A%A8%E4%BD%9C" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>AppBarLayout子View的动作</h3>
<p>内部的子View通过在布局中加<code>app:layout_scrollFlags</code>设置执行的动作，那么<code>app:layout_scrollFlags</code>可以设置哪些动作呢？分别如下：</p>
<blockquote>
<p>（1） scroll:值设为scroll的View会跟随滚动事件一起发生移动。</p>
</blockquote>
<p>什么意思呢？简单的说，就是当指定的ScrollView发生滚动时，该View也跟随一起滚动，就好像这个View也是属于这个ScrollView一样。</p>
<p>一张gif足以说明：</p>
<p><figure><img src="media/15561207870710/20171014150799488071606.gif" alt="" /></figure></p>
<p>对应的布局文件</p>
<pre class="line-numbers"><code class="language-xml">&lt;android.support.design.widget.AppBarLayout
        android:layout_width=&quot;match_parent&quot;
        android:layout_height=&quot;wrap_content&quot;&gt;

        &lt;android.support.v7.widget.Toolbar
            android:id=&quot;@+id/toolbar&quot;
            android:layout_width=&quot;match_parent&quot;
            android:layout_height=&quot;?android:attr/actionBarSize&quot;
            android:background=&quot;?attr/colorPrimary&quot;
            app:layout_scrollFlags=&quot;scroll&quot; /&gt;
&lt;/android.support.design.widget.AppBarLayout&gt;
</code></pre>
<blockquote>
<p>（2） enterAlways:值设为enterAlways的View,当ScrollView往下滚动时，该View会直接往下滚动。而不用考虑ScrollView是否在滚动。</p>
</blockquote>
<p>看个动画片（Y(^o^)Y）（ToolBar高度设为：<code>?android:attr/actionBarSize,app:layout_scrollFlags=&quot;scroll|enterAlways&quot;</code>）：</p>
<p><figure><img src="media/15561207870710/20171014150799493830006.gif" alt="" /></figure></p>
<blockquote>
<p>（3） <code>exitUntilCollapsed</code>：值设为<code>exitUntilCollapsed</code>的View，当这个View要往上逐渐“消逝”时，会一直往上滑动，直到剩下的的高度达到它的最小高度后，再响应ScrollView的内部滑动事件。</p>
</blockquote>
<p>怎么理解呢？简单解释：在ScrollView往上滑动时，首先是View把滑动事件“夺走”，由View去执行滑动，直到滑动最小高度后，把这个滑动事件“还”回去，让ScrollView内部去上滑。看个gif感受一下（图中将高度设的比较大:200dp，并将最小高度设置为<code>?android:attr/actionBarSize,app:layout_scrollFlags=&quot;scroll|exitUntilCollapsed&quot;</code>）：</p>
<p><figure><img src="media/15561207870710/20171014150799499853731.gif" alt="" /></figure></p>
<blockquote>
<p>（4） <code>enterAlwaysCollapsed</code>：是<code>enterAlways</code>的附加选项，一般跟<code>enterAlways</code>一起使用，它是指，View在往下“出现”的时候，首先是<code>enterAlways</code>效果，当View的高度达到最小高度时，View就暂时不去往下滚动，直到ScrollView滑动到顶部不再滑动时，View再继续往下滑动，直到滑到View的顶部结束。<br />
来个gif感受一下（图中将高度设的比较大:200dp，并将最小高度设置为<code>?android:attr/actionBarSize,app:layout_scrollFlags=&quot;scroll|enerAlways|enterAlwaysCollapsed&quot;</code>）：</p>
</blockquote>
<p><figure><img src="media/15561207870710/20171014150799505696205.gif" alt="" /></figure></p>
<h3><a id="%E5%B0%86appbarlayout%E4%B8%8Escrollview%E5%85%B3%E8%81%94%E8%B5%B7%E6%9D%A5" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>将AppBarLayout与ScrollView关联起来</h3>
<p>前面说了一直反复说“当ScrollView发生滚动时”，那么怎么将AppBarLayout与ScrollView关联起来呢？我们注意到，AppBarLayout与ScrollView之间动作“相互依赖”，这不就是我们上一篇<a href="http://blog.csdn.net/huachao1001/article/details/51554608">《CoordinateLayout的使用如此简单 》</a>所学的内容吗？把ScrollView和AppBarLayout作为CoordinateLayout的子View，然后编写一个Behavior，在这个Behavior里面判断当前的操作是应该让ScrollView时刻保持在AppBarLayout之下（即只要改变AppBarLayout的位置就可以一起滑动），还是应该让ScrollView内部滚动而不让AppBarLayout位置发生变化等等这些需求，都是可以在Behavior里面处理的。你可以去针对你的ScrollView编写Behavior。然而，我们看到我们的AppBarLayout事先的功能比较复杂，如果我们自己去定义这样的效果，代码非常复杂，还要考虑很多方面，好在Android帮我们写好啦，我们直接用就是了，这个ScrollView就是NestedScrollView，请注意，它并没有继承ScrollView，它继承的是FrameLayout，但是它实现的效果把它可以看成是ScrollView。</p>
<p>把NestedScrollView放入到我们的layout文件里面就可以啦~~~，很方便~</p>
<pre class="line-numbers"><code class="language-xml"> &lt;android.support.v4.widget.NestedScrollView

        android:layout_width=&quot;match_parent&quot;
        android:layout_height=&quot;wrap_content&quot;
        app:layout_behavior=&quot;@string/appbar_scrolling_view_behavior&quot;&gt;

       &lt;!--将你的内容放在这里--&gt;

&lt;/android.support.v4.widget.NestedScrollView&gt;
</code></pre>
<p>有没有注意到有个属性：<code>app:layout_behavior=&quot;@string/appbar_scrolling_view_behavior&quot;</code>,它就是指定Behavior的，<code>appbar_scrolling_view_behavior</code>对应的类的名称是：<code>android.support.design.widget.AppBarLayout$ScrollingViewBehavior</code>感兴趣的可以去分析源码。</p>
<p>好了，我们现在会用AppBarLayout啦~是不是发现用起来so easy!接下来我们把剩下<code>CollapsingToolbarLayout</code>的给&quot;消化&quot;掉！</p>
<h2><a id="collapsingtoolbarlayout" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>CollapsingToolbarLayout</h2>
<p>CollapsingToolbarLayout是用来对Toolbar进行再次包装的ViewGroup，主要是用于实现折叠（其实就是看起来像伸缩~）的App Bar效果。它需要放在AppBarLayout布局里面，并且作为AppBarLayout的直接子View。CollapsingToolbarLayout主要包括几个功能（参照了官方网站上内容，略加自己的理解进行解释）：</p>
<blockquote>
<p>(1) 折叠Title（Collapsing title）：当布局内容全部显示出来时，title是最大的，但是随着View逐步移出屏幕顶部，title变得越来越小。你可以通过调用<code>setTitle</code>函数来设置title。</p>
</blockquote>
<blockquote>
<p>(2)内容纱布（Content scrim）：根据滚动的位置是否到达一个阀值，来决定是否对View“盖上纱布”。可以通过<code>setContentScrim(Drawable)</code>来设置纱布的图片.</p>
</blockquote>
<blockquote>
<p>(3)状态栏纱布（Status bar scrim)：根据滚动位置是否到达一个阀值决定是否对状态栏“盖上纱布”，你可以通过<code>setStatusBarScrim(Drawable)</code>来设置纱布图片，但是只能在LOLLIPOP设备上面有作用。</p>
</blockquote>
<blockquote>
<p>(4)视差滚动子<code>View(Parallax scrolling children)</code>:子View可以选择在当前的布局当时是否以“视差”的方式来跟随滚动。<strong>（PS:其实就是让这个View的滚动的速度比其他正常滚动的View速度稍微慢一点）</strong>。将布局参数<code>app:layout_collapseMode</code>设为<code>parallax</code></p>
</blockquote>
<blockquote>
<p>(5)将子View位置固定(Pinned position children)：子View可以选择是否在全局空间上固定位置，这对于Toolbar来说非常有用，因为当布局在移动时，可以将Toolbar固定位置而不受移动的影响。 将app:layout_collapseMode设为pin。</p>
</blockquote>
<p>了解这些概念后，我们来看看布局吧~</p>
<pre class="line-numbers"><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;android.support.design.widget.CoordinatorLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;
    android:layout_width=&quot;match_parent&quot;
    android:layout_height=&quot;match_parent&quot; &gt;


    &lt;android.support.design.widget.AppBarLayout
        android:layout_width=&quot;match_parent&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:theme=&quot;@style/ThemeOverlay.AppCompat.Dark.ActionBar&quot;&gt;

        &lt;android.support.design.widget.CollapsingToolbarLayout
            android:layout_width=&quot;match_parent&quot;
            android:layout_height=&quot;wrap_content&quot;
            app:expandedTitleMarginEnd=&quot;64dp&quot;
            app:expandedTitleMarginStart=&quot;48dp&quot;
            app:layout_scrollFlags=&quot;scroll|exitUntilCollapsed&quot;&gt;

            &lt;ImageView
                android:id=&quot;@+id/main.backdrop&quot;
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;300dp&quot;
                android:scaleType=&quot;centerCrop&quot;
                android:src=&quot;@drawable/material_img&quot;
                app:layout_collapseMode=&quot;parallax&quot; /&gt;

            &lt;android.support.v7.widget.Toolbar
                android:id=&quot;@+id/toolbar&quot;
                android:layout_width=&quot;match_parent&quot;
                android:layout_height=&quot;?android:attr/actionBarSize&quot;
                app:layout_collapseMode=&quot;pin&quot;  /&gt;

        &lt;/android.support.design.widget.CollapsingToolbarLayout&gt;
    &lt;/android.support.design.widget.AppBarLayout&gt;

    &lt;android.support.v4.widget.NestedScrollView

        android:layout_width=&quot;match_parent&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:paddingTop=&quot;50dp&quot;
        app:layout_behavior=&quot;@string/appbar_scrolling_view_behavior&quot;&gt;

        &lt;TextView
            android:layout_width=&quot;match_parent&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:text=&quot;@string/my_txt&quot;
            android:textSize=&quot;20sp&quot; /&gt;

    &lt;/android.support.v4.widget.NestedScrollView&gt;

&lt;/android.support.design.widget.CoordinatorLayout&gt;
</code></pre>
<p>上面的都看得懂吧，每个陌生的属性都是讲过的哦，忘记了的话回头看，稍微解释一下，图片被设置为有视差的滑动，Toolbar设置为固定不动，另外，CollapsingToolbarLayout会对title进行放大和缩小，我们看看效果吧~</p>
<p><figure><img src="media/15561207870710/20171014150799532425417.gif" alt="" /></figure></p>
<p>如果你希望拖动过程中状态栏是透明的，可以在<code>CollapsingToolbarLayout</code>中加 <code>app:statusBarScrim=&quot;@android:color/transparent</code>&quot;，并且在onCreate中调用<code>getWindow().addFlags(WindowManager.LayoutParams.FLAG_TRANSLUCENT_STATUS)</code>将状态栏设置为透明就好啦~</p>
<p>献上<a href="http://download.csdn.net/detail/huachao1001/9538934">源码</a></p>
<h2><a id="appbarlayout%E7%9A%84scrollflags%E5%B1%9E%E6%80%A7" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>AppBarLayout的ScrollFlags属性</h2>
<p>在前面两篇MD系列的文章中，通过两个案例基本上能够掌握了CoordinatorLayout与AppBarLayout的配合使用。本文我们回过头来详细聊聊AppBarLayout的ScrollFlags属性，了解一下不同值之间的区别。至此，Android Material Design系列的学习已进行到第七篇，大家可以点击以下链接查看之前的文章：</p>
<ul>
<li><a href="http://www.jianshu.com/p/39a66373498c">Android TabLayout 分分钟打造一个滑动标签页</a></li>
<li><a href="http://www.jianshu.com/p/9eb3b17b0e77">Android 一文告诉你到底是用Dialog，Snackbar，还是Toast</a></li>
<li><a href="http://www.jianshu.com/p/5328b2eee827">Android FloatingActionButton 重要的操作不要太多，一个就好</a></li>
<li><a href="http://www.jianshu.com/p/ab04627cce58">Android 初识AppBarLayout 和 CoordinatorLayout</a></li>
<li><a href="http://www.jianshu.com/p/4b0f3c80ebc9">Android CoordinatorLayout实战案例学习《一》</a></li>
<li><a href="http://www.jianshu.com/p/360fd368936d">Android CoordinatorLayout 实战案例学习《二》</a></li>
</ul>
<p>ScrollFlags共有五种常量值供AppBarLayout的Children View使用，在xml布局文件中通过<code>app:layout_scrollFlags</code>设置，对应的值为：scroll，enterAlways，enterAlwaysCollapsed，snap，exitUntilCollapsed；也可以在代码中通过<code>setScrollFlags(int)</code>方法使用，比如：</p>
<pre class="line-numbers"><code class="language-java">Toolbar toolbar = ... // your toolbar within an AppBarLayout
AppBarLayout.LayoutParams params = 
    (AppBarLayout.LayoutParams) toolbar.getLayoutParams();
params.setScrollFlags(AppBarLayout.LayoutParams.SCROLL_FLAG_SCROLL
    | AppBarLayout.LayoutParams.SCROLL_FLAG_ENTER_ALWAYS);
</code></pre>
<p>下面我们通过官网介绍、XML代码和对应的效果图分别分析这五种值的使用（备注：代码中设置也一样，不再赘述）：</p>
<h3><a id="scroll" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>scroll</h3>
<blockquote>
<p>The view will be scroll in direct relation to scroll events. This flag needs to be set for any of the other flags to take effect. If any sibling views before this one do not have this flag, then this value has no effect.</p>
</blockquote>
<p>Child View 伴随着滚动事件而滚出或滚进屏幕。注意两点：第一点，如果使用了其他值，必定要使用这个值才能起作用；第二点：如果在这个child View前面的任何其他Child View没有设置这个值，那么这个Child View的设置将失去作用。</p>
<p>示例XML代码：</p>
<pre class="line-numbers"><code class="language-xml">    &lt;android.support.design.widget.AppBarLayout
        android:id=&quot;@+id/appbar&quot;
        android:layout_width=&quot;match_parent&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:theme=&quot;@style/ThemeOverlay.AppCompat.Dark.ActionBar&quot;&gt;

        &lt;android.support.v7.widget.Toolbar
            xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;
            android:id=&quot;@+id/tb_toolbar&quot;
            android:layout_width=&quot;match_parent&quot;
            android:layout_height=&quot;@dimen/dp_56&quot;
            app:titleTextColor=&quot;@color/white&quot;
            app:title=&quot;@string/app_name&quot;
            app:theme=&quot;@style/OverFlowMenuTheme&quot;
            app:popupTheme=&quot;@style/AppTheme&quot;
            android:background=&quot;@color/blue&quot;
            app:layout_scrollFlags=&quot;scroll|enterAlways&quot;/&gt;

    &lt;/android.support.design.widget.AppBarLayout&gt;
</code></pre>
<p>对应效果图：</p>
<p><figure><img src="media/15561207870710/20171019150842247229844.gif" alt="" /></figure></p>
<h3><a id="enteralways" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>enterAlways</h3>
<blockquote>
<p>When entering (scrolling on screen) the view will scroll on any downwards scroll event, regardless of whether the scrolling view is also scrolling. This is commonly referred to as the 'quick return' pattern.</p>
</blockquote>
<p>快速返回模式。其实就是向下滚动时Scrolling View和Child View之间的滚动优先级问题。对比<code>scroll</code>和<code>scroll | enterAlways</code>设置，发生向下滚动事件时，前者优先滚动Scrolling View，后者优先滚动Child View，当优先滚动的一方已经全部滚进屏幕之后，另一方才开始滚动。</p>
<p>示例XML代码：</p>
<pre class="line-numbers"><code class="language-java">...
app:layout_scrollFlags=&quot;scroll|enterAlways&quot;
...

</code></pre>
<p>对应效果图：</p>
<p><figure><img src="media/15561207870710/20171019150842251698266.gif" alt="" /></figure></p>
<h3><a id="enteralwayscollapsed" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>enterAlwaysCollapsed</h3>
<blockquote>
<p>An additional flag for 'enterAlways' which modifies the returning view to only initially scroll back to it's collapsed height. Once the scrolling view has reached the end of it's scroll range, the remainder of this view will be scrolled into view. The collapsed height is defined by the view's minimum height.</p>
</blockquote>
<p>enterAlways的附加值。这里涉及到Child View的高度和最小高度，向下滚动时，Child View先向下滚动最小高度值，然后Scrolling View开始滚动，到达边界时，Child View再向下滚动，直至显示完全。</p>
<p>示例XML代码：</p>
<pre class="line-numbers"><code class="language-xml">...
android:layout_height=&quot;@dimen/dp_200&quot;
android:minHeight=&quot;@dimen/dp_56&quot;
...
app:layout_scrollFlags=&quot;scroll|enterAlways|enterAlwaysCollapsed&quot;
...
</code></pre>
<p>对应效果图：</p>
<p><figure><img src="media/15561207870710/20171019150842256217688.gif" alt="" /></figure></p>
<h3><a id="exituntilcollapsed" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>exitUntilCollapsed</h3>
<blockquote>
<p>When exiting (scrolling off screen) the view will be scrolled until it is 'collapsed'. The collapsed height is defined by the view's minimum height.</p>
</blockquote>
<p>这里也涉及到最小高度。发生向上滚动事件时，Child View向上滚动退出直至最小高度，然后Scrolling View开始滚动。也就是，Child View不会完全退出屏幕。</p>
<p>示例SML代码：</p>
<pre class="line-numbers"><code class="language-xml">...
android:layout_height=&quot;@dimen/dp_200&quot;
android:minHeight=&quot;@dimen/dp_56&quot;
...
app:layout_scrollFlags=&quot;scroll|exitUntilCollapsed&quot;
...
</code></pre>
<p>对应效果图：</p>
<p><figure><img src="media/15561207870710/20171019150842260265572.gif" alt="" /></figure></p>
<h3><a id="snap" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>snap</h3>
<blockquote>
<p>Upon a scroll ending, if the view is only partially visible then it will be snapped and scrolled to it's closest edge. For example, if the view only has it's bottom 25% displayed, it will be scrolled off screen completely. Conversely, if it's bottom 75% is visible then it will be scrolled fully into view.</p>
</blockquote>
<p>简单理解，就是Child View滚动比例的一个吸附效果。也就是说，Child View不会存在局部显示的情况，滚动Child View的部分高度，当我们松开手指时，Child View要么向上全部滚出屏幕，要么向下全部滚进屏幕，有点类似ViewPager的左右滑动。</p>
<p>示例XML代码：</p>
<pre class="line-numbers"><code class="language-xml">...
android:layout_height=&quot;@dimen/dp_200&quot;
...
app:layout_scrollFlags=&quot;scroll|snap&quot;
...
</code></pre>
<p>对应效果图：</p>
<p><figure><img src="media/15561207870710/20171019150842265497458.gif" alt="" /></figure></p>
<h3><a id="%E7%A4%BA%E4%BE%8B%E6%BA%90%E7%A0%81" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>示例源码</h3>
<p>我在GitHub上建立了一个Repository，用来存放整个Android Material Design系列控件的学习案例，会伴随着文章逐渐更新完善，欢迎大家补充交流，Star地址：</p>
<p><a href="https://github.com/Mike-bel/MDStudySamples">https://github.com/Mike-bel/MDStudySamples</a></p>

                        
                      </div>
                  </div>
                </a>
                <div class="read-more clearfix">
                  <div class="more-left left">
                  
                    <span class="date">2017/08/26</span>
                    <span>posted in&nbsp;</span> 
          				  
          					    <span class="posted-in"><a href='Android.html'>Android</a></span>
          				   
                    

                  </div>
                  <div class="more-right right">
                  <span class="comments">
                      

                       
                  </span>
                  </div>
                </div>
              </div><!-- article -->
        
			<div class="article">
                <a class="clearlink" href="15561207870673.html">
                
                  <h1>Android-Debug</h1>
                  <div class="a-content">
                      
                      <div class="a-content-text">
                        
                        	<h2><a id="%E4%B8%80%E3%80%81%E8%BF%9B%E5%85%A5debug%E6%A8%A1%E5%BC%8F%E7%9A%84%E4%B8%A4%E7%A7%8D%E5%A7%BF%E5%8A%BF" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>一、 进入 debug 模式的两种姿势</h2>
<p>第一种是点击运行按钮旁边的“绿色甲虫”(debug app)开始以调试模式编译运行。</p>
<p><figure><img src="media/15561207870673/15713320071550.png" alt="" /></figure></p>
<p>这个方式的特点是，一开始就进入了调试模式。适合希望尽早进入调试模式的场景，比如你想从头开始追踪问题，或者断点在启动页或首页之类的。它的弊端是每次需要从头跑一遍，且由于调试模式下应用程序略卡顿，等你到达调试页面时会觉得老费劲。</p>
<p><figure><img src="media/15561207870673/15713320153903.png" alt="" /></figure></p>
<p>第二种方式是在手机或模拟器已经跑起来应用程序后点击 <code>Run</code> -&gt; <code>Attach debugger to Android process</code>，选择应用程序主进程，即可进入调试模式。</p>
<p>这种方式的特点是，随时随地自由进入调试模式，不需要重头开始跑应用程序，该方式适合绝大多数调试场景。需要注意的是，假如跑的是 <code>release</code> 版本且有混淆加固之类的话，该方式就无法正常调试。</p>
<h2><a id="%E4%BA%8C%E3%80%81%E5%B8%B8%E8%A7%81%E7%9A%84%E8%B0%83%E8%AF%95%E6%93%8D%E4%BD%9C" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>二、 常见的调试操作</h2>
<h3><a id="1%E5%85%B8%E5%9E%8B%E7%9A%84%E8%B0%83%E8%AF%95%E5%9C%BA%E6%99%AF" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>1 典型的调试场景</h3>
<p>一个最常见的调试场景如下：</p>
<ol>
<li>完成包括打开 Android Studio、打开需要调试的类、连接手机等准备工作</li>
<li>在关键位置打上普通断点，进入调试模式后触发断点，将当前线程阻塞在断点处</li>
<li>单步调试，一行一行往下运行</li>
<li>碰到方法调用时进入方法内部</li>
<li>用单步调试单步执行直到该方法结束回到方法调用的下一行，或者直接退出当前方法</li>
<li>通过观察观察区的相关变量，推断出问题所在，结束本次调试</li>
</ol>
<p>以上是最常规的 debug 场景，下面介绍下调试界面。</p>
<p><figure><img src="media/15561207870673/15713320235325.png" alt="" /></figure></p>
<p>在 Android Studio 的 debug 标签（假如一开始没有，等触发断点后自然会出现）中有两个面板 debugger 和 console。debugger 又分为 Frames、Threads 和 Variables 三块，分别是堆栈内容、线程、变量区。</p>
<p>在 debugger 标签右边有一些操作按钮，是我们常用的调试操作，下面会一一介绍。（可以用鼠标悬停在上面看每个按钮的具体名称）</p>
<h3><a id="2%E8%AE%BE%E7%BD%AE%E6%96%AD%E7%82%B9" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>2 设置断点</h3>
<p>断点有多种类型，我们这里先只谈普通断点。在每行的最前端单击一下即可<strong>添加断点</strong>，在断点上单击一下是<strong>取消断点</strong>。普通模式下断点只是一个普通的红点，但假如是在调试模式下，则红点上会有一个“√”或“✘”表示该行是否会被运行，例如，注释行前的断点会是“✘”。</p>
<p><figure><img src="media/15561207870673/15713320307577.png" alt="" /></figure></p>
<p>不管怎样，触发断点肯定是调试的起点。只有触发了断点，才会开始阻塞线程（注意是只会阻塞当前线程，这个后面会扩展一下详细介绍），此时当前代码行会被蓝色高亮，观察面板上的变量也会显示当前环境下的值。</p>
<h3><a id="3%E8%B7%B3%E5%88%B0%E4%B8%8B%E4%B8%80%E4%B8%AA%E6%96%AD%E7%82%B9%EF%BC%88-f9%EF%BC%89" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>3 跳到下一个断点（F9）</h3>
<p>一般情况下，在调试时我们可以根据我们的经验在几个关键的位置打上断点，这里就需要从一个断点直接跳到下一个断点。操作是继续以 debug 模式运行，快捷键是 F9（假如没改动的话应该都是这个快捷键，假如不同，可以把鼠标悬浮在该图标上看提示，下同）。</p>
<h3><a id="4%E5%8D%95%E6%AD%A5%E8%B0%83%E8%AF%95%EF%BC%88-f8%EF%BC%89" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>4 单步调试（F8）</h3>
<p>触发断点后，我们当然可以通过加 N 个断点来定位问题，但在较复杂的场景里可能没法判断出关键点。这时可以在比较靠前的位置添加断点作为起点，一行一行执行。操作是单步调试，快捷键是 F8。</p>
<h3><a id="5%E8%BF%9B%E5%85%A5%E6%96%B9%E6%B3%95%E5%86%85%E9%83%A8%EF%BC%88-f7%EF%BC%89" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>5 进入方法内部（F7）</h3>
<p>在单步调试时方法调用语句会被看做一行，那么如何进入方法内部呢？用“进入内部”操作，快捷键是 F7.</p>
<h3><a id="6%E9%80%80%E5%87%BA%E5%BD%93%E5%89%8D%E6%96%B9%E6%B3%95%EF%BC%88%E4%B8%8A%E6%A1%A3%E9%94%AE-f8%EF%BC%89" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>6 退出当前方法（上档键+F8）</h3>
<p>既然有进入方法内部，就有退出当前方法的操作。当进入某个方法内部后觉得该方法后面的代码不需要看了，不需要猛按 F8 让它们跑完，可以直接退出当前方法去到该方法调用处的下一行。</p>
<p>有了这些操作，基本可以应付常见的 80% 的调试场景了。但仅仅了解这些，在面对复杂场景时难免效率低下。下面介绍几种非常高效的断点。</p>
<h2><a id="%E4%B8%89%E3%80%81%E5%87%A0%E7%A7%8D%E9%AB%98%E6%95%88%E6%96%AD%E7%82%B9" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>三、 几种高效断点</h2>
<h3><a id="1%E6%9D%A1%E4%BB%B6%E6%88%90%E7%AB%8B%E6%97%B6%E6%89%8D%E8%A7%A6%E5%8F%91%E7%9A%84%E6%9D%A1%E4%BB%B6%E6%96%AD%E7%82%B9" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>1 条件成立时才触发的条件断点</h3>
<p>普通断点在每次运行到时都会被触发，这在多次调用、有“循环”的场景会比较麻烦，比如循环 100 次只希望停留在第 98 次。那么此刻就可以用上条件断点了。</p>
<p>添加条件断点：先在需要的行前左键单击添加普通断点，右键点击该断点出现对话框，在“Condition”处填入条件即可，条件语法同 Java，如 i == 98。点击 Done，完成添加。这样当条件未满足时，不会阻塞程序运行；当条件满足时断点被触发。</p>
<p><figure><img src="media/15561207870673/15713320404295.png" alt="" /></figure></p>
<h3><a id="2%E4%B8%8D%E4%BC%9A%E9%98%BB%E5%A1%9E%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%97%A5%E5%BF%97%E6%96%AD%E7%82%B9" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>2 不会阻塞应用程序的日志断点</h3>
<p>有时候我们仅仅希望在关键时刻输出一些 log，那么我们需要做这些工作：</p>
<ol>
<li>在代码里加上 log 代码</li>
<li>重新运行程序</li>
<li>重新触发断点</li>
</ol>
<p>那么有没有什么方法可以避免这些繁杂的操作呢？这时可以试试日志断点。</p>
<p>在条件断点弹出的对话框里，将“suspend”设置为未选中状态，断点触发时就不会被阻塞。此时对话框会多出一些选项。</p>
<p><figure><img src="media/15561207870673/15713320484306.png" alt="" /></figure></p>
<p>我们选中“Evaluated and log”，并在里面填写希望输出的日志，点击 Done 即可。注意，日志将输出到 Console 而非 LogCat。</p>
<h3><a id="3%E8%A2%AB%E5%BC%82%E5%B8%B8%E8%A7%A6%E5%8F%91%E7%9A%84%E5%BC%82%E5%B8%B8%E6%96%AD%E7%82%B9" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>3 被异常触发的异常断点</h3>
<p>我们做 debug，一般面对的都是未崩溃的异常，例如 UI 状态不对、数值不对、代码执行逻辑不对等等。碰到直接 crash 的情况，我们往往不会去 debug，而是根据报错信息定位到某某行，然后解决问题。最典型的就是空指针异常了，只要看到报错位置，基本手到擒来。</p>
<p>但日常开发难免碰到一些给出具体信息和抛异常的位置也没有头绪或者未给出具体位置的情况，比如某 API 抛了个状态异常，那么我们可能得去琢磨为何会状态不对。</p>
<p>这时还是得调试，但我们也不能眼睁睁看着抛出的异常让应用程序崩了，可以用上“异常断点”。</p>
<p>我们打开断点管理器，可以看到有一类是“Java Exception Breakpoints”，直接勾上是所有异常都会被触发。</p>
<p>假如只想被某种异常触发，我们可以点击“+”，选中“Java Exception Breakpoints”，然后输出该种异常即可。</p>
<p><figure><img src="media/15561207870673/15713320567239.png" alt="" /></figure></p>
<p>有朋友可能注意到除了 “Java Exception Breakpoints” 外还有一个 “Exception Breakpoints”，两者区别主要是前者只支持 Java 本身的异常，后者可以支持自定义异常。</p>
<h3><a id="4%E8%BF%BD%E8%B8%AA%E5%85%B3%E9%94%AE%E7%82%B9%E7%9A%84%E5%AD%97%E6%AE%B5%E6%96%AD%E7%82%B9%E5%92%8C%E6%96%B9%E6%B3%95%E6%96%AD%E7%82%B9" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>4 追踪关键点的字段断点和方法断点</h3>
<p>在诸如多线程等复杂场景下，超多的变量和超多的类再加上一些 native 方法和第三方库，调试的复杂度也直线上升。</p>
<p>**这时可以尝试以点破面，抓住关键方法或字段来追踪应用程序的运行轨迹。**于是关注某字段的字段断点和关注某方法的方法断点就派上用场了。</p>
<p>顾名思义，字段断点的触发条件是字段值被更改，方法断点是方法被调用。</p>
<p>添加方式：在字段那行、在方法声明的那行单击即可。</p>
<p><figure><img src="media/15561207870673/15713320679940.png" alt="" /></figure></p>
<h3><a id="5%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>5 注意事项</h3>
<p>除了以上这些，还有其他断点未列出来，比如临时断点等。考虑到这类断点实用性不强，就不多加说明，有需求的朋友自然会去了解。</p>
<p><strong>需要说明的是，给断点命名只是为了方便交流，各类型之间并没有特别边界。</strong> 实际上，断点只是某些操作的集合而已。比如日志断点是“不阻塞”和“输出日志”两个操作的集合，那么我们当然可以加上“设置条件”操作变成“条件日志断点”，诸如此类。我们设置断点的面板是允许我们将多种断点条件混合使用的。</p>
<p>所以，<strong>断点名称和类型不重要，重要的是针对现场选用合适的操作。</strong></p>
<h2><a id="%E5%9B%9B%E8%B0%83%E8%AF%95%E4%B8%AD%E7%9A%84%E5%8F%98%E9%87%8F" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>四 调试中的变量</h2>
<p>在设置了合适的断点后，我们就可以进行下一步操作 —— 观察变量，准确的说是观察变量的值。</p>
<h3><a id="1%E5%8F%98%E9%87%8F%E8%A7%82%E6%B5%8B%E9%9D%A2%E6%9D%BF" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>1 变量观测面板</h3>
<p>众所周知，应用程序在运行期间元素都处于一种动态状态，此刻你是无法观测到具体变量的值的。只有当动态变成静态，即阻塞住应用程序，才能开始变量观测。</p>
<p>这个“阻塞”操作也就是上文提到的断点触发。</p>
<p>这里需要特别指出的是，当需要追踪某一个特定变量时，字段断点是一大利器。</p>
<p><figure><img src="media/15561207870673/15713320794441.png" alt="" /></figure></p>
<p>如上图所示，变量观察面板会列出所有当前能访问到的成员变量和局部变量。</p>
<p>点击变量前的箭头，可以将该实例展开，列出所有字段。</p>
<h3><a id="2-add-new-watch" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>2 Add New Watch</h3>
<p>将所有变量、所有字段列出来是比较直观，但当我们要去获取某些属性时就略蛋疼了。</p>
<p>比如，获取某成员变量 View 的第一个 <code>child</code> 的 <code>measuredHeight</code>。假如是靠手动去一个个“打开”属性列表，拿得多麻烦。</p>
<p>又比如，我们需要获取到两个属性相加后占另一个值的百分比。先去找到这两个属性的值然后额外拿计算器计算？</p>
<p>这时就可以用上 “Add New Watch”了，添加一个观察表达式。通俗点就是在变量观测区执行一个表达式并得到它的值。</p>
<p>在面试左侧点击绿色“+”，或者点击右键在菜单中选择“New Watch”, 就会出现一个框，输入表达式即可。</p>
<p>举个例子：</p>
<p>在示例中输入<code>toolbar.getChildAt(0).getMeasuredHeight()</code>，可得到如图的结果。</p>
<p><figure><img src="media/15561207870673/15713320865126.png" alt="" /></figure></p>
<h3><a id="3%E8%AE%BE%E7%BD%AE%E5%8F%98%E9%87%8F%E7%9A%84%E5%80%BC" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>3 设置变量的值</h3>
<p><strong>变量的值除了能被观察外，还可以在运行时改变。</strong> 这个可以说是超酷的黑科技了。试想，碰到一个 <code>if else</code> 时，我们可以很轻松无成本地通过更改变量的值，让应用程序能跑到我们期望的分支上。</p>
<p>设置变量的值有两种方式：方式一是在变量观测区右键单击变量，在菜单中选中“set value”；方式二是鼠标悬浮在代码区中的某个可访问的变量上，在弹出的浮层里更改值。</p>
<p><figure><img src="media/15561207870673/15713320950169.png" alt="" /></figure></p>
<h2><a id="%E4%BA%94%E7%8A%80%E5%88%A9%E7%9A%84%E5%B0%8F%E5%8A%9F%E8%83%BD" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>五 犀利的小功能</h2>
<p>除了以上那些常规的操作，还有一些“还有这种操作”的小功能。</p>
<h3><a id="1-force-run-to-cursor" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>1 Force Run to Cursor</h3>
<p>该操作可以忽视已存在的断点，直接跳到光标所在的行。有种脱离断点、繁琐操作的束缚轻松自由的感觉有木有。</p>
<h3><a id="2-drop-frame" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>2 Drop frame</h3>
<p>经过不懈努力，终于快到出错的那个时刻啦，你眉飞色舞手指按得飞快，结果小手一抖，多按了几个 F8 （单步调试快捷键），错过了出错的那个时刻。<strong>如果能回退到方法执行前？</strong></p>
<p>Drop frame 功能能让你回到当前方法被调用的地方，并且当前上下文所有变量也都恢复到方法调用前 —— 时光回溯有木有？</p>
<p>**当然别太兴奋，由于 DalvikVM 和 Android Runtime (ART) 不支持，大部分情况下你是用不到的，那个按钮长期处于不可点击状态。**但如果你是在跑 JUnit 测试的话，是可以用上的。</p>
<h3><a id="3-log" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>3 Log</h3>
<p>在多线程环境下，光靠 debug 是不行的。有时 debug 本身会带来一些问题混淆了现场，比如因为 debug 时的卡顿造成环境不一致等等，这时应该学会使用打日志的形式帮忙调试。</p>
<h3><a id="4%E5%B8%83%E5%B1%80%E6%9F%A5%E7%9C%8B%E5%99%A8" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>4 布局查看器</h3>
<p>在 Android Studio 的 Android Device Monitor 里有一个 “Dump View Hierarchy for UI Automator” 功能，可以看到当前手机上应用的具体布局情况 —— 甚至布局元素的属性都会一一给出（仅可用于可调试的应用）。对 UI 调试非常有帮助。</p>
<p><figure><img src="media/15561207870673/15713321037475.png" alt="" /></figure></p>

                        
                      </div>
                  </div>
                </a>
                <div class="read-more clearfix">
                  <div class="more-left left">
                  
                    <span class="date">2017/08/25</span>
                    <span>posted in&nbsp;</span> 
          				  
          					    <span class="posted-in"><a href='Android.html'>Android</a></span>
          				   
                    

                  </div>
                  <div class="more-right right">
                  <span class="comments">
                      

                       
                  </span>
                  </div>
                </div>
              </div><!-- article -->
        
			<div class="article">
                <a class="clearlink" href="15561207870639.html">
                
                  <h1>Android-组件化学习</h1>
                  <div class="a-content">
                      
                      <div class="a-content-text">
                        
                        	<p>网上关于组件化的文章有很多了，大部分都知道实现的思路，不过还是要自己去实践一下才会发现问题。文章的<a href="https://github.com/zj-wukewei/ModularizationExample">项目地址</a>，项目用到CleanArchitecture框架，本文会介绍CleanArchitecture框架和dagger2在组件化的使用。</p>
<h2><a id="%E9%A1%B9%E7%9B%AE%E5%85%B3%E7%B3%BB%E5%9B%BE" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>项目关系图</h2>
<p><figure><img src="media/15561207870639/15713321165510.png" alt="" /></figure></p>
<ul>
<li>sdk: 一些公用库，各种辅助类，和第三方view</li>
<li>basic: (依赖sdk) 网络访问初始化，本地缓存和第三方包等。</li>
<li>commonbusiness: (依赖basic) 这里为什么我会多出这一层，因为有很多公共的业务，好比公司的app是强登录的，我会把登录模块写在这里，里面也包含了一些baseActivity和BaseApplication和各个组件的一些公共方法还有组件各种的服务接口的定义。</li>
<li>module_archives和module_knowledge： 就是两个组件，可以单独运行。</li>
</ul>
<h2><a id="application%E5%92%8Clibrary%E5%88%87%E6%8D%A2" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>application和library切换</h2>
<p>想必大家都知道了，定义一个isBuildModule=false，在组件的build.gradle中加入</p>
<pre class="line-numbers"><code class="language-java">if (isBuildModule.toBoolean()) {
    apply plugin: 'com.android.application'
} else {
    apply plugin: 'com.android.library'
    apply from: 'maven-release-kline-aar.gradle'
}

 sourceSets {
        main {
            if (isBuildModule.toBoolean()) {
                manifest.srcFile 'src/main/debug/AndroidManifest.xml'
            } else {
                manifest.srcFile 'src/main/release/AndroidManifest.xml'
                java {
                    exclude '**/debug/**'
                }
            }
        }
    }
</code></pre>
<p>maven-release-kline-aar.gradle是一个打包aar的文件，在切换的时候也会使用不同的AndroidManifest.xml，因为在组件是debug的时候它是单独单独运行的，还有就是代码可以在建立一个debug包，可以在单独运行的时候做些初始化app的，打包的时候回剔除这部分代码。</p>
<h2><a id="library%E4%BE%9D%E8%B5%96%E5%92%8C%E8%B5%84%E6%BA%90%E9%97%AE%E9%A2%98" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>library依赖和资源问题</h2>
<p>我把所以的library都依赖在basic，每个组件都会依赖这个包，这样就不会存在library的版本问题，资源的问题就是</p>
<pre class="line-numbers"><code class="language-plain_text"> defaultConfig {

        if (isBuildModule.toBoolean()) {
            applicationId &quot;com.wkw.archives&quot;
        }

        minSdkVersion rootProject.ext.minSdkVersion
        targetSdkVersion rootProject.ext.targetSdkVersion
        versionCode rootProject.ext.versionCode
        versionName rootProject.ext.versionName

        testInstrumentationRunner &quot;android.support.test.runner.AndroidJUnitRunner&quot;

        resourcePrefix &quot;archives&quot;
    }
</code></pre>
<h2><a id="%E7%BB%84%E4%BB%B6%E4%B9%8B%E9%97%B4%E7%9A%84%E9%80%9A%E4%BF%A1" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>组件之间的通信</h2>
<p>你可以选择阿里的<a href="https://github.com/alibaba/ARouter">ARouter</a>库，但是我的项目没有那么复杂，组件也就4个左右，所以没有使用阿里的库，我采用的是以下就是核心代码，</p>
<pre class="line-numbers"><code class="language-java">Object result = null;
Class&lt;?&gt; c = Class.forName(className);
if (c != null) {
	result = c.newInstance();
}
return result;
</code></pre>
<p>但是采用Class.forName会有个问题那就是在混淆的时候，className是指定的，所以要在类上加@Keep 。</p>
<h2><a id="cleanarchitecture%E6%A1%86%E6%9E%B6%E5%92%8Cdagger%E5%9C%A8%E7%BB%84%E4%BB%B6%E5%8C%96%E7%9A%84%E4%BD%BF%E7%94%A8" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>CleanArchitecture框架和dagger在组件化的使用</h2>
<p><a href="https://github.com/android10/Android-CleanArchitecture">CleanArchitecture框架的github地址</a>，这里再介绍分享一篇文章小鄧子的<a href="http://www.jianshu.com/p/3edcf85539a6">Easy Clean architecture on Android</a>,我把data和domain会写在各自的业务模块中，自己的模块只要定义自己的就可以了，有个ApplicationModule会定义一些每个模块都需要的，</p>
<pre class="line-numbers"><code class="language-java">public class ApplicationModule {

    @Provides
    @Singleton
    Context provideContext(Application application) {
        return application;
    }

    @Provides
    @Singleton
    UserSystem provideUserSystem() {
        return new UserSystem();
    }

    @Provides
    @Singleton
    ThreadExecutor provideThreadExecutor(JobExecutor jobExecutor) {
        return jobExecutor;
    }

    @Provides
    @Singleton
    PostExecutionThread providePostExecutionThread(UIThread uiThread) {
        return uiThread;
    }

    @Provides
    @Singleton
    MrService provideMrService() {
        return new MrService();
    }

    @Provides
    @Singleton
    UserCache provideUserCache(UserCacheImpl userCache) {
        return userCache;
    }
}
</code></pre>
<p>然后在module_archives模块中会有ArchivesDataRepositoryModule和ArchivesActivityModule<br />
其中KnowledgeDataRepositoryModule用于提供如下：</p>
<pre class="line-numbers"><code class="language-java">@Module
public class ArchivesDataRepositoryModule {

    @Provides
    @Singleton
    ArchivesApi providesArchivesApi(MrService mrService) {
        return mrService.createApi(ArchivesApi.class);
    }

    @Provides
    @Singleton
    ArchivesRepository prvidesArchivesRepository(ArchivesDataRepository archivesDataRepository) {
        return archivesDataRepository;
    }
}
</code></pre>
<p>ArchivesActivityModule的代码如下：</p>
<pre class="line-numbers"><code class="language-java">@Module
public abstract class ArchivesActivityModule {
   @PerActivity
   @ContributesAndroidInjector()
   abstract ArchivesActivity contributeArchivesActivity();
}
</code></pre>
<p>这样在主app的AppComponent类中加入：</p>
<pre class="line-numbers"><code class="language-java">@Singleton
@Component(modules = {
       AndroidInjectionModule.class, ApplicationModule.class,
       ArchivesDataRepositoryModule.class, ArchivesActivityModule.class,
       KnowledgeDataRepositoryModule.class, KnowledgeActivityModule.class
})
public interface AppComponent {
   @Component.Builder
   interface Builder {
       @BindsInstance
       Builder application(Application application);
       AppComponent build();
   }
   void inject(MrApplication mrApplication);
}
</code></pre>
<p>在module_archives为debug模式下也会有个AppComponent</p>
<pre class="line-numbers"><code class="language-java">@Singleton
@Component(modules = {
        AndroidInjectionModule.class, ApplicationModule.class,
        ArchivesDataRepositoryModule.class, ArchivesActivityModule.class
})
public interface AppComponent {
    @Component.Builder
    interface Builder {
        @BindsInstance
        Builder application(Application application);
        AppComponent build();
    }
    void inject(ArchivesApplication mrApplication);
}
</code></pre>
<p>各种模块初始化api和Repository，你要是嫌弃每个模块都要引入两个.class文件，你可以使用一个然后采用include的方式好比dagger中的AndroidSupportInjectionModule类方式</p>
<pre class="line-numbers"><code class="language-java">@Beta
@Module(includes = AndroidInjectionModule.class)
public abstract class AndroidSupportInjectionModule {
  @Multibinds
  abstract Map&lt;Class&lt;? extends Fragment&gt;, AndroidInjector.Factory&lt;? extends Fragment&gt;&gt;
      supportFragmentInjectorFactories();

  private AndroidSupportInjectionModule() {}
}
</code></pre>
<p>这样就会很清楚的知道自己模块需要初始化什么和使用什么，也不用考虑其它模块的初始化的数据，之后只需要在主app加入就行，也是比较方便的。</p>
<h2><a id="%E6%89%93%E5%8C%85" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>打包</h2>
<p>各种模块当为library是要打包成aar的，maven-release-kline-aar.gradle文件代码如下:</p>
<pre class="line-numbers"><code class="language-java">apply plugin: 'maven'

ext {// ext is a gradle closure allowing the declaration of global properties
    PUBLISH_GROUP_ID = 'com.wkw'
    PUBLISH_ARTIFACT_ID = 'archives'
    PUBLISH_VERSION = rootProject.ext.versionName
}

uploadArchives {
    repositories.mavenDeployer {
        //这里就是最后输出地址，在自己电脑上新建个文件夹，把文件夹路径粘贴在此
        //注意”file://“ + 路径，有三个斜杠，别漏了
        repository(url: &quot;file:///Users/wukewei/Documents/android/ModularizationExample/repo&quot;)

        pom.project {
            groupId project.PUBLISH_GROUP_ID
            artifactId project.PUBLISH_ARTIFACT_ID
            version project.PUBLISH_VERSION
        }
    }
}

//以下代码会生成jar包源文件，如果是不开源码，请不要输入这段
//aar包内包含注释
task androidSourcesJar(type: Jar) {
    classifier = 'sources'
    from android.sourceSets.main.java.sourceFiles
}

artifacts {
    archives androidSourcesJar
}
</code></pre>
<p>我只是打包到本地，你可以自己建立一个本地maven库。</p>

                        
                      </div>
                  </div>
                </a>
                <div class="read-more clearfix">
                  <div class="more-left left">
                  
                    <span class="date">2017/08/24</span>
                    <span>posted in&nbsp;</span> 
          				  
          					    <span class="posted-in"><a href='Android.html'>Android</a></span>
          				   
                    

                  </div>
                  <div class="more-right right">
                  <span class="comments">
                      

                       
                  </span>
                  </div>
                </div>
              </div><!-- article -->
        
			<div class="article">
                <a class="clearlink" href="15561207870604.html">
                
                  <h1>Android-自定义皮肤</h1>
                  <div class="a-content">
                      
                      <div class="a-content-text">
                        
                        	<h2><a id="%E8%87%AA%E5%AE%9A%E4%B9%89style%E5%92%8Ctheme" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>自定义Style和Theme</h2>
<p>  Style和Theme主要用来实现白天模式和夜间模式。<br />
  一个Style是一系列属性的集合，用来指定View或者Window的外观和格式。它可以指定的属性包括高度, Padding, 文字颜色，文字尺寸，背景颜色等等。<br />
  Style是在Xml资源文件中定义的，比如：</p>
<pre class="line-numbers"><code class="language-xml">&lt;style name=&quot;ListItemTitleStyle&quot; parent=&quot;TextAppearance.AppCompat.Body1&quot;&gt;
    &lt;item name=&quot;android:singleLine&quot;&gt;true&lt;/item&gt;
    &lt;item name=&quot;android:ellipsize&quot;&gt;end&lt;/item&gt;
    &lt;item name=&quot;android:textColor&quot;&gt;?android:attr/textColorPrimary&lt;/item&gt;
&lt;/style&gt;
</code></pre>
<p>  在布局文件中是这样使用的：</p>
<pre class="line-numbers"><code class="language-xml">&lt;TextView
    android:id=&quot;@+id/text_item_title&quot;
    android:layout_width=&quot;match_parent&quot;
    android:layout_height=&quot;wrap_content&quot;
    style=&quot;@style/ListItemTitleStyle&quot; /&gt;
</code></pre>
<p>  这样一个Style就可以运用在多个地方，既可以统一样式，又可以减少代码量。<br />
  而Theme，其实就是一个Style，不同于我们上面提到对单一View的应用，Theme是应用于整个Activity或Application的。各位Android开发同学一定不陌生，在Manifest的Activity声明中就会经常看到。</p>
<pre class="line-numbers"><code class="language-java">&lt;activity android:theme=&quot;@style/AppLightTheme.NoActionBar&quot;/&gt;
</code></pre>
<p>  这样，AppLightTheme.NoActionBar中的所有属性都会应用在整个Activity中。</p>
<p>  轻听这里，实现夜间模式分三步：</p>
<ul>
<li>自定义Style</li>
<li>应用Style中的属性</li>
<li>设置Theme</li>
</ul>
<h2><a id="%E8%87%AA%E5%AE%9A%E4%B9%89style" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>自定义Style</h2>
<p>  我们这里，就是写两个Style ，然后各自有一套对应的颜色值。<br />
  简单介绍一下几个主要的颜色值：</p>
<ul>
<li>colorPrimary: 主题色</li>
<li>colorAccent: 辅助色（或强调色）</li>
<li>textColorPrimary: 主要的文字颜色，一般TextView的文字都是这个颜色</li>
<li>textColorSecondary: 辅助的文字颜色，一般比textColorPrimary的颜色弱一点，用于一些弱化的表示</li>
<li>windowBackground: Window的背景色<br />
  <br />
  我们在资源文件中写对应的两套Style:</li>
</ul>
<pre class="line-numbers"><code class="language-xml">&lt;style name=&quot;AppLightTheme&quot; parent=&quot;Theme.AppCompat.Light.DarkActionBar&quot;&gt;
    &lt;item name=&quot;colorPrimary&quot;&gt;@color/colorPrimary&lt;/item&gt;
    &lt;item name=&quot;colorAccent&quot;&gt;@color/colorAccent&lt;/item&gt;
    &lt;item name=&quot;android:textColorPrimary&quot;&gt;@color/colorPrimaryTextBlack&lt;/item&gt;
    &lt;item name=&quot;android:textColorSecondary&quot;&gt;@color/colorSubTextBlack&lt;/item&gt;
    &lt;item name=&quot;android:windowBackground&quot;&gt;@color/white&lt;/item&gt;
&lt;/style&gt;

&lt;style name=&quot;AppDarkTheme&quot; parent=&quot;Theme.AppCompat.DayNight.DarkActionBar&quot;&gt;
    &lt;item name=&quot;colorPrimary&quot;&gt;@color/darkColorPrimary&lt;/item&gt;
    &lt;item name=&quot;colorAccent&quot;&gt;@color/darkColorAccent&lt;/item&gt;
    &lt;item name=&quot;android:textColorPrimary&quot;&gt;@color/white&lt;/item&gt;
    &lt;item name=&quot;android:textColorSecondary&quot;&gt;@color/colorSubTextWhite&lt;/item&gt;
    &lt;item name=&quot;android:windowBackground&quot;&gt;@color/dark_bg&lt;/item&gt;
&lt;/style&gt;
</code></pre>
<p>  细心的同学会发现，Style里的属性，有的前面会以“android:”开头，如<code>android:textColorPrimary</code>，有的则没有，如<code>colorPrimary</code>。<br />
  以“android:”开头的属性，是系统的属性。而另一种属于自定义的属性，在资源文件中声明如下：</p>
<pre class="line-numbers"><code class="language-xml">&lt;attr name=&quot;minibar_background&quot; format=&quot;color&quot; /&gt;
</code></pre>
<p>  format包括boolean, color, dimension, enum, flag, float, fraction, integer, reference, string。 在此就不赘述了，这是它们的一个相当灵活的使用方式。</p>
<h2><a id="%E5%BA%94%E7%94%A8style%E4%B8%AD%E7%9A%84%E5%B1%9E%E6%80%A7" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>应用Style中的属性</h2>
<p>  比如，colorAccent是在design包中定义的，属于自定义属性，在使用的时候，直接“?attr/”+属性名就可以了。</p>
<pre class="line-numbers"><code class="language-xml">&lt;ImageView
    android:tint=&quot;?attr/colorAccent&quot; /&gt;
</code></pre>
<p>  系统属性要多加一个”android:”, 是”?android:attr/“+属性名。</p>
<pre class="line-numbers"><code class="language-xml">&lt;TextView
    android:textColor=&quot;?android:attr/textColorPrimary&quot;/&gt;
</code></pre>
<p>  这样，当指定了Theme之后，就会去相应的Style下面取对应的颜色值，从而呈现出不同的色彩。</p>
<h2><a id="%E8%AE%BE%E7%BD%AEtheme" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>设置Theme</h2>
<p>  在Manifest中设置是常见的方式。</p>
<p><code>&lt;activity android:theme=&quot;@style/AppLightTheme.NoActionBar&quot;/&gt;</code></p>
<p>  不过为了实现模式的切换，我们是在Activity的onCreate中进行的设置</p>
<pre class="line-numbers"><code class="language-java">protected void initTheme() {
    if (MusicPreferences.getInstance().isNightMode()) {
        setTheme(R.style.AppDarkTheme_NoActionBar);
    } else {
        setTheme(R.style.AppLightTheme_NoActionBar);
    }
}
</code></pre>
<p>  这样，通过给Activity设置不同的Theme，页面就能呈现出不同的颜色搭配。</p>
<h2><a id="%E9%97%AE%E9%A2%98" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>问题</h2>
<p>  Style和Theme的方式实现简单，非常适用于模式较为固定的场景，如白天模式和夜间模式。<br />
  但是，轻听在白天的模式的时候的基础之上还有几种不同的主题色。</p>
<p>  简单聊一下主题色。<br />
  主题色，即colorPrimary，是根据品牌形象，为App定义的一个主色调，一般应用于AppBar。<br />
  同时，有一个强调色，即colorAccent，是用在Checkbox或下划线等需要给人以提示作用的地方，起辅助的作用。<br />
  还有一个颜色是colorPrimaryDark，就是比colorPrimary稍微深一些，主要用在状态栏。</p>
<p><figure><img src="media/15561207870604/15713321794597.png" alt="" /></figure></p>
<p>  比如上图中，“蓝色”就是主题色，“红”色就是强调色。<br />
  主题色和强调色的色值可以不一样，也可以一样。在一般的设计中都是不同的。在轻听的设计中，为了突出品牌色，将强调色跟主题色统一设计成了一个颜色，所以你会看到，到处都是“绿”色。</p>
<p><figure><img src="media/15561207870604/15713321901070.png" alt="" /></figure></p>
<p>  在强调色跟主题色统一的情况下，6个主题色，6套Style，似乎还可以接受。<br />
  但是，万一以后设计同学良心发现了呢？6在6套主题色的基础之上再出6套强调色，那可就是36个Style。如果以后的调色方式再更为灵活，如：</p>
<p><figure><img src="media/15561207870604/15713321976614.png" alt="" /></figure></p>
<p>  我数学不好，谁帮我算算，别忘了加上强调色还得再平方一下……<br />
  如果给每一个主题色都写一套Style，工作量会很大，而且不灵活。这个时候Style就玩不转了。<br />
  我们需要一种更为灵活的方案。</p>
<h2><a id="%E5%8A%A8%E6%80%81%E9%85%8D%E7%BD%AE%E4%B8%BB%E9%A2%98%E8%89%B2" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>动态配置主题色</h2>
<p>  动态配置主题色是借鉴了github开源控件app-theme-engine。在gradle中引入方式是:</p>
<pre class="line-numbers"><code class="language-plain_text">compile('com.github.naman14:app-theme-engine:0.5.1@aar') {
    transitive = true
}
</code></pre>
<p>  由于找不到这个项目维护的地址，所以我们自己进行了扩展和优化。<br />
  主要由三个模块组成</p>
<ul>
<li>颜色配置</li>
<li>颜色处理器</li>
<li>遍历逻辑控制器</li>
</ul>
<h2><a id="%E9%A2%9C%E8%89%B2%E9%85%8D%E7%BD%AE" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>颜色配置</h2>
<p>  颜色配置主要负责存储颜色值。<br />
  因为这里存储数据较小，而且简单，所以用SharedPreference来存储，稍加封装就可以。</p>
<h2><a id="%E9%A2%9C%E8%89%B2%E5%A4%84%E7%90%86%E5%99%A8" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>颜色处理器</h2>
<p>  颜色处理器Processor主要负责对每一个View的各种颜色进行设置。<br />
  首先，定义一个接口</p>
<pre class="line-numbers"><code class="language-java">public interface Processor&lt;T extends View, E&gt; {
    void process(@NonNull Context context, @Nullable String key, @Nullable T target, @Nullable E extra);
}
</code></pre>
<p>  process方法就是来处理视图颜色的。<br />
  其中target就是要传入的视图，这里使用泛型，在各个派生的Processor中具体实现。<br />
  以下是几个主要的Processor。</p>
<p><figure><img src="media/15561207870604/15713322118808.png" alt="" /></figure></p>
<p>  其中DefaultProcessor是默认Processor，可以处理绝大部分的变色情况。其他几种，如他们的名字一样，会额外再处理他们特定的情况。</p>
<p>Processor的处理方式分三步：</p>
<ul>
<li>给View设置tag</li>
<li>解析View的tag</li>
<li>根据具体的tag进行颜色的设置<br />
  <br />
  以DefaultProcessor为例。有一个TextView，我们要使他的文字颜色为强调色。<br />
  首先，给View设置一个tag，”text_accent_color”。如果有多个tag，以逗号分隔。</li>
</ul>
<pre class="line-numbers"><code class="language-xml">&lt;TextView
    android:tag=&quot;text_accent_color&quot;
    /&gt;
</code></pre>
<p>  然后在process方法中将tag解析出来</p>
<pre class="line-numbers"><code class="language-java">public void process(@NonNull Context context, @Nullable String key, @Nullable View view, @Nullable Void extra) {
    if(view != null &amp;&amp; view.getTag() != null &amp;&amp; view.getTag() instanceof String) {
        String tag = (String)view.getTag();
        if(tag.contains(&quot;,&quot;)) {
            String[] splitTags = tag.split(&quot;,&quot;);
            int len = splitTags.length;

            for(int i = 0; i &lt; len; ++i) {
                String part = splitTags[i];
                processTagPart(context, view, part, key);
            }
        } else {
            processTagPart(context, view, tag, key);
        }

    }
}
</code></pre>
<p>  这里会根据分隔符（逗号）来对tag的数量进行解析，然后依次根据每个tag依次处理。<br />
  在处理方法processTagPart中，会找到”text_accent_color”相对应的处理逻辑</p>
<pre class="line-numbers"><code class="language-java">if (view instanceof  TextView) {
    ((TextView) view).setTextColor(Config.accentColor(context, key));
}
</code></pre>
<p>  Config.accentColor(context, key)的作用就是从颜色配置模块中读取当前的强调色。<br />
  其他一些稍微复杂一点的情况，则可以使用相对应的Processor去进行特殊的处理。<br />
  例如，ViewPagerProcessor。ViewPager在滑动边界的时候会有一个边界反馈的效果，如下图：</p>
<p><figure><img src="media/15561207870604/15713322239841.png" alt="" /></figure></p>
<p>  这里需要特殊处理一下。ViewPager中，负责两个边缘效果的是EdgeEffectCompat。</p>
<pre class="line-numbers"><code class="language-java">private EdgeEffectCompat mLeftEdge;
private EdgeEffectCompat mRightEdge;
  EdgeEffectCompat是一个对系统版本做兼容性处理的类，里面有真正的边缘效果模块EdgeEffect

public final class EdgeEffectCompat {
    private Object mEdgeEffect;
}
</code></pre>
<p>  注意到，这两处都是私有的，所以我们必须通过两次反射来获取EdgeEffect，然后更改颜色。<br />
  首先，通过反射获取ViewPager的左右EdgeEffectCompat。</p>
<pre class="line-numbers"><code class="language-java">public static void setEdgeGlowColor(@NonNull ViewPager viewPager, @ColorInt int color) {
    if(Build.VERSION.SDK_INT &gt;= 21) {
        try {
            Field edgeLeft = ViewPager.class.getDeclaredField(&quot;mLeftEdge&quot;);
            edgeLeft.setAccessible(true);
            Field edgeRight = ViewPager.class.getDeclaredField(&quot;mRightEdge&quot;);
            edgeRight.setAccessible(true);
            EdgeEffectCompat ee = (EdgeEffectCompat)edgeLeft.get(viewPager);
            if (ee != null) {
                setEdgeGlowColor(ee, color);
            }
            ee = (EdgeEffectCompat)edgeRight.get(viewPager);
            if (ee != null) {
                setEdgeGlowColor(ee, color);
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
</code></pre>
<p>  然后再获取真正的EdgeEffect，并更改颜色。</p>
<pre class="line-numbers"><code class="language-java">private static void setEdgeGlowColor(@NonNull EdgeEffectCompat edgeEffect, @ColorInt int color) throws Exception {
    if(Build.VERSION.SDK_INT &gt;= 21) {
        Field field = EdgeEffectCompat.class.getDeclaredField(&quot;mEdgeEffect&quot;);
        field.setAccessible(true);
        EdgeEffect effect = (EdgeEffect) field.get(edgeEffect);
        if (effect != null) {
            effect.setColor(color);
        }
    }
}
</code></pre>
<p>  这样边缘效果的颜色就修改好啦。</p>
<h2><a id="%E9%81%8D%E5%8E%86%E9%80%BB%E8%BE%91" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>遍历逻辑</h2>
<p>  遍历逻辑控制器主要负责对整个页面的所有View进行遍历，并进行颜色处理。<br />
  以下是遍历逻辑：</p>
<p><figure><img src="media/15561207870604/15713322369276.png" alt="" /></figure></p>
<ul>
<li>初始化Processor</li>
</ul>
<pre class="line-numbers"><code class="language-java">private static void initProcessors() {
    mProcessors = new HashMap();
    mProcessors.put(&quot;[default]&quot;, new DefaultProcessor());
    mProcessors.put(ScrollView.class.getName(), new MusicScrollViewProcessor());
    mProcessors.put(ListView.class.getName(), new MusicListViewProcessor());
    mProcessors.put(RecyclerView.class.getName(), new MusicRecyclerViewProcessor());
    mProcessors.put(Toolbar.class.getName(), new MusicToolbarProcessor());
    mProcessors.put(NavigationView.class.getName(), new MusicNavigationViewProcessor());
    mProcessors.put(TabLayout.class.getName(), new MusicTabLayoutProcessor());
    mProcessors.put(ViewPager.class.getName(), new MusicViewPagerProcessor());
}
</code></pre>
<p>  将各Processor实例化后存入HashMap，key为类名。</p>
<ul>
<li>
<p>开始刷新的时机是onStart，因为这个时候布局已经基本初始化完毕。我们会判断Activity之前是否start过，避免重复的进行处理。至于在此之后生成的布局，会单独对其进行一次刷新。</p>
</li>
<li>
<p>从流程图中可以看出，在处理ContentView之前，我们会单独处理几个特殊的布局。<br />
StatusBar是顶部状态栏，NavigationBar是底部导航栏，有时我们会希望让这两处也兼容主题色。<br />
  	如果用到ActionBar，也需要处理一下。不过MD的实现中，一般都是NoActionBar的，而用我们自己布局的ToolBar来代替。<br />
  	在有侧边栏的页面中，根布局一般都是DrawerLayout，在侧边栏滑出的时候，可以设置DrawerLayout的状态栏颜色。</p>
</li>
<li>
<p>找我们自己的根布局：ContentView<br />
ContentView就是我们用setContentView设置的布局，它上面还有ContentParent，DecorView，Window。<br />
  直接根据资源id找？不现实，因为每个Activity的ContentView资源id基本都不一样的。<br />
  这里采取一种迂回的方式，先找到ContentView的父布局ContentParent。<br />
  我们看setContentView的代码：</p>
</li>
</ul>
<pre class="line-numbers"><code class="language-java">@Override
public void setContentView(int resId) {
    ensureSubDecor();
    ViewGroup contentParent = (ViewGroup) mSubDecor.findViewById(android.R.id.content);
    contentParent.removeAllViews();
    LayoutInflater.from(mContext).inflate(resId, contentParent);
    mOriginalWindowCallback.onContentChanged();
}
</code></pre>
<p>  可以看到，实际上ContentParent的资源id是固定的：android.R.id.content。<br />
  系统会先把ContentParent的子视图清除，然后通过LayoutInflater的inflate方法将我们指定布局的视图解析出来并添加到ContentParent中。<br />
  那么我们就可以根据android.R.id.content先找到ContentParent，进而找到ContentView<br />
  </p>
<pre class="line-numbers"><code class="language-java">ViewGroup contentView = (ViewGroup) ((ViewGroup) activity.findViewById(android.R.id.content)).getChildAt(0);
</code></pre>
<ul>
<li>获取Processor</li>
</ul>
<p>  根据View的类名获取Processor</p>
<pre class="line-numbers"><code class="language-java">Processor processor = mProcessors.get(viewClass.getName());
if(processor != null) {
    return processor;
} else {
    Class current = viewClass;

    do {
        current = current.getSuperclass();
        if(current == null) {
            break;
        }

        processor = mProcessors.get(current.getName());
    } while(processor == null);

    if (processor == null) {
        mProcessors.get(&quot;[default]&quot;)
    }

    return processor;
}
</code></pre>
<p>  从HashMap中获取对应的Processor，如果找不到则根据父类的名字查找。找到之后就可以调用process方法进行处理。</p>
<ul>
<li>遍历</li>
</ul>
<p>  这里会从ContentView开始进行深度优先遍历，处理所有的视图。<br />
  有一些特殊的ViewGroup不需要遍历其子布局，例如TabLayout，因为其自己的方法已经满足绝大部分的情况。</p>
<h2><a id="%E7%BB%93%E8%AF%AD" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>结语</h2>
<p>  以上，就是两种变色方案的具体实现。</p>
<ul>
<li>自定义Style和Theme实现简单，整洁，适用于模式较为固定的场景。</li>
<li>动态配置主题色实现起来略微复杂，但是比较灵活，适用于主题色较多的场景。</li>
</ul>
<p>  将这两种方案结合，就实现了轻听的变色。</p>

                        
                      </div>
                  </div>
                </a>
                <div class="read-more clearfix">
                  <div class="more-left left">
                  
                    <span class="date">2017/08/23</span>
                    <span>posted in&nbsp;</span> 
          				  
          					    <span class="posted-in"><a href='Android.html'>Android</a></span>
          				   
                    

                  </div>
                  <div class="more-right right">
                  <span class="comments">
                      

                       
                  </span>
                  </div>
                </div>
              </div><!-- article -->
        
			<div class="article">
                <a class="clearlink" href="15561207870533.html">
                
                  <h1>Android-ImageView详细学习</h1>
                  <div class="a-content">
                      
                      <div class="a-content-text">
                        
                        	<h2><a id="scaletype" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>ScaleType</h2>
<ul>
<li>
<p><code>android:scaleType=&quot;center&quot;</code></p>
<ul>
<li>当图片大于ImageView的宽高：以图片的中心点和ImageView的中心点为基准，按照图片的原大小居中显示，不缩放，用ImageView的大小截取图片的居中部分。</li>
<li>当图片小于ImageView的宽高：直接居中显示该图片。</li>
</ul>
</li>
<li>
<p><code>android:scaleType=&quot;centerCrop&quot;</code></p>
<ul>
<li>当图片大于ImageView的宽高：以图片的中心点和ImageView的中心点为基准，按比例缩小图片，直到图片的宽高有一边等于ImageView的宽高，则对于另一边，图片的长度大于或等于ImageView的长度，最后用ImageView的大小居中截取该图片。</li>
<li>当图片小于ImageView的宽高：以图片的中心店和ImageView的中心点为基准，按比例扩大图片，直到图片的宽高大于或等于ImageView的宽高，并按ImageView的大小居中截取该图片。</li>
</ul>
</li>
<li>
<p><code>android:scaleType=&quot;centerInside&quot;</code></p>
<ul>
<li>当图片大于ImageView的宽高：以图片的中心和ImageView的中心点为基准，按比例缩小图片，使图片宽高等于或者小于ImagevView的宽高，直到将图片的内容完整居中显示。</li>
<li>当图片小于ImageView的宽高：直接居中显示该图片。</li>
</ul>
</li>
<li>
<p><code>android:scaleType=&quot;fitCenter&quot;</code></p>
<ul>
<li>表示把图片按比例扩大（缩小）到ImageView的宽度，居中显示。</li>
</ul>
</li>
<li>
<p><code>android:scaleType=&quot;fitStart&quot;</code></p>
<ul>
<li>表示把图片按比例扩大（缩小）到ImageView的宽度，在ImageView的上方显示。</li>
</ul>
</li>
<li>
<p><code>android:scaleType=&quot;fitEnd&quot;</code></p>
<ul>
<li>表示把图片按比例扩大（缩小）到ImageView的宽度，在ImageView的下方显示。</li>
</ul>
</li>
<li>
<p><code>android:scaleType=&quot;fitXY&quot;</code></p>
<ul>
<li>表示把图片按指定的大小在ImageView中显示，拉伸或收缩图片，不保持原比例，填满ImageView。</li>
</ul>
</li>
</ul>

                        
                      </div>
                  </div>
                </a>
                <div class="read-more clearfix">
                  <div class="more-left left">
                  
                    <span class="date">2017/08/17</span>
                    <span>posted in&nbsp;</span> 
          				  
          					    <span class="posted-in"><a href='Android.html'>Android</a></span>
          				   
                    

                  </div>
                  <div class="more-right right">
                  <span class="comments">
                      

                       
                  </span>
                  </div>
                </div>
              </div><!-- article -->
        
              


			<div class="row">
			  <div class="large-6 columns">
			  <p class="text-left" style="padding-top:25px;">
			   <a href="Android_13.html">&laquo; Prev Page</a>  
			  </p>
			  </div>
			  <div class="large-6 columns">
			<p class="text-right" style="padding-top:25px;">
			 <a href="Android_15.html">&raquo; Next Page</a> 
			</p>
			  </div>
			</div>
		</div>
	</div><!-- large 8 -->

 <div class="large-4 medium-4 columns">
  <div class="hide-for-small">
    <div id="sidebar" class="sidebar">
          <div id="site-info" class="site-info">
            
                <div class="site-a-logo"><img src="media/16898402251241/logo.jpeg" /></div>
            
                <h1>MagicalRice的Blog</h1>
                <div class="site-des">技术博客</div>
                <div class="social">











  <a target="_blank" class="rss" href="atom.xml" title="RSS">RSS</a>
                
              	 </div>
          	</div>

             

              <div id="site-categories" class="side-item ">
                <div class="side-header">
                  <h2>Categories</h2>
                </div>
                <div class="side-content">

      	<p class="cat-list">
        
            <a href="Android.html"><strong>Android</strong></a>
        
            <a href="%E6%9C%8D%E5%8A%A1%E5%99%A8.html"><strong>服务器</strong></a>
        
            <a href="C++.html"><strong>C++</strong></a>
        
            <a href="UI.html"><strong>UI</strong></a>
        
            <a href="%E4%BB%A3%E7%A0%81%E4%B9%8B%E7%BE%8E.html"><strong>代码之美</strong></a>
        
            <a href="Game.html"><strong>Game</strong></a>
        
            <a href="Python.html"><strong>Python</strong></a>
        
            <a href="Mac.html"><strong>Mac</strong></a>
        
            <a href="%E5%85%B6%E4%BB%96.html"><strong>其他</strong></a>
        
            <a href="Flutter.html"><strong>Flutter</strong></a>
        
            <a href="ReactNative.html"><strong>ReactNative</strong></a>
        
            <a href="Java.html"><strong>Java</strong></a>
        
            <a href="%E9%9F%B3%E8%A7%86%E9%A2%91%E5%BC%80%E5%8F%91.html"><strong>音视频开发</strong></a>
        
            <a href="%E7%BD%91%E7%BB%9C.html"><strong>网络</strong></a>
        
            <a href="%E7%BD%91%E9%A1%B5.html"><strong>网页</strong></a>
        
            <a href="%E5%B7%A5%E5%85%B7-1-2.html"><strong>工具</strong></a>
        
            <a href="%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD.html"><strong>人工智能</strong></a>
        
            <a href="%E5%88%9B%E4%B8%9A.html"><strong>创业</strong></a>
        
            <a href="%E6%80%9D%E7%BB%B4%E6%8F%90%E5%8D%87.html"><strong>思维提升</strong></a>
        
            <a href="GPU%E6%B8%B2%E6%9F%93.html"><strong>GPU渲染</strong></a>
         
        </p>


                </div>
              </div>

              <div id="site-categories" class="side-item">
                <div class="side-header">
                  <h2>Recent Posts</h2>
                </div>
                <div class="side-content">
                <ul class="posts-list">
	      
		      
			      <li class="post">
			        <a href="16946950953153.html">Debian 关闭休眠</a>
			      </li>
		     
		  
		      
			      <li class="post">
			        <a href="16946000122919.html">Debian 查看 Linux 硬盘大小、类型和硬件信息</a>
			      </li>
		     
		  
		      
			      <li class="post">
			        <a href="16945997927114.html">Debian 查看硬件温度</a>
			      </li>
		     
		  
		      
			      <li class="post">
			        <a href="16945994928906.html">Debian 查看Linux版本</a>
			      </li>
		     
		  
		      
			      <li class="post">
			        <a href="16945989810086.html">Debian 查看CPU和内存</a>
			      </li>
		     
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		   
		  		</ul>
                </div>
              </div>
        </div><!-- sidebar -->
      </div><!-- hide for small -->
</div><!-- large 4 -->

</div><!-- row -->

 <div class="page-bottom clearfix">
  <div class="row">
   <p class="copyright">Copyright &copy; 2015
Powered by <a target="_blank" href="http://www.mweb.im">MWeb</a>,&nbsp; 
Theme used <a target="_blank" href="http://github.com">GitHub CSS</a>.</p>
  </div>
</div>

        </section>
      </div>
    </div>

<style>.mweb-charts{background:#fff;}
body{ box-sizing: border-box;
    margin: 0 auto;}
@media print{
    pre, code, pre code {
     overflow: visible !important;
     white-space: pre-wrap !important;       /* css-3 */
     white-space: -moz-pre-wrap !important;  /* Mozilla, since 1999 */
     white-space: -pre-wrap !important;      /* Opera 4-6 */
     white-space: -o-pre-wrap !important;    /* Opera 7 */
     word-wrap: break-word !important;       /* Internet Explorer 5.5+ */
    }
    html,body{margin:0;padding:4px;}
}



div.code-toolbar {
  position: relative;
}

div.code-toolbar > .toolbar {
  position: absolute;
  z-index: 10;
  top: .3em;
  right: .2em;
  transition: opacity 0.3s ease-in-out;
  opacity: 0;
}

div.code-toolbar:hover > .toolbar {
  opacity: 1;
}

/* Separate line b/c rules are thrown out if selector is invalid.
   IE11 and old Edge versions don't support :focus-within. */
div.code-toolbar:focus-within > .toolbar {
  opacity: 1;
}

div.code-toolbar > .toolbar > .toolbar-item {
  display: inline-block;
}

div.code-toolbar > .toolbar > .toolbar-item > a {
  cursor: pointer;
}

div.code-toolbar > .toolbar > .toolbar-item > button {
  background: none;
  border: 0;
  color: inherit;
  font: inherit;
  line-height: normal;
  overflow: visible;
  padding: 0;
  -webkit-user-select: none; /* for button */
  -moz-user-select: none;
  -ms-user-select: none;
}

div.code-toolbar > .toolbar > .toolbar-item > a,
div.code-toolbar > .toolbar > .toolbar-item > button,
div.code-toolbar > .toolbar > .toolbar-item > span {
  color: inherit;
  font-size: .8em;
  padding: 4px .5em;
  background: #f5f2f0;
  background: rgba(224, 224, 224, 0.4);
  box-shadow: 0 2px 0 0 rgba(0,0,0,0.2);
  border-radius: .5em;
}

div.code-toolbar > .toolbar > .toolbar-item > a:hover,
div.code-toolbar > .toolbar > .toolbar-item > a:focus,
div.code-toolbar > .toolbar > .toolbar-item > button:hover,
div.code-toolbar > .toolbar > .toolbar-item > button:focus,
div.code-toolbar > .toolbar > .toolbar-item > span:hover,
div.code-toolbar > .toolbar > .toolbar-item > span:focus {
  color: inherit;
  text-decoration: none;
}
</style><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/prism.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script><script>!function(){if("undefined"!=typeof Prism&&"undefined"!=typeof document){var e=[],t={},n=function(){};Prism.plugins.toolbar={};var a=Prism.plugins.toolbar.registerButton=function(n,a){var r;r="function"==typeof a?a:function(e){var t;return"function"==typeof a.onClick?((t=document.createElement("button")).type="button",t.addEventListener("click",(function(){a.onClick.call(this,e)}))):"string"==typeof a.url?(t=document.createElement("a")).href=a.url:t=document.createElement("span"),a.className&&t.classList.add(a.className),t.textContent=a.text,t},n in t?console.warn('There is a button with the key "'+n+'" registered already.'):e.push(t[n]=r)},r=Prism.plugins.toolbar.hook=function(a){var r=a.element.parentNode;var l=a.element.classList;if(l.contains('language-mermaid') || l.contains('language-echarts') || l.contains('language-plantuml')){return;} if(r&&/pre/i.test(r.nodeName)&&!r.parentNode.classList.contains("code-toolbar")){var o=document.createElement("div");o.classList.add("code-toolbar"),r.parentNode.insertBefore(o,r),o.appendChild(r);var i=document.createElement("div");i.classList.add("toolbar");var l=e,d=function(e){for(;e;){var t=e.getAttribute("data-toolbar-order");if(null!=t)return(t=t.trim()).length?t.split(/\s*,\s*/g):[];e=e.parentElement}}(a.element);d&&(l=d.map((function(e){return t[e]||n}))),l.forEach((function(e){var t=e(a);if(t){var n=document.createElement("div");n.classList.add("toolbar-item"),n.appendChild(t),i.appendChild(n)}})),o.appendChild(i)}};a("label",(function(e){var t=e.element.parentNode;if(t&&/pre/i.test(t.nodeName)&&t.hasAttribute("data-label")){var n,a,r=t.getAttribute("data-label");try{a=document.querySelector("template#"+r)}catch(e){}return a?n=a.content:(t.hasAttribute("data-url")?(n=document.createElement("a")).href=t.getAttribute("data-url"):n=document.createElement("span"),n.textContent=r),n}})),Prism.hooks.add("complete",r)}}();</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/toolbar/prism-toolbar.min.css"><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script><style>div.code-toolbar > .toolbar > .toolbar-item > a, div.code-toolbar > .toolbar > .toolbar-item > button, div.code-toolbar > .toolbar > .toolbar-item > span {padding: 4px .5em; background: #f5f2f0; background: rgba(224, 224, 224, 0.4);}</style>

<style type="text/css">
figure{margin: 0;padding: 0;}
figcaption{text-align:center;}

/* PrismJS 1.14.0
 http://prismjs.com/download.html#themes=prism&languages=markup+css+clike+javascript */
/**
 * prism.js default theme for JavaScript, CSS and HTML
 * Based on dabblet (http://dabblet.com)
 * @author Lea Verou
 */

code[class*="language-"],
pre[class*="language-"] {
    color: black;
    background: none;
    text-shadow: 0 1px white;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;
    
    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;
    
    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
}

pre[class*="language-"]::-moz-selection, pre[class*="language-"] ::-moz-selection,
code[class*="language-"]::-moz-selection, code[class*="language-"] ::-moz-selection {
    text-shadow: none;
    background:#b3d4fc;
}

pre[class*="language-"]::selection, pre[class*="language-"] ::selection,
code[class*="language-"]::selection, code[class*="language-"] ::selection {
    text-shadow: none;
    background: #b3d4fc;
}

@media print {
    code[class*="language-"],
    pre[class*="language-"] {
        text-shadow: none;
    }
}

/* Code blocks */
pre[class*="language-"] {
    padding: 1em;
    margin: .5em 0;
    overflow: auto;
}

:not(pre) > code[class*="language-"],
pre[class*="language-"] {
    background: #F7F7F7;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
    padding: .1em;
    border-radius: .3em;
    white-space: normal;
}

.token.comment,
.token.prolog,
.token.doctype,
.token.cdata {
    color: slategray;
}

.token.punctuation {
    color: #999;
}

.namespace {
    opacity: .7;
}

.token.property,
.token.tag,
.token.boolean,
.token.number,
.token.constant,
.token.symbol,
.token.deleted {
    color: #905;
}

.token.selector,
.token.attr-name,
.token.string,
.token.char,
.token.builtin,
.token.inserted {
    color: #690;
}

.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string {
    color: #9a6e3a;
    background: hsla(0, 0%, 100%, .5);
}

.token.atrule,
.token.attr-value,
.token.keyword {
    color: #07a;
}

.token.function,
.token.class-name {
    color: #DD4A68;
}

.token.regex,
.token.important,
.token.variable {
    color: #e90;
}

.token.important,
.token.bold {
    font-weight: bold;
}
.token.italic {
    font-style: italic;
}

.token.entity {
    cursor: help;
}


pre[class*="language-"].line-numbers {
    position: relative;
    padding-left: 3.8em;
    counter-reset: linenumber;
}

pre[class*="language-"].line-numbers > code {
    position: relative;
    white-space: inherit;
}

.line-numbers .line-numbers-rows {
    position: absolute;
    pointer-events: none;
    top: 0;
    font-size: 100%;
    left: -3.8em;
    width: 3em; /* works for line-numbers below 1000 lines */
    letter-spacing: -1px;
    border-right: 1px solid #999;

    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;

}

    .line-numbers-rows > span {
        pointer-events: none;
        display: block;
        counter-increment: linenumber;
    }

        .line-numbers-rows > span:before {
            content: counter(linenumber);
            color: #999;
            display: block;
            padding-right: 0.8em;
            text-align: right;
        }

</style>

  
    

    <script src="asset/js/foundation.min.js"></script>
    <script>
      $(document).foundation();
      function fixSidebarHeight(){
        var w1 = $('.markdown-body').height();
          var w2 = $('#sidebar').height();
          if (w1 > w2) { $('#sidebar').height(w1); };
      }
      $(function(){
        fixSidebarHeight();
      })
      $(window).load(function(){
          fixSidebarHeight();
      });
     
    </script>



  </body>
</html>
