<!doctype html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
    
  学习ConstraintLayout - MagicalRice的Blog
  
  </title>
  
  
  <link href="atom.xml" rel="alternate" title="MagicalRice的Blog" type="application/atom+xml">
    <link rel="stylesheet" href="asset/css/foundation.min.css" />
    <link rel="stylesheet" href="asset/css/docs.css" />
    <script src="asset/js/vendor/modernizr.js"></script>
    <script src="asset/js/vendor/jquery.js"></script>
  <script src="asset/highlightjs/highlight.pack.js"></script>
  <link href="asset/highlightjs/styles/github.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script>hljs.initHighlightingOnLoad();</script>
<script type="text/javascript">
  function before_search(){
    var searchVal = 'site:adolph.cc ' + document.getElementById('search_input').value;
    document.getElementById('search_q').value = searchVal;
    return true;
  }
</script>
  </head>
  <body class="antialiased hide-extras">
    
    <div class="marketing off-canvas-wrap" data-offcanvas>
      <div class="inner-wrap">


<nav class="top-bar docs-bar hide-for-small" data-topbar>


  <section class="top-bar-section">
  <div class="row">
      <div style="position: relative;width:100%;"><div style="position: absolute; width:100%;">
        <ul id="main-menu" class="left">
        
        <li id=""><a target="self" href="index.html">Home</a></li>
        
        <li id=""><a target="_self" href="archives.html">Archives</a></li>
        
        </ul>

        <ul class="right" id="search-wrap">
          <li>
<form target="_blank" onsubmit="return before_search();" action="https://google.com/search" method="get">
    <input type="hidden" id="search_q" name="q" value="" />
    <input tabindex="1" type="search" id="search_input"  placeholder="Search"/>
</form>
</li>
          </ul>
      </div></div>
  </div>
  </section>

</nav>

        <nav class="tab-bar show-for-small">
  <a href="javascript:void(0)" class="left-off-canvas-toggle menu-icon">
    <span> &nbsp; MagicalRice的Blog</span>
  </a>
</nav>

<aside class="left-off-canvas-menu">
      <ul class="off-canvas-list">
        
        <li><a target="self" href="index.html">Home</a></li>
        
        <li><a target="_self" href="archives.html">Archives</a></li>
        

    <li><label>Categories</label></li>

        
            <li><a href="Android.html">Android</a></li>
        
            <li><a href="%E6%9C%8D%E5%8A%A1%E5%99%A8.html">服务器</a></li>
        
            <li><a href="C++.html">C++</a></li>
        
            <li><a href="UI.html">UI</a></li>
        
            <li><a href="MySQL.html">MySQL</a></li>
        
            <li><a href="%E7%AE%97%E6%B3%95.html">算法</a></li>
        
            <li><a href="Game.html">Game</a></li>
        
            <li><a href="Python.html">Python</a></li>
        
            <li><a href="%E8%B7%A8%E5%B9%B3%E5%8F%B0%E5%BC%80%E5%8F%91.html">跨平台开发</a></li>
         

      </ul>
    </aside>

<a class="exit-off-canvas" href="#"></a>


        <section id="main-content" role="main" class="scroll-container">
        
       

 <script type="text/javascript">
  $(function(){
    $('#menu_item_index').addClass('is_active');
  });
</script>
<div class="row">
  <div class="large-8 medium-8 columns">
      <div class="markdown-body article-wrap">
       <div class="article">
          
          <h1>学习ConstraintLayout</h1>
     
        <div class="read-more clearfix">
          <span class="date">2019/10/18</span>

          <span>posted in&nbsp;</span> 
          
              <span class="posted-in"><a href='Android.html'>Android</a></span>
           
         
          <span class="comments">
            

            
          </span>

        </div>
      </div><!-- article -->

      <div class="article-content">
      <h2 id="toc_0">ConstraintLayout简介</h2>

<p>ConstraintLayout作为一款可以灵活调整view位置和大小的Viewgroup被Google疯狂推荐，以前创建布局，默认根元素都是LinearLayout,现在是ConstraintLayout了。ConstraintLayout能够以支持库的形式最小支持到API 9，同时也在不断的丰富ConstraintLayout的API和功能。ConstraintLayout在复杂布局中能够有效的，降低布局的层级，提高性能，使用更加灵活。</p>

<span id="more"></span><!-- more -->

<h2 id="toc_1">适用场合</h2>

<h3 id="toc_2">追求更高的性能</h3>

<p>ConstraintLayout 可以有效减少布局的嵌套。绘制过程中的每个阶段都需要对视图树执行一次自顶向下的遍历操作。视图层次结构中嵌套的视图越多，设备绘制视图所需的时间和计算功耗也就越多。</p>

<h3 id="toc_3">实现动画</h3>

<p>使用ConstraintLayout可以更加简单实现复杂的动画。</p>

<h2 id="toc_4">属性分类</h2>

<p>ConstraintLayout 目前有 57个属性（还在迭代），相比 LinearLayout 和 RelativeLayout 的学习成本是徒增的，在没有了解他们的属性前，看起来是非常的复杂。由于属性太多，这里把他们分类几类，这样理解起来就简单很多了。</p>

<ol>
<li>位置约束 layout_constraintXX_toYYOf（13个）</li>
<li>layout_constraintXX_creator（5个，无意义参数）</li>
<li>layout_goneMarginXX（6个）</li>
<li>大小约束 layout_constraint[ Width | Height ]_**（10个）</li>
<li>宽高比例约束 layout_constraintDimensionRatio</li>
<li>layout_constraintCircle**（3个）</li>
<li>绝对位置（2个）</li>
<li>参照物 Guideline 组件（3个）</li>
<li>屏障 Barrier 组件（2个）</li>
<li>Group 组件（和Barrier共享1个）</li>
<li>占位符 Placeholder （1个）</li>
<li>其他属性</li>
</ol>

<h3 id="toc_5">位置约束 layout_constraintXX_toYYOf（13个）</h3>

<p><strong>参数类型</strong>：<code>reference</code>|<code>enum</code>，这几个参数可以写@+id/xxx，也可以写<code>parent</code>，所以可以相对其他控件，也可以相对父控件。</p>

<p>这种属性是有规则的，每一个边缘都有2个，还有一个特殊的<code>Baseline_toBaselineOf</code>，是用于定位该控件相对其他控件的位置。如果仅仅使用这类属性布局，1个控件必须设置（左或右）和（上或下）2个属性，否则会提示异常。</p>

<ol>
<li>Left_toLeftOf</li>
<li>Left_toRightOf</li>
<li>Right_toRightOf</li>
<li>Right_toLeftOf</li>
<li>Top_toTopOf</li>
<li>Top_toBottomOf</li>
<li>Bottom_toBottomOf</li>
<li>Bottom_toTopOf</li>
<li>Start_toStartOf（适配right-to-left布局）</li>
<li>Start_toEndOf（适配right-to-left布局）</li>
<li>End_toEndOf（适配right-to-left布局）</li>
<li>End_toStartOf（适配right-to-left布局）</li>
<li>Baseline_toBaselineOf</li>
</ol>

<p><figure><img src="media/15713923056028/15717110750245.jpg" alt=""/></figure></p>

<h3 id="toc_6">layout_constraintXX_creator（5个，无意义参数）</h3>

<ol>
<li>layout_constraintBaseline_creator</li>
<li>layout_constraintLeft_creator</li>
<li>layout_constraintRight_creator</li>
<li>layout_constraintTop_creator</li>
<li>layout_constraintBottom_creator</li>
</ol>

<p>从源码可以看到，这几个参数是没有任何的处理，应该是可视化编辑器使用的，我们不用管这几个参数。</p>

<h3 id="toc_7">layout_goneMarginXX（6个）</h3>

<p>当参照物为<code>gone</code>时候生效。</p>

<ol>
<li>layout_goneMarginBottom</li>
<li>layout_goneMarginEnd</li>
<li>layout_goneMarginLeft</li>
<li>layout_goneMarginRight</li>
<li>layout_goneMarginStart</li>
<li>layout_goneMarginTop</li>
</ol>

<p>下面的例子，两个布局方式的代码是一样的，都设置了<code>app:layout_goneMarginLeft=&quot;100dp&quot;</code>和<code>app:layout_goneMarginTop=&quot;100dp&quot;</code>，绿色的布局仅仅把button1隐藏，设置了两个属性就生效了，这几个属性和 ViewGroup <code>layout_marginLeft</code>的效果类似，不同的是参照物设置<code>android:visibility=&quot;gone&quot;</code>时候才会生效。</p>

<p><figure><img src="media/15713923056028/15717113665128.jpg" alt=""/></figure></p>

<h3 id="toc_8">大小约束 layout_constraint[ Width | Height ]_**（10个）</h3>

<p>在约束布局中宽高的维度 match_parent 被 0dp 代替，默认生成的大小占所有的可用空间。那么有以下几个属性可以使用：</p>

<ol>
<li>layout_constraintWidth_max（dimension|enum：wrap=-2）</li>
<li>layout_constraintWidth_min（dimension|enum：wrap=-2）</li>
<li>layout_constraintHeight_max（dimension|enum：wrap=-2）</li>
<li>layout_constraintHeight_min（dimension|enum：wrap=-2）</li>
<li>layout_constraintWidth_percent（float）</li>
<li>layout_constraintHeight_percent（float）</li>
<li>layout_constrainedHeight（boolean）</li>
<li>layout_constrainedWidth（boolean）</li>
<li>layout_constraintHeight_default（enum：spread, wrap, percent）</li>
<li>layout_constraintWidth_default（enum：spread, wrap, percent）</li>
</ol>

<p>XX_max 设置最大尺寸，XX_min 设置最小尺寸，XX_percent 置相对于父类的百分比。</p>

<p><figure><img src="media/15713923056028/15717114510491.jpg" alt=""/></figure></p>

<h4 id="toc_9">layout_constraintHeight_default、layout_constraintWidth_default</h4>

<ol>
<li>spread：从源代码中看到默认就是spread，实际效果分析，应该等价于android:layout_width=&quot;wrap_content&quot;。</li>
<li>wrap：等价 android:layout_width=&quot;wrap_content&quot;（已被弃用）</li>
<li>percent：等价 app:layout_constraintWidth_percent=&quot;1&quot;</li>
</ol>

<h4 id="toc_10">layout_constrainedWidth、layout_constrainedHeight</h4>

<p>上下两个布局的差别仅仅只是app:layout_constrainedWidth=&quot;false&quot;，下面的true，当width=&quot;wrap_content&quot;，如果实际宽度超过了约束的最大宽度，那么约束会失效（高同理），为了防止约束失效，增加了该属性。</p>

<p><figure><img src="media/15713923056028/15717115463030.jpg" alt=""/></figure></p>

<h3 id="toc_11">layout_constraint[Horizontal | Vertical]_**（6个）</h3>

<ol>
<li>layout_constraintHorizontal_bias（float）</li>
<li>layout_constraintHorizontal_chainStyle（enum：spread, spread_inside, packed）</li>
<li>layout_constraintHorizontal_weight（float）</li>
<li>layout_constraintVertical_bias（float）</li>
<li>layout_constraintVertical_chainStyle（enum：spread, spread_inside, packed）</li>
<li>layout_constraintVertical_weight（float）</li>
</ol>

<p>当一个控件左右都设置了约束，那么该控件距离左右的目标距离都是一样的，layout_constraintHorizontal_bias默认是0.5，当设置为0.8时候，左边的距离和右边的距离比例就变成了8：2。</p>

<h3 id="toc_12">宽高比例约束 layout_constraintDimensionRatio（1个）</h3>

<p>约束布局支持子控件设置宽高比，前提条件是至少需要将宽高中的一个设置为0dp。为了约束一个特定的边，基于另一个边的尺寸，可以预先附加W，或H以逗号隔开。</p>

<p>假设ImageView1是屏幕的宽度，希望ImageView1是以16:9的形式显示，但是在布局中无法写死Height，那么就可以给ImageView1设置<code>app:layout_constraintDimensionRatio=&quot;H,16:9&quot;</code>，神操作。设置宽度自适应比例也是同样的原理，<code>app:layout_constraintDimensionRatio=&quot;W,16:9&quot;</code>。</p>

<h3 id="toc_13">layout_constraintCircle**（3个）</h3>

<ol>
<li>layout_constraintCircle（reference）目标控件 ID</li>
<li>layout_constraintCircleAngle（integer）和目标控件的角度</li>
<li>layout_constraintCircleRadius（dimension）该控件中心 距离目标控件中心的距离。</li>
</ol>

<h3 id="toc_14">绝对位置（2个）</h3>

<p>在布局中的绝对位置，很少会用到。</p>

<ol>
<li>layout_editor_absoluteX（dimension）</li>
<li>layout_editor_absoluteY（dimension）</li>
</ol>

<h3 id="toc_15">参照物 Guideline 组件（3个）</h3>

<p><code>Guideline</code> 与 <code>LinearLayout</code> 类似可以设置水平或垂直方向，<code>android:orientation=&quot;horizontal&quot;</code>，<code>android:orientation=&quot;vertical&quot;</code>，水平方向高度为0，垂直方向宽度为0。我们可以创建一些横向的或者纵向的Guideline，在布局界面的时候可以充分利用这些辅助线，对齐我们的View，避免重复写一些marginXXX。</p>

<ol>
<li>layout_constraintGuide_begin（dimension）</li>
<li>layout_constraintGuide_end（dimension）</li>
<li>layout_constraintGuide_percent（float）</li>
<li>android:orientation（vertical、horizontal）</li>
</ol>

<h3 id="toc_16">屏障 Barrier 组件（2个）</h3>

<p>Barrier，直译为障碍、屏障。在约束布局中，可以使用属性<code>constraint_referenced_ids</code>属性来引用多个带约束的组件，从而将它们看作一个整体，Barrier 的介入可以完成很多其他布局不能完成的功能。</p>

<ol>
<li>constraint_referenced_ids</li>
<li>barrierDirection（left、right、top、bottom、start、end）</li>
</ol>

<h3 id="toc_17">Group 组件（共享1个）</h3>

<p>Group用于控制多个控件的可见性。</p>

<ol>
<li>constraint_referenced_ids（可以填写多个ID）</li>
</ol>

<h3 id="toc_18">占位符 Placeholder</h3>

<p>Placeholder中可设置另一个控件的id，使这个控件移动到占位符的位置。</p>

<ol>
<li>content（reference）</li>
</ol>

<h3 id="toc_19">其他属性</h3>

<ol>
<li>chainUseRtl（boolean）</li>
<li>constraintSet（reference）</li>
<li>emptyVisibility（gone, invisible）</li>
<li>layout_optimizationLevel（none, standard, direct, barrier, chains, dimensions, groups）</li>
</ol>

<h2 id="toc_20">实现</h2>

<h3 id="toc_21">相对定位</h3>

<p>相对定位，其实这跟RelativeLayout差不多,一个View相对另外一个View的位置。</p>

<p><figure><img src="media/15713923056028/15713925074100.jpg" alt=""/></figure></p>

<p>通过简单的使用ConstraintLayout的属性也就可以实现以上布局。World对于Hello的右边，GitCode对位于Hello的下边。</p>

<pre class="line-numbers"><code class="language-markup">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;android.support.constraint.ConstraintLayout     ...&gt;    &lt;TextView            ...            android:text=&quot;Hello&quot;            android:id=&quot;@+id/tvHello&quot;/&gt;    &lt;TextView            ...            android:text=&quot;World&quot;            app:layout_constraintLeft_toRightOf=&quot;@+id/tvHello&quot;/&gt;    &lt;TextView            ...            android:text=&quot;GitCode&quot;            app:layout_constraintTop_toBottomOf=&quot;@id/tvHello&quot;/&gt;&lt;/android.support.constraint.ConstraintLayout&gt;
&lt;android.support.constraint.ConstraintLayout 
    ...&gt;
    &lt;TextView
            ...
            android:text=&quot;Hello&quot;
            android:id=&quot;@+id/tvHello&quot;/&gt;

    &lt;TextView
            ...
            android:text=&quot;World&quot;
            app:layout_constraintLeft_toRightOf=&quot;@+id/tvHello&quot;/&gt;

    &lt;TextView
            ...
            android:text=&quot;GitCode&quot;
            app:layout_constraintTop_toBottomOf=&quot;@id/tvHello&quot;/&gt;
&lt;/android.support.constraint.ConstraintLayout&gt;
</code></pre>

<p>以TextView World相对位置属性layout_constraintLeft_toRightOf来说，constraintLeft表示TextView World本身的左边，一个View有四条边，因此TextView的上、右、下边分别对应着constraintTop、constraintRight、constraintBottom。toRightOf则表示位于另外一个View的右边，例如此处位于Hello的右边,因此对应还有toLeftOf、toRghtOf、toBottomOf,分别位于View Hello的左、右、下边。</p>

<p>总结的说，constraintXXX表示View自身约束的边，toXXXOf表示另一个View的边，而XXX的值可以是Left、Top、Right、Bottom，分别对应左，上、右、下边。layout_constraintStart_toEndOf也是类似的道理。</p>

<p>另外需要注意的是，view的位置可以相对于同层的view和parent,在相对于parent的时候toLeftOf、toTopOf、toRghtOf、toBottomOf分别表示位于parent的内部左上右下边缘。如图：红色框表示parent view。</p>

<p><figure><img src="media/15713923056028/15714063057370.jpg" alt=""/></figure></p>

<p>再来看看一个特殊的场景：</p>

<p><figure><img src="media/15713923056028/15714063103065.jpg" alt=""/></figure></p>

<p>此时想要Hello和World文本中间对齐怎么办？ConstraintLayout提供了layout_constraintBaseline_toBaselineOf属性。</p>

<pre class="line-numbers"><code class="language-text">&lt;TextView   
    ...    
    android:text=&quot;Hello&quot;    
    android:id=&quot;@+id/tvHello&quot;/&gt;
&lt;TextView    
    ...    
    android:text=&quot;World&quot;        
    app:layout_constraintBaseline_toBaselineOf=&quot;@id/tvHello&quot;    
    app:layout_constraintLeft_toRightOf=&quot;@+id/tvHello&quot;/&gt;

&lt;TextView
    ...
    android:text=&quot;World&quot;
    app:layout_constraintBaseline_toBaselineOf=&quot;@id/tvHello&quot;
    app:layout_constraintLeft_toRightOf=&quot;@+id/tvHello&quot;/&gt;
</code></pre>

<p>此时界面就如愿了，比Relativelayout方便多了。<br/>
<figure><img src="media/15713923056028/15714063990327.jpg" alt=""/></figure></p>

<p>什么是baseline？贴张官网的图</p>

<p><figure><img src="media/15713923056028/15714064123243.jpg" alt=""/></figure></p>

<h3 id="toc_22">边距</h3>

<p>边距与平常使用并无太大区别，但需要先确定view的位置，边距才会生效。如：</p>

<pre class="line-numbers"><code class="language-text">&lt;TextView        
    ...        
    android:layout_marginTop=&quot;10dp&quot;         
    android:layout_marginLeft=&quot;10dp&quot;/&gt;
</code></pre>

<p>在其他的ViewGroup,TextView的layout_marginTop和layout_marginLeft属性是会生效的，但在ConstraintLayout不会生效，因为此时TextView的位置还没确定。下面的代码才会生效。</p>

<pre class="line-numbers"><code class="language-text">&lt;TextView        
    ...        
    android:layout_marginTop=&quot;10dp&quot;        
    android:layout_marginLeft=&quot;10dp&quot;        
    app:layout_constraintLeft_toLeftOf=&quot;parent&quot;         
    app:layout_constraintTop_toTopOf=&quot;parent&quot;         /&gt;
</code></pre>

<p>常用属性如下：</p>

<p><strong>GONE Margin</strong></p>

<p>有时候，会有这种需求，在World可见的时候，GitCode与World的左边距是0，当World不见时，GitCode的左边距是某个特定的值。<br/>
World可见的效果，GitCode的左边距为0。</p>

<p><figure><img src="media/15713923056028/15714541657565.jpg" alt=""/></figure><br/>
World不可见的效果，GitCode的左边距为10<br/>
<figure><img src="media/15713923056028/15714541795713.jpg" alt=""/></figure><br/>
为此，ConstraintLayout提供了特殊的goneMargin属性，在目标View隐藏时，属性生效。有如下属性：</p>

<p><strong>Centering positioning and bias</strong></p>

<p>在RelativeLayout居中，通常是使用以下三个属性：</p>

<p>而在ConstraintLayout居中则采用左右上下边来约束居中。</p>

<pre class="line-numbers"><code class="language-text">&lt;TextView    
    ...    
    android:text=&quot;Hello&quot;    
    app:layout_constraintLeft_toLeftOf=&quot;parent&quot;    
    app:layout_constraintRight_toRightOf=&quot;parent&quot;/&gt;
</code></pre>

<p>效果图：</p>

<p><figure><img src="media/15713923056028/15714543367455.jpg" alt=""/></figure></p>

<p>那，要是想把Hello往左挪一点，怎么办？<br/>
那很简单，使用margin呀。不不不，这里要介绍的是另外两个属性，与LinearLayout的权重类似(当然，ConstraintLayout也可以使用权重属性)，但简单很多。</p>

<p>两个属性的取值范围在0-1。在水平偏移中，0表示最左，1表示最右；在垂直偏移，0表示最上，1表示最下；0.5表示中间。</p>

<pre class="line-numbers"><code class="language-text">&lt;TextView    
    ...    
    android:text=&quot;Hello&quot;        
    app:layout_constraintHorizontal_bias=&quot;0.8&quot; 
    app:layout_constraintLeft_toLeftOf=&quot;parent&quot;    
    app:layout_constraintRight_toRightOf=&quot;parent&quot;/&gt;
</code></pre>

<p>效果：<br/>
<figure><img src="media/15713923056028/15714543854883.jpg" alt=""/></figure></p>

<h3 id="toc_23">圆形定位(Added in 1.1)</h3>

<p>圆形定位指的是View的中心点相对于另外View中心点的位置。贴张官网图。<br/>
<figure><img src="media/15713923056028/15714545137544.jpg" alt=""/></figure></p>

<p>涉及三个属性：<br/>
吃个栗子：</p>

<pre class="line-numbers"><code class="language-text">&lt;TextView    
    ...    
    android:text=&quot;Hello&quot;    
    android:id=&quot;@+id/tvHello&quot;    
    app:layout_constraintTop_toTopOf=&quot;parent&quot;    
    app:layout_constraintBottom_toBottomOf=&quot;parent&quot;    
    app:layout_constraintLeft_toLeftOf=&quot;parent&quot;    
    app:layout_constraintRight_toRightOf=&quot;parent&quot;
    /&gt;
    
&lt;TextView    
    android:text=&quot;World&quot;    
    app:layout_constraintCircle=&quot;@id/tvHello&quot;    
    app:layout_constraintCircleRadius=&quot;180dp&quot;    
    app:layout_constraintCircleAngle=&quot;135&quot;/&gt;
</code></pre>

<p>效果图：Hello中间居中，World 135角度</p>

<p><figure><img src="media/15713923056028/15714545814991.jpg" alt=""/></figure></p>

<h3 id="toc_24">尺寸约束</h3>

<p><strong>ConstraintLayout 最大最小尺寸</strong></p>

<p>ConstraintLayout的宽高设为<code>WRAP_CONTENT</code>时，可以通过以下熟悉设置其最大最小尺寸。</p>

<p><strong>ConstraintLayout中的控件尺寸约束</strong></p>

<p>在ConstraintLayout中控件可以三种方式来设置其尺寸约束。</p>

<p>第一二种跟平常使用没什么区别。第三种会根据约束情况重新计算控件的大小。<br/>
在ConstraintLayout中，不推荐使用MATCH_PARENT，而是推荐使用MATCH_CONSTRAINT(0dp),它们的行为是类似的。</p>

<p>吃个栗子吧：</p>

<pre class="line-numbers"><code class="language-text"> &lt;TextView        
    android:text=&quot;Hello&quot;        
    android:id=&quot;@+id/tvHello&quot;        
    android:gravity=&quot;center&quot;        
    android:padding=&quot;20dp&quot;        
    app:layout_constraintTop_toTopOf=&quot;parent&quot;        
    android:textColor=&quot;@color/colorWhite&quot;        
    android:background=&quot;@color/colorPrimary&quot;        
    app:layout_constraintLeft_toLeftOf=&quot;parent&quot;        
    app:layout_constraintRight_toRightOf=&quot;parent&quot;        
    android:layout_width=&quot;0dp&quot;        
    android:layout_marginRight=&quot;20dp&quot;        
    android:layout_height=&quot;wrap_content&quot;/&gt;
</code></pre>

<p>设置<code>layout_width</code>为0dp;<code>layout_height</code>为<code>wrap_content</code>;<code>layout_marginRight</code>为20dp,与parent左右对齐。</p>

<p>效果图：</p>

<p><figure><img src="media/15713923056028/15714548109501.jpg" alt=""/></figure></p>

<p>在1.1之前的版本，控件尺寸设为<code>WRAP_CONTENT</code>,控件默认是由组件文本大小控制，其他约束是不生效的。可以通过以下属性设置是否生效。</p>

<p>控件设为<code>MATCH_CONSTRAINT</code>时，控件的大小会扩展所有可用空间，在1.1版本后，可以通过以下属性改变控件的行为。</p>

<p>吃个栗子：</p>

<pre class="line-numbers"><code class="language-text">&lt;TextView        
    android:text=&quot;Hello&quot;        
    android:id=&quot;@+id/tvHello&quot;        
    app:layout_constraintLeft_toLeftOf=&quot;parent&quot;        
    app:layout_constraintWidth_percent=&quot;0.5&quot;        
    app:layout_constraintWidth_default=&quot;percent&quot;        
    android:layout_width=&quot;0dp&quot;        
    android:layout_height=&quot;wrap_content&quot;/&gt;
</code></pre>

<p>将<code>android:layout_width</code>设为<code>MATCH_CONSTRAINT</code>,即0dp;将<code>app:layout_constraintWidth_default</code>设为<code>percent</code>;将<code>app:layout_constraintWidth_percent</code>设为0.5，表示占<code>parent</code>的50%，取值范围是0-1。</p>

<p>效果图：</p>

<p><figure><img src="media/15713923056028/15714549620393.jpg" alt=""/></figure></p>

<p><strong>比例约束</strong></p>

<p>控件的宽高比，要求是宽或高至少一个设为0dp，然后设置属性layout_constraintDimensionRatio即可。</p>

<pre class="line-numbers"><code class="language-text">&lt;TextView    
    android:text=&quot;Hello&quot;    
    app:layout_constraintDimensionRatio=&quot;3:1&quot;    
    android:layout_width=&quot;0dp&quot;    
    android:layout_height=&quot;100dp&quot;    /&gt;
</code></pre>

<p>这里设置宽高比为3:1,高度为100dp,那么宽度将为300dp。</p>

<p><figure><img src="media/15713923056028/15714550988071.jpg" alt=""/></figure></p>

<p>也可以在比例前加W,H表示是宽高比还是高宽比。如下面表示高宽比。</p>

<pre class="line-numbers"><code class="language-text">&lt;Button 
    android:layout_width=&quot;0dp&quot; 
    android:layout_height=&quot;0dp&quot;    
    app:layout_constraintDimensionRatio=&quot;H,16:9&quot;    
    app:layout_constraintBottom_toBottomOf=&quot;parent&quot;    
    app:layout_constraintTop_toTopOf=&quot;parent&quot;/&gt;
</code></pre>

<h3 id="toc_25">链</h3>

<p>链在水平或者垂直方向提供一组类似行为。如图所示可以理解为横向链。这里需要了解一点，A与parent的左边缘约束，B与parent的右边边缘约束，A右边和B左边之间相互约束，才能使用一条链。多个元素之间也是如此，最左最右与parent约束，元素之间边相互约束。不然下面的链式永远无法生效。</p>

<p><figure><img src="media/15713923056028/15717089036893.jpg" alt=""/></figure></p>

<p>横向链最左边第一个控件，垂直链最顶边第一个控件称为链头，可以通过下面两个属性链头统一定制链的样式。<br/>
它两的值默认可以是</p>

<pre class="line-numbers"><code class="language-text">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;&gt;
&lt;android.support.constraint.ConstraintLayout    
    xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;    
    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;    
    android:layout_width=&quot;match_parent&quot;    
    android:layout_height=&quot;match_parent&quot;&gt;    
    &lt;TextView            
        android:text=&quot;Hello&quot;            
        android:id=&quot;@+id/tvHello&quot;            
        android:gravity=&quot;center&quot;            
        android:padding=&quot;20dp&quot;            
        app:layout_constraintHorizontal_chainStyle=&quot;spread&quot;            
        app:layout_constraintLeft_toLeftOf=&quot;parent&quot;            
        app:layout_constraintRight_toLeftOf=&quot;@id/tvWorld&quot;            
        android:textColor=&quot;@color/colorWhite&quot;            
        android:background=&quot;@color/colorPrimaryDark&quot;            
        android:layout_width=&quot;wrap_content&quot;            
        android:layout_height=&quot;wrap_content&quot;/&gt;    
    &lt;TextView            
        android:text=&quot;World&quot;            
        android:gravity=&quot;center&quot;            
        android:padding=&quot;20dp&quot;            
        android:id=&quot;@+id/tvWorld&quot;            
        app:layout_constraintLeft_toRightOf=&quot;@id/tvHello&quot;            
        app:layout_constraintRight_toRightOf=&quot;parent&quot;            
        android:textColor=&quot;@color/colorWhite&quot;            
        android:background=&quot;@color/colorPrimary&quot;            
        android:layout_width=&quot;wrap_content&quot;            
        android:layout_height=&quot;wrap_content&quot;/&gt;
&lt;/android.support.constraint.ConstraintLayout&gt;
</code></pre>

<p>效果：</p>

<p><figure><img src="media/15713923056028/15717091746916.jpg" alt=""/></figure></p>

<p>在链中，剩余空余空间默认平均给各元素，但有时可以通过权重属性layout_constraintVertical_weight来指定分配空间的大小。</p>

<p>1.1之后的版本，在链中使用边距时，边距是相加的，也就说，假设Hello的右边距为5，World的左边距为20，那么它们之间的边距就是25。在链式，边距先从剩余空间减去的，然后再用剩余的空间在元素之间进行定位。</p>

<h3 id="toc_26">优化器</h3>

<p>在1.1之后，公开了优化器，通过在<code>app:layout_optimizationLevel</code>来决定控件在哪方面进行优化。</p>

<h2 id="toc_27">工具类</h2>

<h3 id="toc_28">Guideline（参考线）</h3>

<p>参考线实际上不会在界面进行显示，只是方便在ConstraintLayout布局view时候做一个参考。</p>

<p>通过设置Guideline的属性orientation来表示是水平方向还是垂直方向的参考线，对应值为vertical和horizontal。可以通过三种方式来定位Guideline位置。</p>

<p>丢个栗子:</p>

<pre class="line-numbers"><code class="language-text">&lt;android.support.constraint.ConstraintLayout    
    xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;      
    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;    
    xmlns:tools=&quot;http://schemas.android.com/tools&quot;    
    android:layout_width=&quot;match_parent&quot;    
    android:layout_height=&quot;match_parent&quot;&gt;
    
    &lt;android.support.constraint.Guideline
        android:layout_width=&quot;wrap_content&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:id=&quot;@+id/guideline&quot;
        android:orientation=&quot;vertical&quot;
        app:layout_constraintGuide_begin=&quot;10dp&quot;/&gt;

    &lt;Button 
        android:text=&quot;Button&quot;
        android:layout_width=&quot;wrap_content&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:id=&quot;@+id/button&quot;
        app:layout_constraintLeft_toLeftOf=&quot;@+id/guideline&quot;
        android:layout_marginTop=&quot;16dp&quot;
        app:layout_constraintTop_toTopOf=&quot;parent&quot;/&gt;

    &lt;Button 
        android:text=&quot;Button2&quot;
        android:layout_width=&quot;wrap_content&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:id=&quot;@+id/button2&quot;
        app:layout_constraintLeft_toLeftOf=&quot;@+id/guideline&quot;
        android:layout_marginTop=&quot;16dp&quot;
        app:layout_constraintTop_toBottomOf=&quot;@id/button&quot;/&gt;
&lt;/android.support.constraint.ConstraintLayout&gt;
</code></pre>

<p>Guideline设置为垂直参考线，距离开始的位置为10dp。如下图所示，实际中需要把鼠标移到button才会显示出来哦。</p>

<p><figure><img src="media/15713923056028/15717094753900.jpg" alt=""/></figure></p>

<h3 id="toc_29">Barrier（栅栏）</h3>

<p>Barrier有点类似Guideline，但Barrier会根据所有引用的控件尺寸的变化重新定位。例如经典的登录界面，右边的EditText总是希望与左右所有TextView的最长边缘靠齐。<br/>
如果两个TextView其中一个变得更长，EditText的位置都会跟这变化，这比使用RelativeLayout灵活很多。</p>

<p><figure><img src="media/15713923056028/15717096490313.jpg" alt=""/></figure></p>

<p>代码：</p>

<pre class="line-numbers"><code class="language-text">&lt;android.support.constraint.ConstraintLayout        
    xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;        
    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;        
    android:layout_width=&quot;match_parent&quot;        
    android:layout_height=&quot;match_parent&quot;&gt;
    
    &lt;android.support.constraint.Barrier
        android:layout_width=&quot;wrap_content&quot;
        android:layout_height=&quot;wrap_content&quot;
        app:barrierDirection=&quot;right&quot;
        android:id=&quot;@+id/barrier&quot;
        app:constraint_referenced_ids=&quot;tvPhone,tvPassword&quot;
        /&gt;

    &lt;TextView 
        android:layout_width=&quot;wrap_content&quot;
        android:text=&quot;手机号码&quot;
        android:id=&quot;@+id/tvPhone&quot;
        android:gravity=&quot;center_vertical|left&quot;
        android:padding=&quot;10dp&quot;
        android:layout_height=&quot;50dp&quot;/&gt;

    &lt;TextView 
        android:layout_width=&quot;wrap_content&quot;
        android:text=&quot;密码&quot;
        android:padding=&quot;10dp&quot;
        android:gravity=&quot;center_vertical|left&quot;
        android:id=&quot;@+id/tvPassword&quot;
        app:layout_constraintTop_toBottomOf=&quot;@id/tvPhone&quot;
        android:layout_height=&quot;wrap_content&quot;/&gt;

    &lt;EditText 
        android:layout_width=&quot;wrap_content&quot;
        android:hint=&quot;输入手机号码&quot;
        android:id=&quot;@+id/etPassword&quot;
        app:layout_constraintLeft_toLeftOf=&quot;@id/barrier&quot;
        android:layout_height=&quot;wrap_content&quot;/&gt;

    &lt;EditText 
        android:layout_width=&quot;wrap_content&quot;
        android:hint=&quot;输入密码&quot;
        app:layout_constraintTop_toBottomOf=&quot;@id/etPassword&quot;
        app:layout_constraintLeft_toLeftOf=&quot;@id/barrier&quot;
        android:layout_height=&quot;wrap_content&quot;/&gt;

&lt;/android.support.constraint.ConstraintLayout&gt;
</code></pre>

<p><code>app:barrierDirection</code>所引用控件对齐的位置，可设置的值有：bottom、end、left、right、start、top、constraint_referenced_ids为所引用的控件，例如这里的tvPhone,tvPasswrod。</p>

<h3 id="toc_30">Group（组）</h3>

<p>用来控制一组view的可见性，如果view被多个Group控制，则以最后的Group定义的可见性为主。</p>

<p>吃个香喷喷栗子吧：<br/>
Group默认可见时，是这样的。</p>

<p><figure><img src="media/15713923056028/15717099758054.jpg" alt=""/></figure></p>

<p>设置Group的<code>visible</code>属性为gone。</p>

<pre class="line-numbers"><code class="language-text">&lt;android.support.constraint.ConstraintLayout            
    xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;        
    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;        
    android:layout_width=&quot;match_parent&quot;        
    android:layout_height=&quot;match_parent&quot;&gt;

    &lt;android.support.constraint.Group
        android:layout_width=&quot;wrap_content&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:id=&quot;@+id/group&quot;
        android:visibility=&quot;gone&quot;
        app:constraint_referenced_ids=&quot;tvPhone,tvPassword&quot;
        /&gt;

    &lt;TextView 
        android:layout_width=&quot;wrap_content&quot;
        android:text=&quot;手机号码&quot;
        android:id=&quot;@+id/tvPhone&quot;
        android:gravity=&quot;center_vertical|left&quot;
        android:padding=&quot;10dp&quot;
        android:layout_height=&quot;50dp&quot;/&gt;

    &lt;TextView 
        android:layout_width=&quot;wrap_content&quot;
        android:text=&quot;密码&quot;
        android:padding=&quot;10dp&quot;
        android:gravity=&quot;center_vertical|left&quot;
        android:id=&quot;@+id/tvPassword&quot;
        app:layout_constraintLeft_toRightOf=&quot;@id/tvPhone&quot;
        app:layout_constraintTop_toBottomOf=&quot;@id/tvPhone&quot;
        android:layout_height=&quot;wrap_content&quot;/&gt;

    &lt;TextView 
        android:layout_width=&quot;wrap_content&quot;
        android:text=&quot;GitCode&quot;
        android:padding=&quot;10dp&quot;
        android:gravity=&quot;center_vertical|left&quot;
        app:layout_constraintLeft_toRightOf=&quot;@id/tvPassword&quot;
        android:layout_height=&quot;wrap_content&quot;/&gt;

&lt;/android.support.constraint.ConstraintLayout&gt;
</code></pre>

<p>效果就变成了这样了，tvPhone,tvPassword都被隐藏了。</p>

<p><figure><img src="media/15713923056028/15717101323220.jpg" alt=""/></figure></p>

<h3 id="toc_31">Placeholder（占位符）</h3>

<p>一个view占位的占位符，当指定Placeholder的content属性为另一个view的id时，该view会移动到Placeholder的位置。</p>

<p>代码中，将TextView的定位在屏幕中间，随着将id设置给Placeholder的属性后，TextView的位置就跑到Placeholder所在的地方，效果图跟上图一直。</p>

<pre class="line-numbers"><code class="language-text">&lt;android.support.constraint.ConstraintLayout        
    xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;          
    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;        
    android:layout_width=&quot;match_parent&quot;        
    android:layout_height=&quot;match_parent&quot;&gt;
      
    &lt;android.support.constraint.Placeholder         
        android:layout_width=&quot;wrap_content&quot;            
        android:layout_height=&quot;wrap_content&quot;            
        app:content=&quot;@id/tvGitCode&quot;/&gt;    
    
    &lt;TextView 
        android:layout_width=&quot;wrap_content&quot;              
        android:text=&quot;GitCode&quot;              
        android:id=&quot;@+id/tvGitCode&quot;              
        android:padding=&quot;10dp&quot;              
        app:layout_constraintLeft_toLeftOf=&quot;parent&quot;              
        app:layout_constraintRight_toRightOf=&quot;parent&quot;              
        android:gravity=&quot;center_vertical|left&quot;              
        android:layout_height=&quot;wrap_content&quot;/&gt;
&lt;/android.support.constraint.ConstraintLayout&gt;
</code></pre>


    

      </div>

      <div class="row">
        <div class="large-6 columns">
        <p class="text-left" style="padding:15px 0px;">
      
          <a href="15743996911213.html" 
          title="Previous Post: Kotlin备忘录">&laquo; Kotlin备忘录</a>
      
        </p>
        </div>
        <div class="large-6 columns">
      <p class="text-right" style="padding:15px 0px;">
      
          <a  href="15705014806732.html" 
          title="Next Post: Android性能优化">Android性能优化 &raquo;</a>
      
      </p>
        </div>
      </div>
      <div class="comments-wrap">
        <div class="share-comments">
          

          

          
        </div>
      </div>
    </div><!-- article-wrap -->
  </div><!-- large 8 -->




 <div class="large-4 medium-4 columns">
  <div class="hide-for-small">
    <div id="sidebar" class="sidebar">
          <div id="site-info" class="site-info">
            
                <h1>MagicalRice的Blog</h1>
                <div class="site-des">技术博客</div>
                <div class="social">











  <a target="_blank" class="rss" href="atom.xml" title="RSS">RSS</a>
                
              	 </div>
          	</div>

             

              <div id="site-categories" class="side-item ">
                <div class="side-header">
                  <h2>Categories</h2>
                </div>
                <div class="side-content">

      	<p class="cat-list">
        
            <a href="Android.html"><strong>Android</strong></a>
        
            <a href="%E6%9C%8D%E5%8A%A1%E5%99%A8.html"><strong>服务器</strong></a>
        
            <a href="C++.html"><strong>C++</strong></a>
        
            <a href="UI.html"><strong>UI</strong></a>
        
            <a href="MySQL.html"><strong>MySQL</strong></a>
        
            <a href="%E7%AE%97%E6%B3%95.html"><strong>算法</strong></a>
        
            <a href="Game.html"><strong>Game</strong></a>
        
            <a href="Python.html"><strong>Python</strong></a>
        
            <a href="%E8%B7%A8%E5%B9%B3%E5%8F%B0%E5%BC%80%E5%8F%91.html"><strong>跨平台开发</strong></a>
         
        </p>


                </div>
              </div>

              <div id="site-categories" class="side-item">
                <div class="side-header">
                  <h2>Recent Posts</h2>
                </div>
                <div class="side-content">
                <ul class="posts-list">
	      
		      
			      <li class="post">
			        <a href="15818619982581.html">IDEA 远程一键部署Spring Boot到Docker</a>
			      </li>
		     
		  
		      
			      <li class="post">
			        <a href="15813395132789.html">Flutter VsCode插件</a>
			      </li>
		     
		  
		      
			      <li class="post">
			        <a href="15809146907844.html">Flutter 组件小记</a>
			      </li>
		     
		  
		      
			      <li class="post">
			        <a href="15808782889824.html">Flutter常用第三方库</a>
			      </li>
		     
		  
		      
			      <li class="post">
			        <a href="15767453112302.html">添加环境变量</a>
			      </li>
		     
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		   
		  		</ul>
                </div>
              </div>
        </div><!-- sidebar -->
      </div><!-- hide for small -->
</div><!-- large 4 -->

</div><!-- row -->

 <div class="page-bottom clearfix">
  <div class="row">
   <p class="copyright">Copyright &copy; 2015
Powered by <a target="_blank" href="http://www.mweb.im">MWeb</a>,&nbsp; 
Theme used <a target="_blank" href="http://github.com">GitHub CSS</a>.</p>
  </div>
</div>

        </section>
      </div>
    </div>

  
    

    <script src="asset/js/foundation.min.js"></script>
    <script>
      $(document).foundation();
      function fixSidebarHeight(){
        var w1 = $('.markdown-body').height();
          var w2 = $('#sidebar').height();
          if (w1 > w2) { $('#sidebar').height(w1); };
      }
      $(function(){
        fixSidebarHeight();
      })
      $(window).load(function(){
          fixSidebarHeight();
      });
     
    </script>

    
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({TeX: { equationNumbers: { autoNumber: "AMS" } }});</script>


  </body>
</html>
